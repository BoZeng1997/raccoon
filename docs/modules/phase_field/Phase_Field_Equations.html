<!DOCTYPE html><head><meta charset="UTF-8"><link rel="icon" type="image/x-icon" href="../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../contrib/plotly/plotly.min.js"></script><title>Basic Phase Field Equations|RACCOON</title></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../install/index.html">Install</a></li><li><a href="../../examples/index.html">Examples</a></li><li><a href="../../theory/index.html">Theory</a></li><li><a href="../../documentation/index.html">Documentation</a></li></ul><a href="#" class="sidenav-trigger" data-target="74b030a1-e4fe-4082-bd38-9a5da16b625b"><i class="material-icons">menu</i></a><ul class="sidenav" id="74b030a1-e4fe-4082-bd38-9a5da16b625b"><li><a href="../../install/index.html">Install</a></li><li><a href="../../examples/index.html">Examples</a></li><li><a href="../../theory/index.html">Theory</a></li><li><a href="../../documentation/index.html">Documentation</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><span class="breadcrumb">modules</span><a href="." class="breadcrumb">phase_field</a><a href="#" class="breadcrumb">Phase_Field_Equations</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="dc96f307-39e8-4c93-9321-1b35f6f83fd0" data-section-level="1" data-section-text="Basic Phase Field Equations"><h1 id="basic-phase-field-equations">Basic Phase Field Equations</h1><p>In the phase field approach, microstructural features are described using continuous variables. These variables take two forms: conserved variables representing physical properties such as atom concentration or material density, and nonconserved order parameters describing the microstructure of the material, including grains and different phases.  The evolution of these continuous variables is a function of the Gibbs free energy and can be defined as a system of partial differential equations (PDEs). Thus, to define the kinetics of the system, the free energy must be described as a function of the continuous variables representing the microstructure.</p><p>The system of PDEs representing the evolution of the various variables required to represent a given system and the free energy functional comprise a specific phase field model. The model may also be coupled to additional physics, such as mechanics or heat conduction. These model equations may be solved in many ways, including finite difference, spectral methods, and the finite element method (FEM). The MOOSE-Phase Field module provides the necessary tools to rapidly develop a phase field simulation tool with the equations solved via FEM.</p><section class="scrollspy" id="c7b866ab-335d-4a12-8631-25d744206dd6" data-section-level="2" data-section-text="Phase Field Summary"><h2 id="phase-field-summary">Phase Field Summary</h2><p>We present this a general form of the phase field PDEs here, and then show how it can be solved via FEM.  The PDE&#x27;s are evolution equations for the various variables and are functions of the free energy functional <span tex="F" bookmark="moose-equation-00aad8ac-16f3-4238-8fa3-8a56b098b243" recursive="True" class="moose-katex-inline-equation" id="moose-equation-00aad8ac-16f3-4238-8fa3-8a56b098b243"><script>var element = document.getElementById("moose-equation-00aad8ac-16f3-4238-8fa3-8a56b098b243");katex.render("F", element, {displayMode:false,throwOnError:false});</script></span>.  The evolution of all conserved variables is defined using modified Cahn-Hilliard equations, i.e.</p><p><span class="moose-katex-block-equation"><span tex="\frac{\partial c_i}{\partial t} = \nabla \cdot M_i \nabla \frac{\delta F}{\delta c_i}" label="eq:CH" number="1" bookmark="moose-equation-0ef2b2aa-3b74-4d83-82fc-89f973418d97" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-0ef2b2aa-3b74-4d83-82fc-89f973418d97"></span><span class="moose-katex-equation-number">(1)</span><script>var element = document.getElementById("moose-equation-0ef2b2aa-3b74-4d83-82fc-89f973418d97");katex.render("  \\frac{\\partial c_i}{\\partial t} = \\nabla \\cdot M_i \\nabla \\frac{\\delta F}{\\delta c_i}", element, {displayMode:true,throwOnError:false});</script></span></p><p>where <span tex="c_i" bookmark="moose-equation-80deff92-0c31-4508-a140-ea29928c1aa9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-80deff92-0c31-4508-a140-ea29928c1aa9"><script>var element = document.getElementById("moose-equation-80deff92-0c31-4508-a140-ea29928c1aa9");katex.render("c_i", element, {displayMode:false,throwOnError:false});</script></span> is a conserved variable and <span tex="M_i" bookmark="moose-equation-d816f317-2f15-48fa-b850-b150525bd8ca" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d816f317-2f15-48fa-b850-b150525bd8ca"><script>var element = document.getElementById("moose-equation-d816f317-2f15-48fa-b850-b150525bd8ca");katex.render("M_i", element, {displayMode:false,throwOnError:false});</script></span> is the associated mobility.  The evolution of nonconserved order parameters is represented with an Allen-Cahn equation, according to</p><p><span class="moose-katex-block-equation"><span tex="\frac{\partial \eta_j}{\partial t} = - L_j \frac{\delta F}{\delta \eta_j}," label="eq:AC" number="2" bookmark="moose-equation-98b99c68-83cd-48dc-a2d6-bb1a189c4b0d" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-98b99c68-83cd-48dc-a2d6-bb1a189c4b0d"></span><span class="moose-katex-equation-number">(2)</span><script>var element = document.getElementById("moose-equation-98b99c68-83cd-48dc-a2d6-bb1a189c4b0d");katex.render("  \\frac{\\partial \\eta_j}{\\partial t} = - L_j \\frac{\\delta F}{\\delta \\eta_j},", element, {displayMode:true,throwOnError:false});</script></span></p><p>where <span tex="\eta_j" bookmark="moose-equation-60c07122-18a9-48b6-aef5-2d00e01e8f17" recursive="True" class="moose-katex-inline-equation" id="moose-equation-60c07122-18a9-48b6-aef5-2d00e01e8f17"><script>var element = document.getElementById("moose-equation-60c07122-18a9-48b6-aef5-2d00e01e8f17");katex.render("\\eta_j", element, {displayMode:false,throwOnError:false});</script></span> is an order parameter and <span tex="L_j" bookmark="moose-equation-08f5a713-32b6-4473-800c-ebad897e693c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-08f5a713-32b6-4473-800c-ebad897e693c"><script>var element = document.getElementById("moose-equation-08f5a713-32b6-4473-800c-ebad897e693c");katex.render("L_j", element, {displayMode:false,throwOnError:false});</script></span> is the order parameter mobility.</p><p>The free energy functional, for a phase field model using <span tex="N" bookmark="moose-equation-56ce2928-9bb5-4c9e-9599-25f0561d2447" recursive="True" class="moose-katex-inline-equation" id="moose-equation-56ce2928-9bb5-4c9e-9599-25f0561d2447"><script>var element = document.getElementById("moose-equation-56ce2928-9bb5-4c9e-9599-25f0561d2447");katex.render("N", element, {displayMode:false,throwOnError:false});</script></span> conserved variables <span tex="c_i" bookmark="moose-equation-8a65ead9-4aa6-4bd1-8433-27b7ccc2f842" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8a65ead9-4aa6-4bd1-8433-27b7ccc2f842"><script>var element = document.getElementById("moose-equation-8a65ead9-4aa6-4bd1-8433-27b7ccc2f842");katex.render("c_i", element, {displayMode:false,throwOnError:false});</script></span> and <span tex="M" bookmark="moose-equation-d5125c95-3b45-42b8-9029-5b4c2dd2403c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d5125c95-3b45-42b8-9029-5b4c2dd2403c"><script>var element = document.getElementById("moose-equation-d5125c95-3b45-42b8-9029-5b4c2dd2403c");katex.render("M", element, {displayMode:false,throwOnError:false});</script></span> order parameters <span tex="\eta_j" bookmark="moose-equation-c85bc990-6346-4d4f-abd2-1547c574c0fe" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c85bc990-6346-4d4f-abd2-1547c574c0fe"><script>var element = document.getElementById("moose-equation-c85bc990-6346-4d4f-abd2-1547c574c0fe");katex.render("\\eta_j", element, {displayMode:false,throwOnError:false});</script></span>, is described by</p><p><span class="moose-katex-block-equation"><span tex="F = \int_V \big[ f_{loc}(c_1, \ldots,c_N, \eta_1, \ldots, \eta_M) + f_{gr}(c_1, \ldots,c_N, \eta_1,  \ldots, \eta_M) + E_{d} \big] \, dV," bookmark="moose-equation-49e974df-cef2-4582-bb87-5ab848d47f3f" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-49e974df-cef2-4582-bb87-5ab848d47f3f"></span><script>var element = document.getElementById("moose-equation-49e974df-cef2-4582-bb87-5ab848d47f3f");katex.render("F = \\int_V \\big[ f_{loc}(c_1, \\ldots,c_N, \\eta_1, \\ldots, \\eta_M) + f_{gr}(c_1, \\ldots,c_N, \\eta_1,  \\ldots, \\eta_M) + E_{d} \\big] \\, dV,", element, {displayMode:true,throwOnError:false});</script></span></p><p>where <span tex="f_{loc}" bookmark="moose-equation-2a23d5c5-a935-4324-b6c6-dfdd193e5653" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2a23d5c5-a935-4324-b6c6-dfdd193e5653"><script>var element = document.getElementById("moose-equation-2a23d5c5-a935-4324-b6c6-dfdd193e5653");katex.render("f_{loc}", element, {displayMode:false,throwOnError:false});</script></span> defines the local free energy density as a function of all concentrations and order parameters, and varies from model to model.  The gradient energy density</p><p><span class="moose-katex-block-equation"><span tex="f_{gr} = \sum_i^N \frac{\kappa_i}{2} |\nabla c_i|^2 + \sum^M_j \frac{\kappa_j}{2} |\nabla \eta_j|^2" bookmark="moose-equation-4a965274-c029-499e-96d7-a9e239b097e4" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-4a965274-c029-499e-96d7-a9e239b097e4"></span><script>var element = document.getElementById("moose-equation-4a965274-c029-499e-96d7-a9e239b097e4");katex.render("f_{gr} = \\sum_i^N \\frac{\\kappa_i}{2} |\\nabla c_i|^2 + \\sum^M_j \\frac{\\kappa_j}{2} |\\nabla \\eta_j|^2", element, {displayMode:true,throwOnError:false});</script></span></p><p>where <span tex="\kappa_i" bookmark="moose-equation-565e96af-ff03-4767-af40-90cbe5245e3f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-565e96af-ff03-4767-af40-90cbe5245e3f"><script>var element = document.getElementById("moose-equation-565e96af-ff03-4767-af40-90cbe5245e3f");katex.render("\\kappa_i", element, {displayMode:false,throwOnError:false});</script></span> and <span tex="\kappa_j" bookmark="moose-equation-93bdd1ff-4d13-4fe6-a511-9f215f0271fa" recursive="True" class="moose-katex-inline-equation" id="moose-equation-93bdd1ff-4d13-4fe6-a511-9f215f0271fa"><script>var element = document.getElementById("moose-equation-93bdd1ff-4d13-4fe6-a511-9f215f0271fa");katex.render("\\kappa_j", element, {displayMode:false,throwOnError:false});</script></span> are gradient energy coefficients.  Finally, <span tex="E_d" bookmark="moose-equation-e033ab3f-747d-46eb-8f2b-94e6815fe84e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e033ab3f-747d-46eb-8f2b-94e6815fe84e"><script>var element = document.getElementById("moose-equation-e033ab3f-747d-46eb-8f2b-94e6815fe84e");katex.render("E_d", element, {displayMode:false,throwOnError:false});</script></span> describes any additional sources of energy in the system, such as deformation or electrostatic energy.  By combining the equations listed above and evaluating the functional derivatives (<a href="Derivation_explanations.html">further explanations</a>), the evolution of the variables is described as</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned}   \frac{\partial c_i}{\partial t} = &     \nabla \cdot M_i \nabla \left(         \frac{\partial f_{loc}}{\partial c_i}       + \frac{\partial E_{d}}{\partial c_i}       - \nabla\cdot (\kappa_i \nabla c_i)         \color{#AAAAAA}{\underbrace{           -\nabla \cdot \left(             \frac{\partial\kappa}{\partial\nabla c_i}             \frac12 |\nabla c_i|^2           \right)         }_{\text{for}\, \kappa(\nabla c)}}         \color{#AAAAAA}{\underbrace{           +\left(             \frac{\partial\kappa}{\partial c_i}             \frac12 |\nabla c_i|^2           \right)       }_{\text{for}\, \kappa(c_i)}}     \right) \\   \frac{\partial \eta_j}{\partial t} = &     -L \left(         \frac{\partial f_{loc}}{\partial \eta_j}       + \frac{\partial E_{d}}{\partial \eta_j}       - \nabla\cdot (\kappa_j \nabla \eta_j)         \color{#AAAAAA}{\underbrace{           -\nabla \cdot \left(             \frac{\partial\kappa}{\partial\nabla\eta_j}             \frac12 |\nabla\eta_j|^2           \right)         }_{\text{for}\, \kappa(\nabla\eta_j)}}         \color{#AAAAAA}{\underbrace{           +\left(             \frac{\partial\kappa}{\partial\eta_j}             \frac12 |\nabla\eta_j|^2           \right)       }_{\text{for}\, \kappa(\eta)}}     \right). \end{aligned}" label="eq:cons_residual_strong" number="3" bookmark="moose-equation-fc815593-648d-4bde-b8e6-b5075d730e6b" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-fc815593-648d-4bde-b8e6-b5075d730e6b"></span><span class="moose-katex-equation-number">(3)</span><script>var element = document.getElementById("moose-equation-fc815593-648d-4bde-b8e6-b5075d730e6b");katex.render("\\begin{aligned}   \\frac{\\partial c_i}{\\partial t} = &     \\nabla \\cdot M_i \\nabla \\left(         \\frac{\\partial f_{loc}}{\\partial c_i}       + \\frac{\\partial E_{d}}{\\partial c_i}       - \\nabla\\cdot (\\kappa_i \\nabla c_i)         \\color{#AAAAAA}{\\underbrace{           -\\nabla \\cdot \\left(             \\frac{\\partial\\kappa}{\\partial\\nabla c_i}             \\frac12 |\\nabla c_i|^2           \\right)         }_{\\text{for}\\, \\kappa(\\nabla c)}}         \\color{#AAAAAA}{\\underbrace{           +\\left(             \\frac{\\partial\\kappa}{\\partial c_i}             \\frac12 |\\nabla c_i|^2           \\right)       }_{\\text{for}\\, \\kappa(c_i)}}     \\right) \\\\   \\frac{\\partial \\eta_j}{\\partial t} = &     -L \\left(         \\frac{\\partial f_{loc}}{\\partial \\eta_j}       + \\frac{\\partial E_{d}}{\\partial \\eta_j}       - \\nabla\\cdot (\\kappa_j \\nabla \\eta_j)         \\color{#AAAAAA}{\\underbrace{           -\\nabla \\cdot \\left(             \\frac{\\partial\\kappa}{\\partial\\nabla\\eta_j}             \\frac12 |\\nabla\\eta_j|^2           \\right)         }_{\\text{for}\\, \\kappa(\\nabla\\eta_j)}}         \\color{#AAAAAA}{\\underbrace{           +\\left(             \\frac{\\partial\\kappa}{\\partial\\eta_j}             \\frac12 |\\nabla\\eta_j|^2           \\right)       }_{\\text{for}\\, \\kappa(\\eta)}}     \\right). \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p><div class="card moose-alert moose-alert-warning"><div class="card-title moose-alert-title"><span class="moose-alert-title-brand">warning</span></div><div class="card-content"><div class="moose-alert-content"><p><p><span tex="\kappa" bookmark="moose-equation-3320b46f-58cb-4c22-bfa2-4940c2e28d9a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3320b46f-58cb-4c22-bfa2-4940c2e28d9a"><script>var element = document.getElementById("moose-equation-3320b46f-58cb-4c22-bfa2-4940c2e28d9a");katex.render("\\kappa", element, {displayMode:false,throwOnError:false});</script></span> and <span tex="L" bookmark="moose-equation-26811990-dd14-4d61-8697-51fd85a6ca12" recursive="True" class="moose-katex-inline-equation" id="moose-equation-26811990-dd14-4d61-8697-51fd85a6ca12"><script>var element = document.getElementById("moose-equation-26811990-dd14-4d61-8697-51fd85a6ca12");katex.render("L", element, {displayMode:false,throwOnError:false});</script></span> must be either constant values, or functions of MOOSE variables (non-linear or auxiliary). It <strong>cannot</strong> be a direct function of _x,y,z_! If you need an _x,y,z_ dependence, add a LINEAR, LAGRANGE AuxVariable to the problem which depends on _x,y,z_ and have <span tex="\kappa" bookmark="moose-equation-cc3f1312-ec3b-460b-8d31-c46636279719" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cc3f1312-ec3b-460b-8d31-c46636279719"><script>var element = document.getElementById("moose-equation-cc3f1312-ec3b-460b-8d31-c46636279719");katex.render("\\kappa", element, {displayMode:false,throwOnError:false});</script></span> or <span tex="L" bookmark="moose-equation-6bd96a57-566d-4e9f-b34a-30f726ebba76" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6bd96a57-566d-4e9f-b34a-30f726ebba76"><script>var element = document.getElementById("moose-equation-6bd96a57-566d-4e9f-b34a-30f726ebba76");katex.render("L", element, {displayMode:false,throwOnError:false});</script></span> depend only on it.</p></p></div></div></div><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><span class="moose-alert-title-brand">note</span></div><div class="card-content"><div class="moose-alert-content"><p><p>The gray terms are required only in case the <span tex="\kappa" bookmark="moose-equation-a6ee928a-7d80-47b2-bc81-37e02339322f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a6ee928a-7d80-47b2-bc81-37e02339322f"><script>var element = document.getElementById("moose-equation-a6ee928a-7d80-47b2-bc81-37e02339322f");katex.render("\\kappa", element, {displayMode:false,throwOnError:false});</script></span> coefficients are functions of either the order parameter or its gradient respectively. A generic kernel for the <span tex="\kappa(\eta)" bookmark="moose-equation-080bf32c-4a5a-4bc5-9b92-03973dabfc77" recursive="True" class="moose-katex-inline-equation" id="moose-equation-080bf32c-4a5a-4bc5-9b92-03973dabfc77"><script>var element = document.getElementById("moose-equation-080bf32c-4a5a-4bc5-9b92-03973dabfc77");katex.render("\\kappa(\\eta)", element, {displayMode:false,throwOnError:false});</script></span> case is in preparation. Kernels for the <span tex="\kappa(\nabla\eta)" bookmark="moose-equation-55eb5c5b-7701-4c79-a3d7-d58096ea0a1f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-55eb5c5b-7701-4c79-a3d7-d58096ea0a1f"><script>var element = document.getElementById("moose-equation-55eb5c5b-7701-4c79-a3d7-d58096ea0a1f");katex.render("\\kappa(\\nabla\\eta)", element, {displayMode:false,throwOnError:false});</script></span> case need to be provided by the user.</p></p></div></div></div><p>To prepare for the FEM discretization, we construct a residual equation (equal to zero) in weak form in the usual manner.  First, the weighted integral residual projection is constructed using test function <span tex="\psi_m" bookmark="moose-equation-9f6204de-a648-4e03-8f5b-846faae12d41" recursive="True" class="moose-katex-inline-equation" id="moose-equation-9f6204de-a648-4e03-8f5b-846faae12d41"><script>var element = document.getElementById("moose-equation-9f6204de-a648-4e03-8f5b-846faae12d41");katex.render("\\psi_m", element, {displayMode:false,throwOnError:false});</script></span> and applying the divergence theorem to lower the derivative order. Thus, the Allen-Cahn equation yields</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} 	\boldsymbol{\mathcal{R}}_{\eta_i} &=& \left(  \frac{\partial \eta_j}{\partial t}, \psi_m \right) + \left( \nabla(\kappa_j\eta_j), \nabla (L\psi_m) \right) + L \left( \frac{\partial f_{loc}}{\partial \eta_j} + \frac{\partial E_d}{\partial \eta_j}, \psi_m \right) - \left<L\kappa_j \nabla \eta_j \cdot \vec{n}, \psi_m \right>, \end{aligned}" bookmark="moose-equation-969434b4-b53f-4762-b540-7bd4c850591e" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-969434b4-b53f-4762-b540-7bd4c850591e"></span><script>var element = document.getElementById("moose-equation-969434b4-b53f-4762-b540-7bd4c850591e");katex.render("\\begin{aligned} \t\\boldsymbol{\\mathcal{R}}_{\\eta_i} &=& \\left(  \\frac{\\partial \\eta_j}{\\partial t}, \\psi_m \\right) + \\left( \\nabla(\\kappa_j\\eta_j), \\nabla (L\\psi_m) \\right) + L \\left( \\frac{\\partial f_{loc}}{\\partial \\eta_j} + \\frac{\\partial E_d}{\\partial \\eta_j}, \\psi_m \\right) - \\left<L\\kappa_j \\nabla \\eta_j \\cdot \\vec{n}, \\psi_m \\right>, \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p><p>where the <span tex="(*,*)" bookmark="moose-equation-d2d00cd5-11df-4655-8490-3adeb966d62e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d2d00cd5-11df-4655-8490-3adeb966d62e"><script>var element = document.getElementById("moose-equation-d2d00cd5-11df-4655-8490-3adeb966d62e");katex.render("(*,*)", element, {displayMode:false,throwOnError:false});</script></span> operator represents a volume integral with an inner product and the <span tex="\left<*,*\right>" bookmark="moose-equation-c865b288-1e6a-47ea-9a15-3215df305948" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c865b288-1e6a-47ea-9a15-3215df305948"><script>var element = document.getElementById("moose-equation-c865b288-1e6a-47ea-9a15-3215df305948");katex.render("\\left<*,*\\right>", element, {displayMode:false,throwOnError:false});</script></span> operator represents a surface integral with an inner product. Solving the Cahn-Hilliard equation with FEM is more difficult, due to the fourth order gradient. It can be solved in two ways.</p><p>The first is to directly solve the equation according to <span class="moose-katex-block-equation"><span tex="\begin{aligned} 	\boldsymbol{\mathcal{R}}_{c_i} &=& \left(  \frac{\partial c_i}{\partial t}, \psi_m \right) + \left( \kappa_i \nabla^2 c_i, \nabla \cdot (M_i \nabla \psi_m ) \right) + \left( M_i  \nabla \left( \frac{\partial f_{loc} }{\partial c_i} + \frac{\partial E_d}{\partial c_i} \right), \nabla \psi_m \right)  - \\ 	&& \left< M_i \nabla \left(  \kappa_i \nabla^2 c_i  \right)  \cdot \vec{n}, \psi_m \right> 	+ \left< M_i \nabla \left( \frac{\partial f_{loc}}{\partial c_i} + \frac{\partial E_{d}}{\partial c_i } \right)  \cdot \vec{n}, \psi_m \right> -  \left< \kappa_i \nabla^2 c_i, M_i \nabla \psi_m \cdot \vec{n} \right>. \end{aligned}" bookmark="moose-equation-cb056604-edf4-44f8-b452-fcbde119b0d1" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-cb056604-edf4-44f8-b452-fcbde119b0d1"></span><script>var element = document.getElementById("moose-equation-cb056604-edf4-44f8-b452-fcbde119b0d1");katex.render("\\begin{aligned} \t\\boldsymbol{\\mathcal{R}}_{c_i} &=& \\left(  \\frac{\\partial c_i}{\\partial t}, \\psi_m \\right) + \\left( \\kappa_i \\nabla^2 c_i, \\nabla \\cdot (M_i \\nabla \\psi_m ) \\right) + \\left( M_i  \\nabla \\left( \\frac{\\partial f_{loc} }{\\partial c_i} + \\frac{\\partial E_d}{\\partial c_i} \\right), \\nabla \\psi_m \\right)  - \\\\ \t&& \\left< M_i \\nabla \\left(  \\kappa_i \\nabla^2 c_i  \\right)  \\cdot \\vec{n}, \\psi_m \\right> \t+ \\left< M_i \\nabla \\left( \\frac{\\partial f_{loc}}{\\partial c_i} + \\frac{\\partial E_{d}}{\\partial c_i } \\right)  \\cdot \\vec{n}, \\psi_m \\right> -  \\left< \\kappa_i \\nabla^2 c_i, M_i \\nabla \\psi_m \\cdot \\vec{n} \\right>. \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p><p>The second approach is to split the fourth order equation into two second order equations, such that two variables are solved, the concentration <span tex="c_i" bookmark="moose-equation-e74ff282-3324-40c9-8d5a-736fe568e6f5" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e74ff282-3324-40c9-8d5a-736fe568e6f5"><script>var element = document.getElementById("moose-equation-e74ff282-3324-40c9-8d5a-736fe568e6f5");katex.render("c_i", element, {displayMode:false,throwOnError:false});</script></span> and the chemical potential <span tex="\mu_i" bookmark="moose-equation-a3ab1113-e80b-43f3-8bfd-03e1295099bb" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a3ab1113-e80b-43f3-8bfd-03e1295099bb"><script>var element = document.getElementById("moose-equation-a3ab1113-e80b-43f3-8bfd-03e1295099bb");katex.render("\\mu_i", element, {displayMode:false,throwOnError:false});</script></span>. In this case, the two residual equations are</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} 	\boldsymbol{\mathcal{R}}_{\mu_i} &=& \left(  \frac{\partial c_i}{\partial t}, \psi_m \right) + \left( M_i  \nabla \mu_i, \nabla \psi_m \right) - \left< M_i  \nabla \mu_i \cdot \vec{n}, \psi_m \right>\\   \boldsymbol{\mathcal{R}}_{c_i} &=& \left( \nabla c_i, \nabla(\kappa_i \psi_m) \right) -  \left< \nabla c_i\cdot \vec{n}, \kappa_i \psi_m \right> + \left( \left( \frac{\partial f_{loc}}{\partial c_i} + \frac{\partial E_d}{\partial c_i} - \mu_i \right), \psi_m \right) \end{aligned}" bookmark="moose-equation-a26813ce-d3c6-4751-83db-2a799c67ea94" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-a26813ce-d3c6-4751-83db-2a799c67ea94"></span><script>var element = document.getElementById("moose-equation-a26813ce-d3c6-4751-83db-2a799c67ea94");katex.render("\\begin{aligned} \t\\boldsymbol{\\mathcal{R}}_{\\mu_i} &=& \\left(  \\frac{\\partial c_i}{\\partial t}, \\psi_m \\right) + \\left( M_i  \\nabla \\mu_i, \\nabla \\psi_m \\right) - \\left< M_i  \\nabla \\mu_i \\cdot \\vec{n}, \\psi_m \\right>\\\\   \\boldsymbol{\\mathcal{R}}_{c_i} &=& \\left( \\nabla c_i, \\nabla(\\kappa_i \\psi_m) \\right) -  \\left< \\nabla c_i\\cdot \\vec{n}, \\kappa_i \\psi_m \\right> + \\left( \\left( \\frac{\\partial f_{loc}}{\\partial c_i} + \\frac{\\partial E_d}{\\partial c_i} - \\mu_i \\right), \\psi_m \\right) \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p><p>Note that we have reversed which equation is used to solve for each variable from what might be expected. This change improves the solve convergence and does not impact the solution.</p></section><section class="scrollspy" id="befe2413-62f7-4b08-a0c7-937cde7f93c8" data-section-level="2" data-section-text="Free Energy Based Model Development"><h2 id="free-energy-based-model-development">Free Energy Based Model Development</h2><p>The goal of the MOOSE phase field module is to facilitate the development of advanced phase field models by taking advantage of their common structure, i.e. their usage of the Cahn-Hilliard and Allen-Cahn equations and their reliance on free energy functionals.  Thus, only the free energy derivatives and the parameters vary between most models. By taking advantage of the modular structure of MOOSE, we have developed a series of kernels that implement the various pieces of the Allen-Cahn equation and the two solution approaches to the Cahn-Hilliard equation. The free energy derivatives and the material parameters are provided in materials objects, which can be created by the user or created using our automatic differentiation system. Note that use of these kernels is not required. If you choose not to use them, you would develop your kernels in the usual way for MOOSE.</p><p>The Allen-Cahn residual equation, without boundary terms, is shown here: <span class="moose-katex-block-equation"><span tex="\begin{aligned} \boldsymbol{\mathcal{R}}_{\eta_i} &=& \left(  \frac{\partial \eta_j}{\partial t}, \psi_m \right) + \left( \nabla(\kappa_j\eta_j), \nabla (L\psi_m) \right) + L \left( \frac{\partial f_{loc}}{\partial \eta_j} + \frac{\partial E_d}{\partial \eta_j}, \psi_m \right) \end{aligned}" bookmark="moose-equation-8540dddb-dea2-40ca-9864-a56eff1faf49" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-8540dddb-dea2-40ca-9864-a56eff1faf49"></span><script>var element = document.getElementById("moose-equation-8540dddb-dea2-40ca-9864-a56eff1faf49");katex.render("\\begin{aligned} \\boldsymbol{\\mathcal{R}}_{\\eta_i} &=& \\left(  \\frac{\\partial \\eta_j}{\\partial t}, \\psi_m \\right) + \\left( \\nabla(\\kappa_j\\eta_j), \\nabla (L\\psi_m) \\right) + L \\left( \\frac{\\partial f_{loc}}{\\partial \\eta_j} + \\frac{\\partial E_d}{\\partial \\eta_j}, \\psi_m \\right) \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span> It is divided into three pieces, each implemented in their own kernel, as shown below</p><div form="['center', 'center', 'center', 'center', 'center']" recursive="True" class="moose-table-div"><table><thead><tr><th style=";text-align:center">Residual term</th><th style=";text-align:center">Variable</th><th style=";text-align:center">Parameters</th><th style=";text-align:center">Energy derivative</th><th style=";text-align:center">Kernel</th></tr></thead><tbody><tr><td style=";text-align:center"><span tex="\left(  \frac{\partial \eta_j}{\partial t}, \psi_m \right)" bookmark="moose-equation-17874cc6-4870-409b-991f-9219b26e4d35" recursive="True" class="moose-katex-inline-equation" id="moose-equation-17874cc6-4870-409b-991f-9219b26e4d35"><script>var element = document.getElementById("moose-equation-17874cc6-4870-409b-991f-9219b26e4d35");katex.render("\\left(  \\frac{\\partial \\eta_j}{\\partial t}, \\psi_m \\right)", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="\eta_j" bookmark="moose-equation-d4960be1-8a4a-4949-8e2b-a3a674196ad8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d4960be1-8a4a-4949-8e2b-a3a674196ad8"><script>var element = document.getElementById("moose-equation-d4960be1-8a4a-4949-8e2b-a3a674196ad8");katex.render("\\eta_j", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center">|</td><td style=";text-align:center"><a href="../../source/kernels/TimeDerivative.html"><code>TimeDerivative</code></a></td></tr></tbody><tbody><tr><td style=";text-align:center"><span tex="\left( \nabla(\kappa_j\eta_j), \nabla (L\psi_m) \right)" bookmark="moose-equation-55da6c5a-eeb1-4a9e-b7da-34005915be89" recursive="True" class="moose-katex-inline-equation" id="moose-equation-55da6c5a-eeb1-4a9e-b7da-34005915be89"><script>var element = document.getElementById("moose-equation-55da6c5a-eeb1-4a9e-b7da-34005915be89");katex.render("\\left( \\nabla(\\kappa_j\\eta_j), \\nabla (L\\psi_m) \\right)", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="\eta_j" bookmark="moose-equation-2756ddf2-af9e-45a5-ae1b-3d835637d04a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2756ddf2-af9e-45a5-ae1b-3d835637d04a"><script>var element = document.getElementById("moose-equation-2756ddf2-af9e-45a5-ae1b-3d835637d04a");katex.render("\\eta_j", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="\kappa_j,\ L" bookmark="moose-equation-ffa18606-1ef8-460a-a03d-b52569f27d6c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ffa18606-1ef8-460a-a03d-b52569f27d6c"><script>var element = document.getElementById("moose-equation-ffa18606-1ef8-460a-a03d-b52569f27d6c");katex.render("\\kappa_j,\\ L", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center">| <a href="/ACInterface,md"><code>ACInterface</code></a></td></tr></tbody><tbody><tr><td style=";text-align:center"><span tex="L \left( \frac{\partial f_{loc}}{\partial \eta_j} + \frac{\partial E_d}{\partial \eta_j}, \psi_m \right)" bookmark="moose-equation-28463473-9f6f-4c43-9f6d-d75de46dd1f2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-28463473-9f6f-4c43-9f6d-d75de46dd1f2"><script>var element = document.getElementById("moose-equation-28463473-9f6f-4c43-9f6d-d75de46dd1f2");katex.render("L \\left( \\frac{\\partial f_{loc}}{\\partial \\eta_j} + \\frac{\\partial E_d}{\\partial \\eta_j}, \\psi_m \\right)", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="\eta_j" bookmark="moose-equation-b5007f18-2387-4d72-b419-7909488822c0" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b5007f18-2387-4d72-b419-7909488822c0"><script>var element = document.getElementById("moose-equation-b5007f18-2387-4d72-b419-7909488822c0");katex.render("\\eta_j", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="L" bookmark="moose-equation-72d436cb-0ef9-4097-8e72-84992c269ea7" recursive="True" class="moose-katex-inline-equation" id="moose-equation-72d436cb-0ef9-4097-8e72-84992c269ea7"><script>var element = document.getElementById("moose-equation-72d436cb-0ef9-4097-8e72-84992c269ea7");katex.render("L", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="\frac{\partial f_{loc} }{\partial \eta_j}, \frac{\partial E_d }{\partial \eta_j}" bookmark="moose-equation-9911aced-b52a-4187-89a2-9e900e883994" recursive="True" class="moose-katex-inline-equation" id="moose-equation-9911aced-b52a-4187-89a2-9e900e883994"><script>var element = document.getElementById("moose-equation-9911aced-b52a-4187-89a2-9e900e883994");katex.render("\\frac{\\partial f_{loc} }{\\partial \\eta_j}, \\frac{\\partial E_d }{\\partial \\eta_j}", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><a href="../../source/kernels/AllenCahn.html"><code>AllenCahn</code></a></td></tr></tbody></table></div><p>The residual for the direct solution of the Cahn-Hilliard equation (without boundary terms) is</p><p><span class="moose-katex-block-equation"><span tex="\boldsymbol{\mathcal{R}}_{c_i} = \left( \frac{\partial c_i}{\partial t}, \psi_m \right) + \left( \kappa_i \nabla^2 c_i, \nabla \cdot (M_i \nabla \psi_m ) \right) + \left( M_i \left( \nabla \frac{\partial f_{loc} }{\partial c_i} + \nabla  \frac{\partial E_d}{\partial c_i} \right), \nabla \psi_m \right)" bookmark="moose-equation-ad7caff1-79a8-4744-ab8f-c60e4a54276f" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-ad7caff1-79a8-4744-ab8f-c60e4a54276f"></span><script>var element = document.getElementById("moose-equation-ad7caff1-79a8-4744-ab8f-c60e4a54276f");katex.render("\\boldsymbol{\\mathcal{R}}_{c_i} = \\left( \\frac{\\partial c_i}{\\partial t}, \\psi_m \\right) + \\left( \\kappa_i \\nabla^2 c_i, \\nabla \\cdot (M_i \\nabla \\psi_m ) \\right) + \\left( M_i \\left( \\nabla \\frac{\\partial f_{loc} }{\\partial c_i} + \\nabla  \\frac{\\partial E_d}{\\partial c_i} \\right), \\nabla \\psi_m \\right)", element, {displayMode:true,throwOnError:false});</script></span></p><div form="['center', 'center', 'center', 'center', 'center']" recursive="True" class="moose-table-div"><table><thead><tr><th style=";text-align:center">Residual term</th><th style=";text-align:center">Variable</th><th style=";text-align:center">Parameters</th><th style=";text-align:center">Energy derivative</th><th style=";text-align:center">Kernel</th></tr></thead><tbody><tr><td style=";text-align:center"><span tex="\left(  \frac{\partial c_i}{\partial t}, \psi_m \right)" bookmark="moose-equation-3ba6cba1-79d1-4424-9637-33725323ce56" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3ba6cba1-79d1-4424-9637-33725323ce56"><script>var element = document.getElementById("moose-equation-3ba6cba1-79d1-4424-9637-33725323ce56");katex.render("\\left(  \\frac{\\partial c_i}{\\partial t}, \\psi_m \\right)", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="c_i" bookmark="moose-equation-40d0a1d7-107b-48e6-a7bc-5ff45c2ee84c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-40d0a1d7-107b-48e6-a7bc-5ff45c2ee84c"><script>var element = document.getElementById("moose-equation-40d0a1d7-107b-48e6-a7bc-5ff45c2ee84c");katex.render("c_i", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center">|</td><td style=";text-align:center"><a href="../../source/kernels/TimeDerivative.html"><code>TimeDerivative</code></a></td></tr></tbody><tbody><tr><td style=";text-align:center"><span tex="\left( \kappa_i \nabla^2 c_i, \nabla \cdot (M_i \nabla \psi_m ) \right)" bookmark="moose-equation-ba2c7edf-1b4d-4b52-8550-8652ad3f1f9e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ba2c7edf-1b4d-4b52-8550-8652ad3f1f9e"><script>var element = document.getElementById("moose-equation-ba2c7edf-1b4d-4b52-8550-8652ad3f1f9e");katex.render("\\left( \\kappa_i \\nabla^2 c_i, \\nabla \\cdot (M_i \\nabla \\psi_m ) \\right)", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="c_i" bookmark="moose-equation-a96c044e-1729-4be7-938c-3585917f108a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a96c044e-1729-4be7-938c-3585917f108a"><script>var element = document.getElementById("moose-equation-a96c044e-1729-4be7-938c-3585917f108a");katex.render("c_i", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="\kappa_i" bookmark="moose-equation-ed47ae43-beb6-4d4c-a8a5-ac16b1669952" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ed47ae43-beb6-4d4c-a8a5-ac16b1669952"><script>var element = document.getElementById("moose-equation-ed47ae43-beb6-4d4c-a8a5-ac16b1669952");katex.render("\\kappa_i", element, {displayMode:false,throwOnError:false});</script></span>, <span tex="M_i" bookmark="moose-equation-85d9a7d5-ec56-49fd-899b-5339fad0e808" recursive="True" class="moose-katex-inline-equation" id="moose-equation-85d9a7d5-ec56-49fd-899b-5339fad0e808"><script>var element = document.getElementById("moose-equation-85d9a7d5-ec56-49fd-899b-5339fad0e808");katex.render("M_i", element, {displayMode:false,throwOnError:false});</script></span>, <span tex="\nabla M_i" bookmark="moose-equation-2d285702-b133-46ad-bd5d-8a182431defd" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2d285702-b133-46ad-bd5d-8a182431defd"><script>var element = document.getElementById("moose-equation-2d285702-b133-46ad-bd5d-8a182431defd");katex.render("\\nabla M_i", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center">| <a href="../../source/kernels/CHInterface.html"><code>CHInterface</code></a></td></tr></tbody><tbody><tr><td style=";text-align:center"><span tex="\left(M_i \left( \nabla \frac{\partial f_{loc} }{\partial c_i} + \nabla  \frac{\partial E_d}{\partial c_i} \right),\nabla \psi \right)" bookmark="moose-equation-f139c69e-a012-47ce-a1ed-07f853688a82" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f139c69e-a012-47ce-a1ed-07f853688a82"><script>var element = document.getElementById("moose-equation-f139c69e-a012-47ce-a1ed-07f853688a82");katex.render("\\left(M_i \\left( \\nabla \\frac{\\partial f_{loc} }{\\partial c_i} + \\nabla  \\frac{\\partial E_d}{\\partial c_i} \\right),\\nabla \\psi \\right)", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="c_i" bookmark="moose-equation-816faac4-b64b-4ecb-b8cb-17b4b7db7e5f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-816faac4-b64b-4ecb-b8cb-17b4b7db7e5f"><script>var element = document.getElementById("moose-equation-816faac4-b64b-4ecb-b8cb-17b4b7db7e5f");katex.render("c_i", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="M_i" bookmark="moose-equation-1ea720c2-ee92-4fe5-8e7e-97f18410e6c2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1ea720c2-ee92-4fe5-8e7e-97f18410e6c2"><script>var element = document.getElementById("moose-equation-1ea720c2-ee92-4fe5-8e7e-97f18410e6c2");katex.render("M_i", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="\frac{\partial^2 f_{loc} }{\partial c_i^2}" bookmark="moose-equation-cc5d1d9a-f76c-4c86-abdb-0645bf25c62b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cc5d1d9a-f76c-4c86-abdb-0645bf25c62b"><script>var element = document.getElementById("moose-equation-cc5d1d9a-f76c-4c86-abdb-0645bf25c62b");katex.render("\\frac{\\partial^2 f_{loc} }{\\partial c_i^2}", element, {displayMode:false,throwOnError:false});</script></span>, <span tex="\frac{\partial^2 E_d }{\partial c_i^2}" bookmark="moose-equation-8608920a-d477-4c85-a5be-c1629a72174b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8608920a-d477-4c85-a5be-c1629a72174b"><script>var element = document.getElementById("moose-equation-8608920a-d477-4c85-a5be-c1629a72174b");katex.render("\\frac{\\partial^2 E_d }{\\partial c_i^2}", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><a href="../../source/kernels/CahnHilliard.html"><code>CahnHilliard</code></a></td></tr></tbody></table></div><p>In the split form of the Cahn-Hilliard solution, the two residual equations are <span class="moose-katex-block-equation"><span tex="\begin{aligned} 	\boldsymbol{\mathcal{R}}_{\mu_i} &=& \left(  \frac{\partial c_i}{\partial t}, \psi_m \right) + \left( M_i  \nabla \mu_i, \nabla \psi_m \right) \\   \boldsymbol{\mathcal{R}}_{c_i} &=& \left( \left( -\kappa_i \nabla^2 c_i +  \frac{\partial f_{loc}}{\partial c_i} + \frac{\partial E_d}{\partial c_i} - \mu_i \right), \psi_m \right) \end{aligned}" bookmark="moose-equation-2d264192-feba-4d05-8529-0bdd77f119b0" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-2d264192-feba-4d05-8529-0bdd77f119b0"></span><script>var element = document.getElementById("moose-equation-2d264192-feba-4d05-8529-0bdd77f119b0");katex.render("\\begin{aligned} \t\\boldsymbol{\\mathcal{R}}_{\\mu_i} &=& \\left(  \\frac{\\partial c_i}{\\partial t}, \\psi_m \\right) + \\left( M_i  \\nabla \\mu_i, \\nabla \\psi_m \\right) \\\\   \\boldsymbol{\\mathcal{R}}_{c_i} &=& \\left( \\left( -\\kappa_i \\nabla^2 c_i +  \\frac{\\partial f_{loc}}{\\partial c_i} + \\frac{\\partial E_d}{\\partial c_i} - \\mu_i \\right), \\psi_m \\right) \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p><div form="['center', 'center', 'center', 'center', 'center']" recursive="True" class="moose-table-div"><table><thead><tr><th style=";text-align:center">Residual term</th><th style=";text-align:center">Variable</th><th style=";text-align:center">Parameters</th><th style=";text-align:center">Energy derivative</th><th style=";text-align:center">Kernel</th></tr></thead><tbody><tr><td style=";text-align:center"><span tex="\left(  \frac{\partial c_i}{\partial t}, \psi_m \right)" bookmark="moose-equation-9951fe09-3e08-44bc-bd5f-39ce9b25ca13" recursive="True" class="moose-katex-inline-equation" id="moose-equation-9951fe09-3e08-44bc-bd5f-39ce9b25ca13"><script>var element = document.getElementById("moose-equation-9951fe09-3e08-44bc-bd5f-39ce9b25ca13");katex.render("\\left(  \\frac{\\partial c_i}{\\partial t}, \\psi_m \\right)", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="\mu" bookmark="moose-equation-b84e0c50-879d-4f84-be7f-8f45d94b6197" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b84e0c50-879d-4f84-be7f-8f45d94b6197"><script>var element = document.getElementById("moose-equation-b84e0c50-879d-4f84-be7f-8f45d94b6197");katex.render("\\mu", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center">|</td><td style=";text-align:center"><a href="../../source/kernels/CoupledTimeDerivative.html"><code>CoupledTimeDerivative</code></a></td></tr></tbody><tbody><tr><td style=";text-align:center">|<span tex="\left( M_i  \nabla \mu, \nabla \psi_m \right)" bookmark="moose-equation-b97379c5-40c5-4658-938a-209a87600adf" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b97379c5-40c5-4658-938a-209a87600adf"><script>var element = document.getElementById("moose-equation-b97379c5-40c5-4658-938a-209a87600adf");katex.render("\\left( M_i  \\nabla \\mu, \\nabla \\psi_m \\right)", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="\mu" bookmark="moose-equation-33160639-b497-4e4f-a7f5-214dfdf453dd" recursive="True" class="moose-katex-inline-equation" id="moose-equation-33160639-b497-4e4f-a7f5-214dfdf453dd"><script>var element = document.getElementById("moose-equation-33160639-b497-4e4f-a7f5-214dfdf453dd");katex.render("\\mu", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="M_i" bookmark="moose-equation-cdee6af6-3e2d-4929-bd8b-6bbe0dad50b2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cdee6af6-3e2d-4929-bd8b-6bbe0dad50b2"><script>var element = document.getElementById("moose-equation-cdee6af6-3e2d-4929-bd8b-6bbe0dad50b2");katex.render("M_i", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center">| <a href="../../source/kernels/SplitCHWRes.html"><code>SplitCHWRes</code></a></td></tr></tbody><tbody><tr><td style=";text-align:center"><span tex="\left( -\kappa_i \nabla^2 c_i +  \frac{\partial f_{loc}}{\partial c_i} + \frac{\partial E_d}{\partial c_i} - \mu_i \right)" bookmark="moose-equation-3576e144-d4a3-4e25-bc56-61a55f6e8a1c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3576e144-d4a3-4e25-bc56-61a55f6e8a1c"><script>var element = document.getElementById("moose-equation-3576e144-d4a3-4e25-bc56-61a55f6e8a1c");katex.render("\\left( -\\kappa_i \\nabla^2 c_i +  \\frac{\\partial f_{loc}}{\\partial c_i} + \\frac{\\partial E_d}{\\partial c_i} - \\mu_i \\right)", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="c" bookmark="moose-equation-d91d218f-f44c-46ff-9c66-9292b338f3d4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d91d218f-f44c-46ff-9c66-9292b338f3d4"><script>var element = document.getElementById("moose-equation-d91d218f-f44c-46ff-9c66-9292b338f3d4");katex.render("c", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="\kappa_i" bookmark="moose-equation-6ee42475-6e74-4964-aab1-6962ee70120a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6ee42475-6e74-4964-aab1-6962ee70120a"><script>var element = document.getElementById("moose-equation-6ee42475-6e74-4964-aab1-6962ee70120a");katex.render("\\kappa_i", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><span tex="\frac{\partial f_{loc} }{\partial c_i}" bookmark="moose-equation-2b10aed0-6849-43c1-bdbf-82db8f3bfb8a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2b10aed0-6849-43c1-bdbf-82db8f3bfb8a"><script>var element = document.getElementById("moose-equation-2b10aed0-6849-43c1-bdbf-82db8f3bfb8a");katex.render("\\frac{\\partial f_{loc} }{\\partial c_i}", element, {displayMode:false,throwOnError:false});</script></span>, <span tex="\frac{\partial E_d }{\partial c_i}" bookmark="moose-equation-3a61c23b-cf4c-4921-94b1-e7bc73db3071" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3a61c23b-cf4c-4921-94b1-e7bc73db3071"><script>var element = document.getElementById("moose-equation-3a61c23b-cf4c-4921-94b1-e7bc73db3071");katex.render("\\frac{\\partial E_d }{\\partial c_i}", element, {displayMode:false,throwOnError:false});</script></span></td><td style=";text-align:center"><a href="../../source/kernels/SplitCHParsed.html"><code>SplitCHParsed</code></a></td></tr></tbody></table></div></section><section class="scrollspy" id="f6691d71-6fb4-453f-96b4-dee67f29ccae" data-section-level="2" data-section-text="See also"><h2 id="see-also">See also</h2><ul class="browser-default"><li><p><a href="FAQ">Phase Field FAQ</a> - Frequently asked questions for MOOSE phase-field models. </p></li><li><p><a href="Actions.html">Actions</a> - Simplify the setup of of the phase field equations using MOOSE actions </p></li><li><p><a href="FunctionMaterials/FreeEnergy">Free Energy Materials</a> - The key component in the modular free energy phase field modeling approach. This page lists the available function materials and explains how to define a free energy function and combine multiple free energy contributions (including elastic energy) into a total free energy. </p></li><li><p><a href="FunctionMaterialKernels">Function Material Kernels</a> - Kernels which utilize free energy densities provides by Function Material. These are the recommended phase field kernels. </p></li><li><p><a href="ExpressionBuilder">ExpressionBuilder</a> - Use automatic differentiation with Free energies defined in the C++ code. </p></li><li><p><a href="MultiPhaseModels">Multi Phase Models</a> - Combine multiple single phase free energies into multiphase field models using these tools. </p></li><li><p>Free energies can also be combined with the deformation energy calculated using the Tensor Mechanics module.</p></li></ul></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#c7b866ab-335d-4a12-8631-25d744206dd6" class="tooltipped" data-position="left" data-tooltip="Phase Field Summary">Phase Field Summary</a></li><li><a href="#befe2413-62f7-4b08-a0c7-937cde7f93c8" class="tooltipped" data-position="left" data-tooltip="Free Energy Based Model Development">Free Energy Based Model Development</a></li><li><a href="#f6691d71-6fb4-453f-96b4-dee67f29ccae" class="tooltipped" data-position="left" data-tooltip="See also">See also</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script>