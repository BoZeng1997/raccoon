<!DOCTYPE html><head><meta charset="UTF-8"><link rel="icon" type="image/x-icon" href="../../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../../contrib/plotly/plotly.min.js"></script><title>Multiphase models|RACCOON</title></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon/index.html" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../../media/framework/github-logo.png" class="github-mark"></img><img src="../../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../examples/index.html">Examples</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../../documentation/index.html">Documentation</a></li></ul><a href="#" class="sidenav-trigger" data-target="94f2fabd-f646-4139-b7fd-7da0f159c44d"><i class="material-icons">menu</i></a><ul class="sidenav" id="94f2fabd-f646-4139-b7fd-7da0f159c44d"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../examples/index.html">Examples</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../../documentation/index.html">Documentation</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon/index.html" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><span class="breadcrumb">modules</span><a href=".." class="breadcrumb">phase_field</a><span class="breadcrumb">MultiPhase</span><a href="#" class="breadcrumb">WBM</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="d6039a6b-6070-4704-80a5-23575ea37b27" data-section-level="1" data-section-text="Multiphase models"><h1 id="multiphase-models">Multiphase models</h1><p>Material objects that internally derive from <code>DerivativeFunctionMaterialBase</code> (<a href="http://mooseframework.org/docs/doxygen/modules/classDerivativeFunctionMaterialBase.html">Doxygen</a>), like the materials for the <a href="../FunctionMaterialKernels.html">Parsed Function Kernels</a> are used to provide the free energy expressions for each phase.</p><p>The flexible <strong>multiphase model</strong> uses _n_ order parameters to control <em>n</em> phases while employing a Lagrange multiplier based constraint to enforce the sum of all phase contributions to be one at every point in the simulation cell.</p><p>For multiphase models with <em>n</em> phases <a href="../../../source/materials/DerivativeMultiPhaseMaterial.html"><code>DerivativeMultiPhaseMaterial</code></a> can be used to form the global free energy as</p><p><span class="moose-katex-block-equation"><span tex="F = \left[ \sum_i^n h_i(\eta_i)F_i \right] + g(\vec\eta)" bookmark="moose-equation-4498314a-e540-4367-b65f-34cf4304a7c8" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-4498314a-e540-4367-b65f-34cf4304a7c8"></span><script>var element = document.getElementById("moose-equation-4498314a-e540-4367-b65f-34cf4304a7c8");katex.render("F = \\left[ \\sum_i^n h_i(\\eta_i)F_i \\right] + g(\\vec\\eta)", element, {displayMode:true,throwOnError:false});</script></span></p><p>We need to enforce the constraint <span tex="k(\vec\eta)=0" bookmark="moose-equation-ed8b6b25-eb7e-41d9-9c25-fdaf1c3ff80f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ed8b6b25-eb7e-41d9-9c25-fdaf1c3ff80f"><script>var element = document.getElementById("moose-equation-ed8b6b25-eb7e-41d9-9c25-fdaf1c3ff80f");katex.render("k(\\vec\\eta)=0", element, {displayMode:false,throwOnError:false});</script></span> for</p><p><span class="moose-katex-block-equation"><span tex="k(\vec \eta)=\left[\sum_i h(\eta_i)\right] - 1 \underbrace{- \frac\epsilon2\lambda}_{\text{Jacobian fill}}," bookmark="moose-equation-cbfd2cc5-66fe-4123-bcf6-81dd15609577" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-cbfd2cc5-66fe-4123-bcf6-81dd15609577"></span><script>var element = document.getElementById("moose-equation-cbfd2cc5-66fe-4123-bcf6-81dd15609577");katex.render("k(\\vec \\eta)=\\left[\\sum_i h(\\eta_i)\\right] - 1 \\underbrace{- \\frac\\epsilon2\\lambda}_{\\text{Jacobian fill}},", element, {displayMode:true,throwOnError:false});</script></span></p><p>which ensures that the total weight of all phase free energy contributions at each point in the simulation volume is exactly unity (up to an <span tex="\epsilon" bookmark="moose-equation-8d4afee3-6507-4794-8904-c6cd2d97b4e3" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8d4afee3-6507-4794-8904-c6cd2d97b4e3"><script>var element = document.getElementById("moose-equation-8d4afee3-6507-4794-8904-c6cd2d97b4e3");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false});</script></span>). This is achieved using either a hard or soft constraint enforcement method.</p><p>Check out the example input at <code>moose/modules/phase_field/examples/multiphase/DerivativeMultiPhaseMaterial.i</code> to see it in action.</p><section class="scrollspy" id="15213f77-1747-47de-801b-c60294fafdb7" data-section-level="2" data-section-text="Lagrange multiplier constraint"><h2 id="lagrange-multiplier-constraint">Lagrange multiplier constraint</h2><p>As first (hard) method for constraint enforcement the Lagrange multiplier technique is available, where the Lagrange multiplier <span tex="\lambda" bookmark="moose-equation-4b5080e9-3b59-4d9c-9fa8-b03b65682a1f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4b5080e9-3b59-4d9c-9fa8-b03b65682a1f"><script>var element = document.getElementById("moose-equation-4b5080e9-3b59-4d9c-9fa8-b03b65682a1f");katex.render("\\lambda", element, {displayMode:false,throwOnError:false});</script></span> is a non-linear variable</p><p>With <span tex="a_i(\vec\eta,\vec c,v)" bookmark="moose-equation-5f3774be-19c3-4835-9cbb-d6ddb6522ab2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5f3774be-19c3-4835-9cbb-d6ddb6522ab2"><script>var element = document.getElementById("moose-equation-5f3774be-19c3-4835-9cbb-d6ddb6522ab2");katex.render("a_i(\\vec\\eta,\\vec c,v)", element, {displayMode:false,throwOnError:false});</script></span> being the weak form (Allen-Cahn) residual for the <span tex="i" bookmark="moose-equation-0b7ad2c7-65e8-40ec-80a3-b577db3eb6de" recursive="True" class="moose-katex-inline-equation" id="moose-equation-0b7ad2c7-65e8-40ec-80a3-b577db3eb6de"><script>var element = document.getElementById("moose-equation-0b7ad2c7-65e8-40ec-80a3-b577db3eb6de");katex.render("i", element, {displayMode:false,throwOnError:false});</script></span>th non-conserved order parameter, we need to find <span tex="(\vec\eta,\lambda)" bookmark="moose-equation-9bcd6b49-ab51-492f-b381-80220b81d55c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-9bcd6b49-ab51-492f-b381-80220b81d55c"><script>var element = document.getElementById("moose-equation-9bcd6b49-ab51-492f-b381-80220b81d55c");katex.render("(\\vec\\eta,\\lambda)", element, {displayMode:false,throwOnError:false});</script></span> satisfying the boundary conditions and such that</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} a_i(\vec\eta,\vec c,v) + \underbrace{\int_\Omega\lambda\frac{\partial k}{\partial\eta_i} v\,dx}_{L_1(\eta_i)} &=& 0 \\ \underbrace{\int_\Omega q\frac{\partial(\lambda k)}{\partial\lambda}\,dx}_{L_2(\lambda)} &=& 0 \end{aligned}" bookmark="moose-equation-fd3dbd5d-f64f-4426-b78e-ecb96cc90ddd" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-fd3dbd5d-f64f-4426-b78e-ecb96cc90ddd"></span><script>var element = document.getElementById("moose-equation-fd3dbd5d-f64f-4426-b78e-ecb96cc90ddd");katex.render("\\begin{aligned} a_i(\\vec\\eta,\\vec c,v) + \\underbrace{\\int_\\Omega\\lambda\\frac{\\partial k}{\\partial\\eta_i} v\\,dx}_{L_1(\\eta_i)} &=& 0 \\\\ \\underbrace{\\int_\\Omega q\\frac{\\partial(\\lambda k)}{\\partial\\lambda}\\,dx}_{L_2(\\lambda)} &=& 0 \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p><p>holds for every test function <span tex="v" bookmark="moose-equation-8afee211-8f44-4ccd-a27b-261be24337bc" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8afee211-8f44-4ccd-a27b-261be24337bc"><script>var element = document.getElementById("moose-equation-8afee211-8f44-4ccd-a27b-261be24337bc");katex.render("v", element, {displayMode:false,throwOnError:false});</script></span> and <span tex="q" bookmark="moose-equation-a6aab4f4-d5e3-4452-93d2-151ea2f91523" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a6aab4f4-d5e3-4452-93d2-151ea2f91523"><script>var element = document.getElementById("moose-equation-a6aab4f4-d5e3-4452-93d2-151ea2f91523");katex.render("q", element, {displayMode:false,throwOnError:false});</script></span>.</p><p>The <span tex="L_1" bookmark="moose-equation-ada0c332-c0af-4338-a8d1-32b5c50dd025" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ada0c332-c0af-4338-a8d1-32b5c50dd025"><script>var element = document.getElementById("moose-equation-ada0c332-c0af-4338-a8d1-32b5c50dd025");katex.render("L_1", element, {displayMode:false,throwOnError:false});</script></span> Lagrange residuals are provided by <code>SwitchingFunctionConstraintEta</code> (<a href="http://mooseframework.org/docs/doxygen/modules/classSwitchingFunctionConstraintEta.html">Doxygen</a>) kernels - one for each phase order parameter.</p><p>The <span tex="L_2" bookmark="moose-equation-387cce7c-12c8-447f-be1d-c2bd330a4f0f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-387cce7c-12c8-447f-be1d-c2bd330a4f0f"><script>var element = document.getElementById("moose-equation-387cce7c-12c8-447f-be1d-c2bd330a4f0f");katex.render("L_2", element, {displayMode:false,throwOnError:false});</script></span> Lagrange residual is provided by a <code>SwitchingFunctionConstraintLagrange</code> (<a href="http://mooseframework.org/docs/doxygen/modules/classSwitchingFunctionConstraintLagrange.html">Doxygen</a>) kernel.</p><p>The <em>Jacobian fill</em> term introduces a small <span tex="\lambda" bookmark="moose-equation-f78d917e-e1ce-453b-b349-8803bc978042" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f78d917e-e1ce-453b-b349-8803bc978042"><script>var element = document.getElementById("moose-equation-f78d917e-e1ce-453b-b349-8803bc978042");katex.render("\\lambda", element, {displayMode:false,throwOnError:false});</script></span> dependence in the constraint through a small <span tex="\epsilon" bookmark="moose-equation-5e3b1594-f87f-4a4e-a83d-2d832a77fc04" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5e3b1594-f87f-4a4e-a83d-2d832a77fc04"><script>var element = document.getElementById("moose-equation-5e3b1594-f87f-4a4e-a83d-2d832a77fc04");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false});</script></span> factor (defaults to <span tex="10^{-9}" bookmark="moose-equation-5d9aba87-92f7-409d-92c2-c949af6c8b66" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5d9aba87-92f7-409d-92c2-c949af6c8b66"><script>var element = document.getElementById("moose-equation-5d9aba87-92f7-409d-92c2-c949af6c8b66");katex.render("10^{-9}", element, {displayMode:false,throwOnError:false});</script></span>), which results in an on-diagonal Jacobian value of <span tex="\epsilon" bookmark="moose-equation-40ed03a8-e557-474f-8823-57b699b33777" recursive="True" class="moose-katex-inline-equation" id="moose-equation-40ed03a8-e557-474f-8823-57b699b33777"><script>var element = document.getElementById("moose-equation-40ed03a8-e557-474f-8823-57b699b33777");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false});</script></span> in the <span tex="L_2" bookmark="moose-equation-727c5fb5-f827-43c1-b520-dd149fbad6d2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-727c5fb5-f827-43c1-b520-dd149fbad6d2"><script>var element = document.getElementById("moose-equation-727c5fb5-f827-43c1-b520-dd149fbad6d2");katex.render("L_2", element, {displayMode:false,throwOnError:false});</script></span> kernel (it drops out in the <span tex="L_1" bookmark="moose-equation-bfcd5f02-ddbf-4d08-a836-65890a468f86" recursive="True" class="moose-katex-inline-equation" id="moose-equation-bfcd5f02-ddbf-4d08-a836-65890a468f86"><script>var element = document.getElementById("moose-equation-bfcd5f02-ddbf-4d08-a836-65890a468f86");katex.render("L_1", element, {displayMode:false,throwOnError:false});</script></span> kernel). This is necessary to force a Jacobian matrix with <em>full rank</em>, avoids &quot;Zero pivot&quot; PETSc-Errors, and greatly improves convergence. The cost is a <em>violation</em> of the constraint by about <span tex="\epsilon" bookmark="moose-equation-d28de74a-cac2-4971-84b4-9907bb8a5961" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d28de74a-cac2-4971-84b4-9907bb8a5961"><script>var element = document.getElementById("moose-equation-d28de74a-cac2-4971-84b4-9907bb8a5961");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false});</script></span>, however this constraint violation can be made as small as the convergence limits.</p></section><section class="scrollspy" id="b0e77796-dd54-40ea-aaa9-259ebca28043" data-section-level="2" data-section-text="Penalty constraint"><h2 id="penalty-constraint">Penalty constraint</h2><p>As an alternative (softer) constraint enforcement we provide the <code>SwitchingFunctionPenalty</code> (<a href="http://mooseframework.org/docs/doxygen/modules/classSwitchingFunctionPenalty.html">Doxygen</a>) kernel, which effectively adds a free energy penalty of <span tex="\gamma k(\vec \eta)^2" bookmark="moose-equation-4380712d-223b-4ea5-b3c8-2949397341ad" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4380712d-223b-4ea5-b3c8-2949397341ad"><script>var element = document.getElementById("moose-equation-4380712d-223b-4ea5-b3c8-2949397341ad");katex.render("\\gamma k(\\vec \\eta)^2", element, {displayMode:false,throwOnError:false});</script></span> (with <span tex="\epsilon=0" bookmark="moose-equation-66870698-b3b4-4421-95b8-baea12160dae" recursive="True" class="moose-katex-inline-equation" id="moose-equation-66870698-b3b4-4421-95b8-baea12160dae"><script>var element = document.getElementById("moose-equation-66870698-b3b4-4421-95b8-baea12160dae");katex.render("\\epsilon=0", element, {displayMode:false,throwOnError:false});</script></span>), where <span tex="\gamma" bookmark="moose-equation-c0512941-d282-462c-bc60-ebbf3848e437" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c0512941-d282-462c-bc60-ebbf3848e437"><script>var element = document.getElementById("moose-equation-c0512941-d282-462c-bc60-ebbf3848e437");katex.render("\\gamma", element, {displayMode:false,throwOnError:false});</script></span> is the penalty prefactor (<code>penalty</code>). The constraint is enforced approximately to a tolerance of <span tex="\frac1\gamma" bookmark="moose-equation-4c1810cc-6dbe-46b4-8812-edfd8e5696b6" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4c1810cc-6dbe-46b4-8812-edfd8e5696b6"><script>var element = document.getElementById("moose-equation-4c1810cc-6dbe-46b4-8812-edfd8e5696b6");katex.render("\\frac1\\gamma", element, {displayMode:false,throwOnError:false});</script></span> (depending on the shape and units of the free energy).</p><p>The gradient interface energy term for multiphase models with <span tex="n>2" bookmark="moose-equation-a7b37683-019b-4cf6-928b-43b7e69de298" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a7b37683-019b-4cf6-928b-43b7e69de298"><script>var element = document.getElementById("moose-equation-a7b37683-019b-4cf6-928b-43b7e69de298");katex.render("n>2", element, {displayMode:false,throwOnError:false});</script></span> is derived <a href="../../../source/kernels/ACMultiInterface.html">here</a> and provided by the <a href="../../../source/kernels/ACMultiInterface.html"><code>ACMultiInterface</code></a> kernel.</p></section><section class="scrollspy" id="a89ab73b-99b7-4ad9-8eb0-5d933c3805fd" data-section-level="2" data-section-text="Example"><h2 id="example">Example</h2><p>An example material block looks like this (materials for phase field mobilities omitted for clarity).</p><pre class="moose-pre"><code class="language-puppet">
[Materials]
# Free energy for phase A

[./free_energy_A]
  type = DerivativeParsedMaterial
  block = 0
  f_name = Fa
  args = &#x27;c&#x27;
  function = &#x27;(c-0.1)^2&#x27;
  third_derivatives = false
  enable_jit = true
[../]

# Free energy for phase B

[./free_energy_B]
  type = DerivativeParsedMaterial
  block = 0
  f_name = Fb
  args = &#x27;c&#x27;
  function = &#x27;(c-0.9)^2&#x27;
  third_derivatives = false
  enable_jit = true
[../]

[./switching]
  type = SwitchingFunctionMaterial
  block = 0
  eta = eta
  h_order = SIMPLE
[../]

[./barrier]
  type = BarrierFunctionMaterial
  block = 0
  eta = eta
  g_order = SIMPLE
[../]

# Total free energy F = h(phi)*Fb + (1-h(phi))*Fa

[./free_energy]
  type = DerivativeTwoPhaseMaterial
  block = 0
  f_name = F    # Name of the global free energy function (use this in the Parsed Function Kernels)
  fa_name = Fa  # f_name of the phase A free energy function
  fb_name = Fb  # f_name of the phase B free energy function
  args = &#x27;c&#x27;
  eta = eta     # order parameter that switches between A and B phase
  third_derivatives = false
  outputs = exodus
[../]
[]
</code></pre><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><span class="moose-alert-title-brand">note</span></div><div class="card-content"><div class="moose-alert-content"><p><p>The phase free energies are single wells. The global free energy landscape will however have a double well character in this example.</p></p></div></div></div></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#15213f77-1747-47de-801b-c60294fafdb7" class="tooltipped" data-position="left" data-tooltip="Lagrange multiplier constraint">Lagrange multiplier constraint</a></li><li><a href="#b0e77796-dd54-40ea-aaa9-259ebca28043" class="tooltipped" data-position="left" data-tooltip="Penalty constraint">Penalty constraint</a></li><li><a href="#a89ab73b-99b7-4ad9-8eb0-5d933c3805fd" class="tooltipped" data-position="left" data-tooltip="Example">Example</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../../js/init.js"></script><script type="text/javascript" src="../../../js/navigation.js"></script><script type="text/javascript" src="../../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../../js/search_index.js"></script>