<!DOCTYPE html><head><meta charset="UTF-8"><link rel="icon" type="image/x-icon" href="../../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../../contrib/plotly/plotly.min.js"></script><title>KKS Model Definitions|RACCOON</title></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../../media/framework/github-logo.png" class="github-mark"></img><img src="../../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../examples/index.html">Examples</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../../documentation/index.html">Documentation</a></li></ul><a href="#" class="sidenav-trigger" data-target="48ae8805-f99f-4e51-8621-c474cac17aad"><i class="material-icons">menu</i></a><ul class="sidenav" id="48ae8805-f99f-4e51-8621-c474cac17aad"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../examples/index.html">Examples</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../../documentation/index.html">Documentation</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><span class="breadcrumb">modules</span><a href=".." class="breadcrumb">phase_field</a><span class="breadcrumb">MultiPhase</span><a href="#" class="breadcrumb">KKSDerivations</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="9598fa98-1f77-48ad-876f-0722d7136cc4" data-section-level="1" data-section-text="KKS Model Definitions"><h1 id="kks-model-definitions">KKS Model Definitions</h1><p><span class="moose-katex-block-equation"><span tex="F = [1-h(\eta)]F_a + h(\eta)F_b+wg(\eta)" bookmark="moose-equation-fcda63a1-a2b6-407e-a3fc-3098d1ef5ee1" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-fcda63a1-a2b6-407e-a3fc-3098d1ef5ee1"></span><script>var element = document.getElementById("moose-equation-fcda63a1-a2b6-407e-a3fc-3098d1ef5ee1");katex.render("F = [1-h(\\eta)]F_a + h(\\eta)F_b+wg(\\eta)", element, {displayMode:true,throwOnError:false});</script></span></p><p><span class="moose-katex-block-equation"><span tex="c =  [1-h(\eta)]c_a + h(\eta)c_b" bookmark="moose-equation-62174cdd-1d73-46d0-b456-8a5adceda0ad" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-62174cdd-1d73-46d0-b456-8a5adceda0ad"></span><script>var element = document.getElementById("moose-equation-62174cdd-1d73-46d0-b456-8a5adceda0ad");katex.render("c =  [1-h(\\eta)]c_a + h(\\eta)c_b", element, {displayMode:true,throwOnError:false});</script></span></p><p><span class="moose-katex-block-equation"><span tex="\frac{dF_a}{dc_a} = \frac{dF_b}{dc_b}" bookmark="moose-equation-da1fb5a3-f21d-4115-ab91-a4cd50921f9b" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-da1fb5a3-f21d-4115-ab91-a4cd50921f9b"></span><script>var element = document.getElementById("moose-equation-da1fb5a3-f21d-4115-ab91-a4cd50921f9b");katex.render("\\frac{dF_a}{dc_a} = \\frac{dF_b}{dc_b}", element, {displayMode:true,throwOnError:false});</script></span></p></section><section id="25c74800-7582-41ff-9843-892f2650ceca" data-section-level="1" data-section-text="Materials"><h1 id="materials">Materials</h1><p>The KKS system (<a href="#kim_phase-field_1999">Kim et al. (1999)</a>) uses multiple MOOSE materials to provide values for free energy  functions, the switching function <span tex="h(\eta)" bookmark="moose-equation-9ec9deae-6bb0-4383-b448-b0a2cb9b1536" recursive="True" class="moose-katex-inline-equation" id="moose-equation-9ec9deae-6bb0-4383-b448-b0a2cb9b1536"><script>var element = document.getElementById("moose-equation-9ec9deae-6bb0-4383-b448-b0a2cb9b1536");katex.render("h(\\eta)", element, {displayMode:false,throwOnError:false});</script></span>, and the double well function <span tex="g(\eta)" bookmark="moose-equation-fe368cb0-660b-4118-9e60-152fb67c67f5" recursive="True" class="moose-katex-inline-equation" id="moose-equation-fe368cb0-660b-4118-9e60-152fb67c67f5"><script>var element = document.getElementById("moose-equation-fe368cb0-660b-4118-9e60-152fb67c67f5");katex.render("g(\\eta)", element, {displayMode:false,throwOnError:false});</script></span>. Providing these as materials allows the functions to be bundled in a single place, while being used by multiple kernels. Furthermore the automatic differentiation feature used in the parsed function materials prreplovides the necessary derivatives at no cost to the developer. The derivatives are stored in material properties and follow a naming scheme that is defined in <code>KKSBaseMaterial.C</code>.</p></section><section id="2fc75076-9a1a-46b2-bf7d-3e0f039e09a3" data-section-level="1" data-section-text="Cahn - Hilliard Kernels"><h1 id="cahn-hilliard-kernels">Cahn-Hilliard Kernels</h1><section class="scrollspy" id="48d0691b-e16f-45ef-87db-967414be863f" data-section-level="2" data-section-text="KKSSplitCHCRes"><h2 id="kkssplitchcres">KKSSplitCHCRes</h2><p><a href="../../../source/kernels/KKSSplitCHCRes.html"><code>KKSSplitCHCRes</code></a> is the split version. In this kernel, we calculate the chemical potential <span tex="\mu" bookmark="moose-equation-1123b1d1-74f3-4ec9-b954-268470a19b86" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1123b1d1-74f3-4ec9-b954-268470a19b86"><script>var element = document.getElementById("moose-equation-1123b1d1-74f3-4ec9-b954-268470a19b86");katex.render("\\mu", element, {displayMode:false,throwOnError:false});</script></span> from <span tex="\frac{\partial F}{\partial c}" bookmark="moose-equation-6cc8d01b-ae5e-465d-9516-48346ad383d1" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6cc8d01b-ae5e-465d-9516-48346ad383d1"><script>var element = document.getElementById("moose-equation-6cc8d01b-ae5e-465d-9516-48346ad383d1");katex.render("\\frac{\\partial F}{\\partial c}", element, {displayMode:false,throwOnError:false});</script></span>. The non-linear variable for this Kernel is the concentration <span tex="c" bookmark="moose-equation-e1ab44e7-4357-4472-a32a-d2046789c1bf" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e1ab44e7-4357-4472-a32a-d2046789c1bf"><script>var element = document.getElementById("moose-equation-e1ab44e7-4357-4472-a32a-d2046789c1bf");katex.render("c", element, {displayMode:false,throwOnError:false});</script></span>. To calculate <span tex="\frac{\partial c}{\partial t}" bookmark="moose-equation-81e852d4-c51e-4f8c-a028-d55bead38b3b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-81e852d4-c51e-4f8c-a028-d55bead38b3b"><script>var element = document.getElementById("moose-equation-81e852d4-c51e-4f8c-a028-d55bead38b3b");katex.render("\\frac{\\partial c}{\\partial t}", element, {displayMode:false,throwOnError:false});</script></span> and <span tex="\nabla \cdot M(c) \nabla \mu" bookmark="moose-equation-d62cac83-4427-4d69-90f4-4785262fda9f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d62cac83-4427-4d69-90f4-4785262fda9f"><script>var element = document.getElementById("moose-equation-d62cac83-4427-4d69-90f4-4785262fda9f");katex.render("\\nabla \\cdot M(c) \\nabla \\mu", element, {displayMode:false,throwOnError:false});</script></span>, we use the <a href="../../../source/kernels/CoupledTimeDerivative.html"><code>CoupledTimeDerivative</code></a> and <a href="../../../source/kernels/SplitCHWRes.html"><code>SplitCHWRes</code></a> kernels, respectively, as described <a href="../Phase_Field_Equations.html">here</a>.</p></section><section class="scrollspy" id="5c63ecc9-38ca-4dd4-ac2f-79231851154c" data-section-level="2" data-section-text="Residual"><h2 id="residual">Residual</h2><p>In the residual routine we need to calculate the term <span tex="R= \frac{\partial F}{\partial c} - \mu" bookmark="moose-equation-7658fa8f-e649-4e2b-af63-9279bb4ef000" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7658fa8f-e649-4e2b-af63-9279bb4ef000"><script>var element = document.getElementById("moose-equation-7658fa8f-e649-4e2b-af63-9279bb4ef000");katex.render("R= \\frac{\\partial F}{\\partial c} - \\mu", element, {displayMode:false,throwOnError:false});</script></span>. We exploit the KKS identity <span tex="\frac{\partial F}{\partial c}=\frac{dF_a}{dc_a}=\frac{dF_b}{dc_b}" bookmark="moose-equation-772e8da4-c5b3-4a53-8208-13d02fa980f4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-772e8da4-c5b3-4a53-8208-13d02fa980f4"><script>var element = document.getElementById("moose-equation-772e8da4-c5b3-4a53-8208-13d02fa980f4");katex.render("\\frac{\\partial F}{\\partial c}=\\frac{dF_a}{dc_a}=\\frac{dF_b}{dc_b}", element, {displayMode:false,throwOnError:false});</script></span> and arbitrarily use the a-phase instead.</p><p><span class="moose-katex-block-equation"><span tex="R = \frac{\partial F_a}{\partial c_a} - \mu" bookmark="moose-equation-d00c33ff-df25-4901-93fd-9ea15887eb4b" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-d00c33ff-df25-4901-93fd-9ea15887eb4b"></span><script>var element = document.getElementById("moose-equation-d00c33ff-df25-4901-93fd-9ea15887eb4b");katex.render("R = \\frac{\\partial F_a}{\\partial c_a} - \\mu", element, {displayMode:true,throwOnError:false});</script></span></p><section id="ac34db0a-e7d3-4441-987b-67f5083c64df" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><section id="b933491b-0957-41ec-b3dc-fd3ba97a7cb1" data-section-level="4" data-section-text="On - Diagonal"><h4 id="on-diagonal">On-Diagonal</h4><p>Since there is no explicit dependence on the non-linear variable <span tex="c" bookmark="moose-equation-2a267eba-1fbc-4f2b-bade-01c178f02621" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2a267eba-1fbc-4f2b-bade-01c178f02621"><script>var element = document.getElementById("moose-equation-2a267eba-1fbc-4f2b-bade-01c178f02621");katex.render("c", element, {displayMode:false,throwOnError:false});</script></span> in the residual equation, the diagonal components are zero.</p></section><section id="39f18175-676f-4b72-bcb8-81c5b15bdead" data-section-level="4" data-section-text="Off - diagonal"><h4 id="off-diagonal">Off-diagonal</h4><p>We are looking for the <span tex="\frac \partial{\partial u_j}" bookmark="moose-equation-2436db4f-55d0-41a1-ae60-5d9a208a8e10" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2436db4f-55d0-41a1-ae60-5d9a208a8e10"><script>var element = document.getElementById("moose-equation-2436db4f-55d0-41a1-ae60-5d9a208a8e10");katex.render("\\frac \\partial{\\partial u_j}", element, {displayMode:false,throwOnError:false});</script></span> derivative of <span tex="R" bookmark="moose-equation-7fa13d82-e14e-4fd3-8e9e-5fc0a62ae14d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7fa13d82-e14e-4fd3-8e9e-5fc0a62ae14d"><script>var element = document.getElementById("moose-equation-7fa13d82-e14e-4fd3-8e9e-5fc0a62ae14d");katex.render("R", element, {displayMode:false,throwOnError:false});</script></span>, where <span tex="u\equiv c_a" bookmark="moose-equation-b253ce15-3238-4e89-8760-3be0a887a6a6" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b253ce15-3238-4e89-8760-3be0a887a6a6"><script>var element = document.getElementById("moose-equation-b253ce15-3238-4e89-8760-3be0a887a6a6");katex.render("u\\equiv c_a", element, {displayMode:false,throwOnError:false});</script></span>. We need to apply the chain rule and will again only keep terms with the <span tex="\frac{\partial c_a}{\partial u_j}\frac{\partial}{\partial c_a}=\phi_j \frac{\partial}{\partial c_a}" bookmark="moose-equation-aab211e0-bb8b-49ad-a0c1-f2306df8b108" recursive="True" class="moose-katex-inline-equation" id="moose-equation-aab211e0-bb8b-49ad-a0c1-f2306df8b108"><script>var element = document.getElementById("moose-equation-aab211e0-bb8b-49ad-a0c1-f2306df8b108");katex.render("\\frac{\\partial c_a}{\\partial u_j}\\frac{\\partial}{\\partial c_a}=\\phi_j \\frac{\\partial}{\\partial c_a}", element, {displayMode:false,throwOnError:false});</script></span> derivative.</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \frac{\partial R}{\partial u_j} = \phi_j \frac{\partial}{\partial c_a} \left( \frac{\partial F}{\partial c_a} - \mu \right)\\ &=& \phi_j  \frac{\partial^2F}{\partial c_a^2} \\ \end{aligned}" bookmark="moose-equation-818b3ce7-71ac-40af-a574-dbe458c07619" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-818b3ce7-71ac-40af-a574-dbe458c07619"></span><script>var element = document.getElementById("moose-equation-818b3ce7-71ac-40af-a574-dbe458c07619");katex.render("\\begin{aligned} J &=& \\frac{\\partial R}{\\partial u_j} = \\phi_j \\frac{\\partial}{\\partial c_a} \\left( \\frac{\\partial F}{\\partial c_a} - \\mu \\right)\\\\ &=& \\phi_j  \\frac{\\partial^2F}{\\partial c_a^2} \\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p><p>For <span tex="\mu" bookmark="moose-equation-8a738c6b-e515-4062-bca1-4668532478c2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8a738c6b-e515-4062-bca1-4668532478c2"><script>var element = document.getElementById("moose-equation-8a738c6b-e515-4062-bca1-4668532478c2");katex.render("\\mu", element, {displayMode:false,throwOnError:false});</script></span></p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial \mu} \left( \frac{\partial F}{\partial c_a} - \mu \right)\\ &=& -\phi_j \\ \end{aligned}" bookmark="moose-equation-61be014d-f84b-456e-92dd-f6d2346c7887" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-61be014d-f84b-456e-92dd-f6d2346c7887"></span><script>var element = document.getElementById("moose-equation-61be014d-f84b-456e-92dd-f6d2346c7887");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial \\mu} \\left( \\frac{\\partial F}{\\partial c_a} - \\mu \\right)\\\\ &=& -\\phi_j \\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p></section></section><section class="scrollspy" id="afacc8cb-1fdd-4fe7-b3c6-9a886b3293a3" data-section-level="2" data-section-text="KKSCHBulk"><h2 id="kkschbulk">KKSCHBulk</h2><p><a href="../../../source/kernels/KKSCHBulk.html"><code>KKSCHBulk</code></a> is the non-split version, which is <em></em>not fully implemented**. The non-linear variable for this Kernel is the concentration <span tex="c" bookmark="moose-equation-ed174089-5e45-44a6-b62a-7a65c8c566c4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ed174089-5e45-44a6-b62a-7a65c8c566c4"><script>var element = document.getElementById("moose-equation-ed174089-5e45-44a6-b62a-7a65c8c566c4");katex.render("c", element, {displayMode:false,throwOnError:false});</script></span>.</p><section id="3171d793-0e24-40a8-91ee-99143771e5b7" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p>In the residual routine we need to calculate the term <span tex="R=\nabla \frac{dF}{dc}" bookmark="moose-equation-c335996f-a47a-48c8-8bb3-9a79901f1c39" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c335996f-a47a-48c8-8bb3-9a79901f1c39"><script>var element = document.getElementById("moose-equation-c335996f-a47a-48c8-8bb3-9a79901f1c39");katex.render("R=\\nabla \\frac{dF}{dc}", element, {displayMode:false,throwOnError:false});</script></span>. We exploit the KKS identity <span tex="\frac{dF}{dc}=\frac{dF_a}{dc_a}=\frac{dF_b}{dc_b}" bookmark="moose-equation-4b86293b-b904-4814-9200-95bae93d4f1f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4b86293b-b904-4814-9200-95bae93d4f1f"><script>var element = document.getElementById("moose-equation-4b86293b-b904-4814-9200-95bae93d4f1f");katex.render("\\frac{dF}{dc}=\\frac{dF_a}{dc_a}=\\frac{dF_b}{dc_b}", element, {displayMode:false,throwOnError:false});</script></span> and arbitrarily use the a-phase instead. The gradient can be calculated through the chain rule (note that <span tex="F_a(c_a, p_1,p_2,\dots,p_n)" bookmark="moose-equation-26d0e07e-2bd3-48ea-b887-efe475dd52bd" recursive="True" class="moose-katex-inline-equation" id="moose-equation-26d0e07e-2bd3-48ea-b887-efe475dd52bd"><script>var element = document.getElementById("moose-equation-26d0e07e-2bd3-48ea-b887-efe475dd52bd");katex.render("F_a(c_a, p_1,p_2,\\dots,p_n)", element, {displayMode:false,throwOnError:false});</script></span> is potentially a function of many variables).</p><p><span class="moose-katex-block-equation"><span tex="R = \nabla \frac{dF_a}{dc_a} = \frac{d^2F_a}{dc_a^2}\nabla c_a + \sum_i \frac{d^2F_a}{dc_adp_i}\nabla p_i" bookmark="moose-equation-417a12d7-698e-40fe-969e-2f3b4a951db4" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-417a12d7-698e-40fe-969e-2f3b4a951db4"></span><script>var element = document.getElementById("moose-equation-417a12d7-698e-40fe-969e-2f3b4a951db4");katex.render("R = \\nabla \\frac{dF_a}{dc_a} = \\frac{d^2F_a}{dc_a^2}\\nabla c_a + \\sum_i \\frac{d^2F_a}{dc_adp_i}\\nabla p_i", element, {displayMode:true,throwOnError:false});</script></span></p><p>With <span tex="a = \{c_a, p_1,p_2,\dots,p_n\}" bookmark="moose-equation-8223c6fe-f994-41a0-b9a4-3f2266b8728d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8223c6fe-f994-41a0-b9a4-3f2266b8728d"><script>var element = document.getElementById("moose-equation-8223c6fe-f994-41a0-b9a4-3f2266b8728d");katex.render("a = \\{c_a, p_1,p_2,\\dots,p_n\\}", element, {displayMode:false,throwOnError:false});</script></span> being the vector of all arguments to <span tex="F_a" bookmark="moose-equation-b0caa64e-e102-4a86-aa1c-79f17037607f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b0caa64e-e102-4a86-aa1c-79f17037607f"><script>var element = document.getElementById("moose-equation-b0caa64e-e102-4a86-aa1c-79f17037607f");katex.render("F_a", element, {displayMode:false,throwOnError:false});</script></span> this simplifies to</p><p><span class="moose-katex-block-equation"><span tex="R=\sum_i \frac{d^2F_a}{dc_ada_i}\nabla a_i  = \sum_i R_i \nabla a_i" bookmark="moose-equation-3cfeac3e-0337-4969-9f85-5e7a974f99e3" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-3cfeac3e-0337-4969-9f85-5e7a974f99e3"></span><script>var element = document.getElementById("moose-equation-3cfeac3e-0337-4969-9f85-5e7a974f99e3");katex.render("R=\\sum_i \\frac{d^2F_a}{dc_ada_i}\\nabla a_i  = \\sum_i R_i \\nabla a_i", element, {displayMode:true,throwOnError:false});</script></span></p><p>using <span tex="R_i" bookmark="moose-equation-70490db0-01bc-4654-a931-dc9b9f9a27fe" recursive="True" class="moose-katex-inline-equation" id="moose-equation-70490db0-01bc-4654-a931-dc9b9f9a27fe"><script>var element = document.getElementById("moose-equation-70490db0-01bc-4654-a931-dc9b9f9a27fe");katex.render("R_i", element, {displayMode:false,throwOnError:false});</script></span> as a shorthand for the term <span tex="\frac{d^2F_a}{dc_ada_i}" bookmark="moose-equation-6b1f810b-5d70-4bd6-a5a6-ab79fa184cc2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6b1f810b-5d70-4bd6-a5a6-ab79fa184cc2"><script>var element = document.getElementById("moose-equation-6b1f810b-5d70-4bd6-a5a6-ab79fa184cc2");katex.render("\\frac{d^2F_a}{dc_ada_i}", element, {displayMode:false,throwOnError:false});</script></span> (and represented in the code as the array <code>_second_derivatives[i]</code>). We do have access to the gradients of <span tex="a_i" bookmark="moose-equation-23347953-dad3-43b3-a561-4fa1f1a3ca4a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-23347953-dad3-43b3-a561-4fa1f1a3ca4a"><script>var element = document.getElementById("moose-equation-23347953-dad3-43b3-a561-4fa1f1a3ca4a");katex.render("a_i", element, {displayMode:false,throwOnError:false});</script></span> through MOOSE (stored in <code>_grad\_args[i]</code>).</p></section><section id="0c2646eb-f496-41fa-9378-1ae3f9b42f0b" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><p>The calculation of the Jacobian involves the derivative of the Residual term <span tex="R" bookmark="moose-equation-3cc92630-20dc-40d9-b9d2-004e34359fcd" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3cc92630-20dc-40d9-b9d2-004e34359fcd"><script>var element = document.getElementById("moose-equation-3cc92630-20dc-40d9-b9d2-004e34359fcd");katex.render("R", element, {displayMode:false,throwOnError:false});</script></span> w.r.t. the individual coefficients <span tex="u_j" bookmark="moose-equation-48643a1b-9945-484b-9fac-03ae733dac29" recursive="True" class="moose-katex-inline-equation" id="moose-equation-48643a1b-9945-484b-9fac-03ae733dac29"><script>var element = document.getElementById("moose-equation-48643a1b-9945-484b-9fac-03ae733dac29");katex.render("u_j", element, {displayMode:false,throwOnError:false});</script></span> of all parameters of <span tex="F_a" bookmark="moose-equation-15dd183d-e9ea-451a-badf-d926f75070f1" recursive="True" class="moose-katex-inline-equation" id="moose-equation-15dd183d-e9ea-451a-badf-d926f75070f1"><script>var element = document.getElementById("moose-equation-15dd183d-e9ea-451a-badf-d926f75070f1");katex.render("F_a", element, {displayMode:false,throwOnError:false});</script></span>. Here <span tex="u" bookmark="moose-equation-7d1274c2-8b1a-43a2-91e1-4909aab4879a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7d1274c2-8b1a-43a2-91e1-4909aab4879a"><script>var element = document.getElementById("moose-equation-7d1274c2-8b1a-43a2-91e1-4909aab4879a");katex.render("u", element, {displayMode:false,throwOnError:false});</script></span> can stand for any variable <span tex="a_i" bookmark="moose-equation-c1da5e2b-1bfc-44c9-9510-f8035c375c5c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c1da5e2b-1bfc-44c9-9510-f8035c375c5c"><script>var element = document.getElementById("moose-equation-c1da5e2b-1bfc-44c9-9510-f8035c375c5c");katex.render("a_i", element, {displayMode:false,throwOnError:false});</script></span>.</p><p><span class="moose-katex-block-equation"><span tex="\frac{dR}{du_j} = \sum_i \left[ \frac d{du_j} R_i\nabla a_i \right] = \sum_i \left[  R_i\frac{d\nabla a_i}{du_j} + \nabla a_i \sum_k \frac {dR_i}{da_k}\frac{da_k}{du_j} \right]" bookmark="moose-equation-0b3b26a5-0e1c-47a0-8a22-22b86a0a67c7" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-0b3b26a5-0e1c-47a0-8a22-22b86a0a67c7"></span><script>var element = document.getElementById("moose-equation-0b3b26a5-0e1c-47a0-8a22-22b86a0a67c7");katex.render("\\frac{dR}{du_j} = \\sum_i \\left[ \\frac d{du_j} R_i\\nabla a_i \\right] = \\sum_i \\left[  R_i\\frac{d\\nabla a_i}{du_j} + \\nabla a_i \\sum_k \\frac {dR_i}{da_k}\\frac{da_k}{du_j} \\right]", element, {displayMode:true,throwOnError:false});</script></span></p><p>In the code <span tex="u" bookmark="moose-equation-cc52851a-2766-4de2-8f5b-cdd3d941106b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cc52851a-2766-4de2-8f5b-cdd3d941106b"><script>var element = document.getElementById("moose-equation-cc52851a-2766-4de2-8f5b-cdd3d941106b");katex.render("u", element, {displayMode:false,throwOnError:false});</script></span> is given by <code>jvar</code> for the off diagonal case, and <span tex="c" bookmark="moose-equation-6fc4cafb-c979-4d14-b899-05901b2d79bf" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6fc4cafb-c979-4d14-b899-05901b2d79bf"><script>var element = document.getElementById("moose-equation-6fc4cafb-c979-4d14-b899-05901b2d79bf");katex.render("c", element, {displayMode:false,throwOnError:false});</script></span> (not <span tex="c_a" bookmark="moose-equation-fdcb96ea-a708-41d7-853a-24e15e80536f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-fdcb96ea-a708-41d7-853a-24e15e80536f"><script>var element = document.getElementById("moose-equation-fdcb96ea-a708-41d7-853a-24e15e80536f");katex.render("c_a", element, {displayMode:false,throwOnError:false});</script></span> or <span tex="c_b" bookmark="moose-equation-429fbed3-40fe-40c7-8459-0dbb563202f9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-429fbed3-40fe-40c7-8459-0dbb563202f9"><script>var element = document.getElementById("moose-equation-429fbed3-40fe-40c7-8459-0dbb563202f9");katex.render("c_b", element, {displayMode:false,throwOnError:false});</script></span>!) in the on diagonal case.</p><section id="4a11d4a2-c1a8-4b56-ae50-2ac529be0c65" data-section-level="4" data-section-text="Off - diagonal"><h4 id="off-diagonal">Off-diagonal</h4><p>Let&#x27;s focus on off diagonal first. Here <span tex="\frac{da_k}{du_j}" bookmark="moose-equation-ee67200b-1b73-4d1f-a3da-db9a1effc955" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ee67200b-1b73-4d1f-a3da-db9a1effc955"><script>var element = document.getElementById("moose-equation-ee67200b-1b73-4d1f-a3da-db9a1effc955");katex.render("\\frac{da_k}{du_j}", element, {displayMode:false,throwOnError:false});</script></span> is zero, if <code>jvar</code> is not equal <span tex="k" bookmark="moose-equation-2f4dc0d8-646f-4b46-bff3-b5a0e57617aa" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2f4dc0d8-646f-4b46-bff3-b5a0e57617aa"><script>var element = document.getElementById("moose-equation-2f4dc0d8-646f-4b46-bff3-b5a0e57617aa");katex.render("k", element, {displayMode:false,throwOnError:false});</script></span>. Allowing us to remove the sum over <span tex="k" bookmark="moose-equation-a5044b4d-db84-4a7c-9e01-eb7a14e76171" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a5044b4d-db84-4a7c-9e01-eb7a14e76171"><script>var element = document.getElementById("moose-equation-a5044b4d-db84-4a7c-9e01-eb7a14e76171");katex.render("k", element, {displayMode:false,throwOnError:false});</script></span> and replace it with the single non-zero summand</p><p><span class="moose-katex-block-equation"><span tex="\frac{dR}{du_j} = \sum_i \left[  R_i\frac{d\nabla a_i}{du_j} + \nabla a_i \frac {dR_i}{da_\text{jvar}}\frac{da_\text{jvar}}{du_j} \right]" bookmark="moose-equation-baa82a5a-a97a-420b-83b4-e0e05964d035" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-baa82a5a-a97a-420b-83b4-e0e05964d035"></span><script>var element = document.getElementById("moose-equation-baa82a5a-a97a-420b-83b4-e0e05964d035");katex.render("\\frac{dR}{du_j} = \\sum_i \\left[  R_i\\frac{d\\nabla a_i}{du_j} + \\nabla a_i \\frac {dR_i}{da_\\text{jvar}}\\frac{da_\\text{jvar}}{du_j} \\right]", element, {displayMode:true,throwOnError:false});</script></span></p><p>In the first term in the square brackets the derivative <span tex="\frac{d\nabla a_i}{du_j}" bookmark="moose-equation-1b021160-9564-482a-89e9-231e48d7fe9a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1b021160-9564-482a-89e9-231e48d7fe9a"><script>var element = document.getElementById("moose-equation-1b021160-9564-482a-89e9-231e48d7fe9a");katex.render("\\frac{d\\nabla a_i}{du_j}", element, {displayMode:false,throwOnError:false});</script></span> is only non-zero if <span tex="i" bookmark="moose-equation-9d8a5383-96b3-44cf-a112-3b0bf13fa753" recursive="True" class="moose-katex-inline-equation" id="moose-equation-9d8a5383-96b3-44cf-a112-3b0bf13fa753"><script>var element = document.getElementById("moose-equation-9d8a5383-96b3-44cf-a112-3b0bf13fa753");katex.render("i", element, {displayMode:false,throwOnError:false});</script></span> is <code>jvar</code>. We can therefore pull this term out of the sum.</p><p><span class="moose-katex-block-equation"><span tex="\frac{dR}{du_j} = R_\text{jvar}\frac{d\nabla a_\text{jvar}}{du_j} + \sum_i  \nabla a_i \frac {dR_i}{da_\text{jvar}}\frac{da_\text{jvar}}{du_j}" bookmark="moose-equation-aef29141-9870-4ec0-a36f-c42762c8acfe" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-aef29141-9870-4ec0-a36f-c42762c8acfe"></span><script>var element = document.getElementById("moose-equation-aef29141-9870-4ec0-a36f-c42762c8acfe");katex.render("\\frac{dR}{du_j} = R_\\text{jvar}\\frac{d\\nabla a_\\text{jvar}}{du_j} + \\sum_i  \\nabla a_i \\frac {dR_i}{da_\\text{jvar}}\\frac{da_\\text{jvar}}{du_j}", element, {displayMode:true,throwOnError:false});</script></span></p><p>With the rules for <span tex="\frac d{du_j}" bookmark="moose-equation-43b4c031-36fb-4139-8698-624af9246791" recursive="True" class="moose-katex-inline-equation" id="moose-equation-43b4c031-36fb-4139-8698-624af9246791"><script>var element = document.getElementById("moose-equation-43b4c031-36fb-4139-8698-624af9246791");katex.render("\\frac d{du_j}", element, {displayMode:false,throwOnError:false});</script></span> derivatives we get</p><p><span class="moose-katex-block-equation"><span tex="R_\text{jvar} \nabla \phi_j + \sum_i \nabla a_i \frac {dR_i}{da_\text{jvar}} \phi_j" bookmark="moose-equation-beb4e781-db94-466c-a0e7-e09f4ccb614c" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-beb4e781-db94-466c-a0e7-e09f4ccb614c"></span><script>var element = document.getElementById("moose-equation-beb4e781-db94-466c-a0e7-e09f4ccb614c");katex.render("R_\\text{jvar} \\nabla \\phi_j + \\sum_i \\nabla a_i \\frac {dR_i}{da_\\text{jvar}} \\phi_j", element, {displayMode:true,throwOnError:false});</script></span></p><p>where <span tex="j" bookmark="moose-equation-fcf51ab9-3891-4835-8a12-55b42fda1780" recursive="True" class="moose-katex-inline-equation" id="moose-equation-fcf51ab9-3891-4835-8a12-55b42fda1780"><script>var element = document.getElementById("moose-equation-fcf51ab9-3891-4835-8a12-55b42fda1780");katex.render("j", element, {displayMode:false,throwOnError:false});</script></span> is <code>_j</code> in the code.</p></section><section id="5e2d666f-f15a-44d3-934b-5b6ea2a9b30b" data-section-level="4" data-section-text="On - diagonal"><h4 id="on-diagonal">On-diagonal</h4><p>For the on diagonal terms we look at the derivative w.r.t. the components of the non-linear variable <span tex="c" bookmark="moose-equation-326b709c-88a2-4951-bf04-58a1da162424" recursive="True" class="moose-katex-inline-equation" id="moose-equation-326b709c-88a2-4951-bf04-58a1da162424"><script>var element = document.getElementById("moose-equation-326b709c-88a2-4951-bf04-58a1da162424");katex.render("c", element, {displayMode:false,throwOnError:false});</script></span> of this kernel. Note, that <span tex="F_a" bookmark="moose-equation-304bbd17-5769-4ff2-9a44-229f996b4d84" recursive="True" class="moose-katex-inline-equation" id="moose-equation-304bbd17-5769-4ff2-9a44-229f996b4d84"><script>var element = document.getElementById("moose-equation-304bbd17-5769-4ff2-9a44-229f996b4d84");katex.render("F_a", element, {displayMode:false,throwOnError:false});</script></span> is only indirectly a function of <span tex="c" bookmark="moose-equation-e5ece9a2-8141-4e8a-a50b-31eb2d042bb3" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e5ece9a2-8141-4e8a-a50b-31eb2d042bb3"><script>var element = document.getElementById("moose-equation-e5ece9a2-8141-4e8a-a50b-31eb2d042bb3");katex.render("c", element, {displayMode:false,throwOnError:false});</script></span>. We assume the dependence is given through <span tex="c(c_a)" bookmark="moose-equation-27edb8ad-f6b9-4bd2-8bf8-c504f157d3b9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-27edb8ad-f6b9-4bd2-8bf8-c504f157d3b9"><script>var element = document.getElementById("moose-equation-27edb8ad-f6b9-4bd2-8bf8-c504f157d3b9");katex.render("c(c_a)", element, {displayMode:false,throwOnError:false});</script></span>. The chain rule will thus yield terms of this form</p><p><span class="moose-katex-block-equation"><span tex="\frac{dc_a}{dc} = \frac{\frac{d^2F_b}{dc_b^2}}{[1-h(\eta)]\frac{d^2F_b}{dc_b^2}+h(\eta)\frac{d^2F_a}{dc_a^2}}," bookmark="moose-equation-44a68c1a-507d-44f9-930a-7f419d3bd617" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-44a68c1a-507d-44f9-930a-7f419d3bd617"></span><script>var element = document.getElementById("moose-equation-44a68c1a-507d-44f9-930a-7f419d3bd617");katex.render("\\frac{dc_a}{dc} = \\frac{\\frac{d^2F_b}{dc_b^2}}{[1-h(\\eta)]\\frac{d^2F_b}{dc_b^2}+h(\\eta)\\frac{d^2F_a}{dc_a^2}},", element, {displayMode:true,throwOnError:false});</script></span></p><p>which is given as equation (23) in KKS. Following the off-diagonal  derivation we get</p><p>v \frac{d<sup>2F_a}{dc_a</sup>2}\frac{dc_a}{dc} \nabla \phi_j + \sum_i \nabla a_i \frac {dR_i}{dc_a} \frac{dc_a}{dc} \phi_j \end{equation}</p></section><section id="2d8e540b-cf27-41f4-9bc3-68bd85a06d0b" data-section-level="4" data-section-text="On - diagonal second approach"><h4 id="on-diagonal-second-approach">On-diagonal second approach</h4><p>Let&#x27;s get back to the original residual with <span tex="\frac{dF}{dc}" bookmark="moose-equation-cf4cb6a8-25a5-4498-8a4f-d471b8460322" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cf4cb6a8-25a5-4498-8a4f-d471b8460322"><script>var element = document.getElementById("moose-equation-cf4cb6a8-25a5-4498-8a4f-d471b8460322");katex.render("\\frac{dF}{dc}", element, {displayMode:false,throwOnError:false});</script></span>. Then</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{d}{dc} \nabla \frac{dF}{dc}\\ &=& \phi_j  \nabla \frac{d^2F}{dc^2} \quad,\quad \text{with (29) from KKS}\\ &=& \phi_j  \nabla \frac{\frac{d^2F_b}{dc_b^2}\frac{d^2F_a}{dc_a^2}}{  [1-h(\eta)]\frac{d^2F_b}{dc_b^2}+h(\eta)\frac{d^2F_a}{dc_a^2} }\\ \end{aligned}" bookmark="moose-equation-9c3ca883-8cc9-4a9e-a2e1-f48b1bd95164" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-9c3ca883-8cc9-4a9e-a2e1-f48b1bd95164"></span><script>var element = document.getElementById("moose-equation-9c3ca883-8cc9-4a9e-a2e1-f48b1bd95164");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{d}{dc} \\nabla \\frac{dF}{dc}\\\\ &=& \\phi_j  \\nabla \\frac{d^2F}{dc^2} \\quad,\\quad \\text{with (29) from KKS}\\\\ &=& \\phi_j  \\nabla \\frac{\\frac{d^2F_b}{dc_b^2}\\frac{d^2F_a}{dc_a^2}}{  [1-h(\\eta)]\\frac{d^2F_b}{dc_b^2}+h(\\eta)\\frac{d^2F_a}{dc_a^2} }\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p></section></section><section id="7a2994bc-c874-49f6-b900-58776b4ffe8a" data-section-level="1" data-section-text="Allen - Cahn Kernels"><h1 id="allen-cahn-kernels">Allen-Cahn  Kernels</h1><p>For the bulk Allen-Cahn residual we need to calculate the term</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} R=\frac{dF}{d\eta}&=&\frac{d}{d\eta}\left([1-h(\eta)]F_a + h(\eta)F_b+wg(\eta) \right)\\ &=& \frac{dF_a}{d\eta}+\frac{d}{d\eta}\left(h(\eta)F_b-h(\eta)F_a + wg(\eta)\right)\\ &=& \frac{dF_a}{d\eta}+F_b\frac{dh}{d\eta}-F_a\frac{dh}{d\eta}+h(\eta)\frac{dF_b}{d\eta}-h(\eta)\frac{dF_a}{d\eta} +w\frac{dg}{d\eta}\\ &=& \frac{dF_a}{d\eta}+\frac{dh}{d\eta}(F_b-F_a)+h(\eta)\left(\frac{dF_b}{d\eta}-\frac{dF_a}{d\eta}\right) +w\frac{dg}{d\eta}\\ &=& \frac{dh}{d\eta}(F_b-F_a) + \underbrace{[1-h(\eta)]\frac{dF_a}{d\eta} + h(\eta)\frac{dF_b}{d\eta}}_{\text{chain rule term}} +w\frac{dg}{d\eta}\\ &=& \frac{dh}{d\eta}(F_b-F_a) + [1-h(\eta)]\frac{dF_a}{dc_a}\frac{dc_a}{d\eta} + h(\eta)\frac{dF_b}{dc_b}\frac{dc_b}{d\eta} +w\frac{dg}{d\eta}\\ &=& \frac{dh}{d\eta}(F_b-F_a) + \frac{dF_a}{dc_a}\left([1-h(\eta)]\frac{dc_a}{d\eta} + h(\eta)\frac{dc_b}{d\eta}\right) +w\frac{dg}{d\eta} \end{aligned}" bookmark="moose-equation-ff43ccf1-eeee-4339-81a3-0f95b6b02460" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-ff43ccf1-eeee-4339-81a3-0f95b6b02460"></span><script>var element = document.getElementById("moose-equation-ff43ccf1-eeee-4339-81a3-0f95b6b02460");katex.render("\\begin{aligned} R=\\frac{dF}{d\\eta}&=&\\frac{d}{d\\eta}\\left([1-h(\\eta)]F_a + h(\\eta)F_b+wg(\\eta) \\right)\\\\ &=& \\frac{dF_a}{d\\eta}+\\frac{d}{d\\eta}\\left(h(\\eta)F_b-h(\\eta)F_a + wg(\\eta)\\right)\\\\ &=& \\frac{dF_a}{d\\eta}+F_b\\frac{dh}{d\\eta}-F_a\\frac{dh}{d\\eta}+h(\\eta)\\frac{dF_b}{d\\eta}-h(\\eta)\\frac{dF_a}{d\\eta} +w\\frac{dg}{d\\eta}\\\\ &=& \\frac{dF_a}{d\\eta}+\\frac{dh}{d\\eta}(F_b-F_a)+h(\\eta)\\left(\\frac{dF_b}{d\\eta}-\\frac{dF_a}{d\\eta}\\right) +w\\frac{dg}{d\\eta}\\\\ &=& \\frac{dh}{d\\eta}(F_b-F_a) + \\underbrace{[1-h(\\eta)]\\frac{dF_a}{d\\eta} + h(\\eta)\\frac{dF_b}{d\\eta}}_{\\text{chain rule term}} +w\\frac{dg}{d\\eta}\\\\ &=& \\frac{dh}{d\\eta}(F_b-F_a) + [1-h(\\eta)]\\frac{dF_a}{dc_a}\\frac{dc_a}{d\\eta} + h(\\eta)\\frac{dF_b}{dc_b}\\frac{dc_b}{d\\eta} +w\\frac{dg}{d\\eta}\\\\ &=& \\frac{dh}{d\\eta}(F_b-F_a) + \\frac{dF_a}{dc_a}\\left([1-h(\\eta)]\\frac{dc_a}{d\\eta} + h(\\eta)\\frac{dc_b}{d\\eta}\\right) +w\\frac{dg}{d\\eta} \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p><p>The _chain rule term_ results from the fact that <span tex="c_a" bookmark="moose-equation-010e58bf-98de-4bf2-acf5-ddd9a178390e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-010e58bf-98de-4bf2-acf5-ddd9a178390e"><script>var element = document.getElementById("moose-equation-010e58bf-98de-4bf2-acf5-ddd9a178390e");katex.render("c_a", element, {displayMode:false,throwOnError:false});</script></span> and <span tex="c_b" bookmark="moose-equation-92834930-b25c-451c-8e69-74c154d51268" recursive="True" class="moose-katex-inline-equation" id="moose-equation-92834930-b25c-451c-8e69-74c154d51268"><script>var element = document.getElementById("moose-equation-92834930-b25c-451c-8e69-74c154d51268");katex.render("c_b", element, {displayMode:false,throwOnError:false});</script></span> are dependent on <span tex="\eta" bookmark="moose-equation-d7981922-19e2-4b6a-b70c-c1ff8f9648e4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d7981922-19e2-4b6a-b70c-c1ff8f9648e4"><script>var element = document.getElementById("moose-equation-d7981922-19e2-4b6a-b70c-c1ff8f9648e4");katex.render("\\eta", element, {displayMode:false,throwOnError:false});</script></span> (see eqs. (25) and (26) in KKS). Setting <span tex="\lambda = [1-h(\eta)]\frac{d^2F_b}{dc_b^2}+h(\eta)\frac{d^2F_a}{dc_a^2}" bookmark="moose-equation-9c463363-a89f-4729-84a4-03837a4003b0" recursive="True" class="moose-katex-inline-equation" id="moose-equation-9c463363-a89f-4729-84a4-03837a4003b0"><script>var element = document.getElementById("moose-equation-9c463363-a89f-4729-84a4-03837a4003b0");katex.render("\\lambda = [1-h(\\eta)]\\frac{d^2F_b}{dc_b^2}+h(\\eta)\\frac{d^2F_a}{dc_a^2}", element, {displayMode:false,throwOnError:false});</script></span> we get</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} \frac{dc_a}{d\eta} &=& \frac1\lambda \frac{dh}{d\eta}(c_a-c_b)\frac{d^2F_b}{dc_b^2}\\ \frac{dc_b}{d\eta} &=& \frac1\lambda \frac{dh}{d\eta}(c_a-c_b)\frac{d^2F_a}{dc_a^2}. \end{aligned}" bookmark="moose-equation-f75b11e5-6822-4621-8f42-f4aa2217fe2e" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-f75b11e5-6822-4621-8f42-f4aa2217fe2e"></span><script>var element = document.getElementById("moose-equation-f75b11e5-6822-4621-8f42-f4aa2217fe2e");katex.render("\\begin{aligned} \\frac{dc_a}{d\\eta} &=& \\frac1\\lambda \\frac{dh}{d\\eta}(c_a-c_b)\\frac{d^2F_b}{dc_b^2}\\\\ \\frac{dc_b}{d\\eta} &=& \\frac1\\lambda \\frac{dh}{d\\eta}(c_a-c_b)\\frac{d^2F_a}{dc_a^2}. \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p><p>Substituting this in we get</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} R &=& \frac{dh}{d\eta}(F_b-F_a) + \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b)\frac1\lambda\underbrace{\left([1-h(\eta)] \frac{d^2F_b}{dc_b^2} + h(\eta)\frac{d^2F_a}{dc_a^2}\right)}_{=\lambda} +w\frac{dg}{d\eta}. \end{aligned}" bookmark="moose-equation-95f8397a-32d2-4014-b947-26983d9a02f9" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-95f8397a-32d2-4014-b947-26983d9a02f9"></span><script>var element = document.getElementById("moose-equation-95f8397a-32d2-4014-b947-26983d9a02f9");katex.render("\\begin{aligned} R &=& \\frac{dh}{d\\eta}(F_b-F_a) + \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b)\\frac1\\lambda\\underbrace{\\left([1-h(\\eta)] \\frac{d^2F_b}{dc_b^2} + h(\\eta)\\frac{d^2F_a}{dc_a^2}\\right)}_{=\\lambda} +w\\frac{dg}{d\\eta}. \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p><p>This simplifies to</p><p><span class="moose-katex-block-equation"><span tex="R=-\frac{dh}{d\eta} \left(F_a-F_b-\frac{dF_a}{dc_a}(c_a-c_b)\right) + w\frac{dg}{d\eta}." bookmark="moose-equation-4d67950c-1160-41cc-8b6e-b5ce58cb6a05" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-4d67950c-1160-41cc-8b6e-b5ce58cb6a05"></span><script>var element = document.getElementById("moose-equation-4d67950c-1160-41cc-8b6e-b5ce58cb6a05");katex.render("R=-\\frac{dh}{d\\eta} \\left(F_a-F_b-\\frac{dF_a}{dc_a}(c_a-c_b)\\right) + w\\frac{dg}{d\\eta}.", element, {displayMode:true,throwOnError:false});</script></span></p><p>We split this residual into two kernels to allow for multiple phase concentrations in a multi component system:</p><section class="scrollspy" id="d09eac8f-66d0-4dd2-a689-d85eb89970c8" data-section-level="2" data-section-text="KKSACBulkF"><h2><code>KKSACBulkF</code></h2><p><a href="../../../source/kernels/KKSACBulkF.html"><code>KKSACBulkF</code></a> is the part without a direct composition dependence.</p><section id="b0a729a7-fbc0-4271-b2ae-4e367e0ba95f" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p><span class="moose-katex-block-equation"><span tex="R=-\frac{dh}{d\eta}(F_a-F_b)+w\frac{dg}{d\eta}." bookmark="moose-equation-dfb96142-2f34-4940-a6da-cce3e1362d23" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-dfb96142-2f34-4940-a6da-cce3e1362d23"></span><script>var element = document.getElementById("moose-equation-dfb96142-2f34-4940-a6da-cce3e1362d23");katex.render("R=-\\frac{dh}{d\\eta}(F_a-F_b)+w\\frac{dg}{d\\eta}.", element, {displayMode:true,throwOnError:false});</script></span></p></section><section id="e1b9e9cf-fc5e-422d-bc2f-3f3bffad2069" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><section id="cabe3376-cdbe-404c-adb5-422c5ff1c73d" data-section-level="4" data-section-text="On - diagonal"><h4 id="on-diagonal">On-diagonal</h4><p>We are looking for the <span tex="\frac \partial{\partial u_j}" bookmark="moose-equation-8ca44e98-0041-45df-ad5b-a770a322c6cd" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8ca44e98-0041-45df-ad5b-a770a322c6cd"><script>var element = document.getElementById("moose-equation-8ca44e98-0041-45df-ad5b-a770a322c6cd");katex.render("\\frac \\partial{\\partial u_j}", element, {displayMode:false,throwOnError:false});</script></span> derivative of <span tex="R" bookmark="moose-equation-adc2e885-6b14-4f4f-98e5-05bbbc85fecf" recursive="True" class="moose-katex-inline-equation" id="moose-equation-adc2e885-6b14-4f4f-98e5-05bbbc85fecf"><script>var element = document.getElementById("moose-equation-adc2e885-6b14-4f4f-98e5-05bbbc85fecf");katex.render("R", element, {displayMode:false,throwOnError:false});</script></span>, where <span tex="u\equiv\eta" bookmark="moose-equation-b57160b5-0b04-4f59-a5e6-4ce8adf07fbf" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b57160b5-0b04-4f59-a5e6-4ce8adf07fbf"><script>var element = document.getElementById("moose-equation-b57160b5-0b04-4f59-a5e6-4ce8adf07fbf");katex.render("u\\equiv\\eta", element, {displayMode:false,throwOnError:false});</script></span>. We need to apply the chain rule and will again only keep terms with the <span tex="\frac{\partial \eta}{\partial u_j}\frac{\partial}{\partial \eta}=\phi_j \frac{\partial}{\partial\eta}" bookmark="moose-equation-f193252c-9645-42d6-bd2c-238b477d92d4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f193252c-9645-42d6-bd2c-238b477d92d4"><script>var element = document.getElementById("moose-equation-f193252c-9645-42d6-bd2c-238b477d92d4");katex.render("\\frac{\\partial \\eta}{\\partial u_j}\\frac{\\partial}{\\partial \\eta}=\\phi_j \\frac{\\partial}{\\partial\\eta}", element, {displayMode:false,throwOnError:false});</script></span> derivative.</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& -\phi_j \frac{\partial}{\partial \eta}\left( \frac{dh}{d\eta}(F_a-F_b) \right) + w \phi_j \frac{\partial}{\partial \eta}\frac{dg}{d\eta} \\ &=&-\frac{d^2h}{d\eta^2}\phi_j(F_a-F_b) + w\frac{d^2g}{d\eta^2}\phi_j \\ \end{aligned}" bookmark="moose-equation-32811d24-b72e-4610-9b1b-544c4443e9cb" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-32811d24-b72e-4610-9b1b-544c4443e9cb"></span><script>var element = document.getElementById("moose-equation-32811d24-b72e-4610-9b1b-544c4443e9cb");katex.render("\\begin{aligned} J &=& -\\phi_j \\frac{\\partial}{\\partial \\eta}\\left( \\frac{dh}{d\\eta}(F_a-F_b) \\right) + w \\phi_j \\frac{\\partial}{\\partial \\eta}\\frac{dg}{d\\eta} \\\\ &=&-\\frac{d^2h}{d\\eta^2}\\phi_j(F_a-F_b) + w\\frac{d^2g}{d\\eta^2}\\phi_j \\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p><p>(The implicit dependence of <span tex="F_a(c_a)" bookmark="moose-equation-54b2cb55-0ff1-4025-a90d-216394fab1b4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-54b2cb55-0ff1-4025-a90d-216394fab1b4"><script>var element = document.getElementById("moose-equation-54b2cb55-0ff1-4025-a90d-216394fab1b4");katex.render("F_a(c_a)", element, {displayMode:false,throwOnError:false});</script></span> and <span tex="F_b(c_a)" bookmark="moose-equation-e0e3b921-2e1b-4a68-94a2-31bc12a08915" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e0e3b921-2e1b-4a68-94a2-31bc12a08915"><script>var element = document.getElementById("moose-equation-e0e3b921-2e1b-4a68-94a2-31bc12a08915");katex.render("F_b(c_a)", element, {displayMode:false,throwOnError:false});</script></span> on <span tex="\eta" bookmark="moose-equation-4cf993d1-4645-4146-b5f6-33f3830d2ea0" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4cf993d1-4645-4146-b5f6-33f3830d2ea0"><script>var element = document.getElementById("moose-equation-4cf993d1-4645-4146-b5f6-33f3830d2ea0");katex.render("\\eta", element, {displayMode:false,throwOnError:false});</script></span> through <span tex="c_a(c,\eta)" bookmark="moose-equation-6cea7aec-bc75-445e-b1f2-35f8e80ff330" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6cea7aec-bc75-445e-b1f2-35f8e80ff330"><script>var element = document.getElementById("moose-equation-6cea7aec-bc75-445e-b1f2-35f8e80ff330");katex.render("c_a(c,\\eta)", element, {displayMode:false,throwOnError:false});</script></span> and <span tex="c_b(c,\eta)" bookmark="moose-equation-279ebf9f-2550-4107-b936-7b28898fa6cb" recursive="True" class="moose-katex-inline-equation" id="moose-equation-279ebf9f-2550-4107-b936-7b28898fa6cb"><script>var element = document.getElementById("moose-equation-279ebf9f-2550-4107-b936-7b28898fa6cb");katex.render("c_b(c,\\eta)", element, {displayMode:false,throwOnError:false});</script></span> does not contribute to the Jacobian, so <span tex="\frac{\partial F_a}{\partial \eta} = \frac{\partial F_a}{\partial \eta} = 0)" bookmark="moose-equation-fa5d35b8-fa6a-42d2-af22-44350e74d469" recursive="True" class="moose-katex-inline-equation" id="moose-equation-fa5d35b8-fa6a-42d2-af22-44350e74d469"><script>var element = document.getElementById("moose-equation-fa5d35b8-fa6a-42d2-af22-44350e74d469");katex.render("\\frac{\\partial F_a}{\\partial \\eta} = \\frac{\\partial F_a}{\\partial \\eta} = 0)", element, {displayMode:false,throwOnError:false});</script></span>.</p></section><section id="d076afb8-26a2-4298-8af2-2bed3e983a49" data-section-level="4" data-section-text="Off - Diagonal"><h4 id="off-diagonal">Off-Diagonal</h4><p>The off-diagonal components are calculated for any other variables that <span tex="F_a" bookmark="moose-equation-59ef1095-18b9-47e3-af61-97880cd39e5b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-59ef1095-18b9-47e3-af61-97880cd39e5b"><script>var element = document.getElementById("moose-equation-59ef1095-18b9-47e3-af61-97880cd39e5b");katex.render("F_a", element, {displayMode:false,throwOnError:false});</script></span> and <span tex="F_b" bookmark="moose-equation-1fc9a840-e2bf-47fe-a98b-fbf57cf9ede6" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1fc9a840-e2bf-47fe-a98b-fbf57cf9ede6"><script>var element = document.getElementById("moose-equation-1fc9a840-e2bf-47fe-a98b-fbf57cf9ede6");katex.render("F_b", element, {displayMode:false,throwOnError:false});</script></span> depend on. For example, for <span tex="c_a" bookmark="moose-equation-3c7d5cdd-7eef-49a2-9165-f04b5a5d194d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3c7d5cdd-7eef-49a2-9165-f04b5a5d194d"><script>var element = document.getElementById("moose-equation-3c7d5cdd-7eef-49a2-9165-f04b5a5d194d");katex.render("c_a", element, {displayMode:false,throwOnError:false});</script></span>:</p><p><span class="moose-katex-block-equation"><span tex="J = \frac{dh}{d\eta}\left( \frac{\partial F_a}{\partial c_a} - \frac{\partial F_b}{\partial c_a}\right)\phi_j" bookmark="moose-equation-5ba44910-09e6-43f4-a858-524c735c44d8" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-5ba44910-09e6-43f4-a858-524c735c44d8"></span><script>var element = document.getElementById("moose-equation-5ba44910-09e6-43f4-a858-524c735c44d8");katex.render("J = \\frac{dh}{d\\eta}\\left( \\frac{\\partial F_a}{\\partial c_a} - \\frac{\\partial F_b}{\\partial c_a}\\right)\\phi_j", element, {displayMode:true,throwOnError:false});</script></span></p><p><span tex="\frac{\partial F_b}{\partial c_a} = 0" bookmark="moose-equation-11e7c286-f794-4c4a-b4e0-4a89347b9a2e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-11e7c286-f794-4c4a-b4e0-4a89347b9a2e"><script>var element = document.getElementById("moose-equation-11e7c286-f794-4c4a-b4e0-4a89347b9a2e");katex.render("\\frac{\\partial F_b}{\\partial c_a} = 0", element, {displayMode:false,throwOnError:false});</script></span> in the KKS formulation, so this term would not need to be included if <span tex="c_a" bookmark="moose-equation-7d0d82a1-2d09-4c57-a6f1-5da9c1716fa2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7d0d82a1-2d09-4c57-a6f1-5da9c1716fa2"><script>var element = document.getElementById("moose-equation-7d0d82a1-2d09-4c57-a6f1-5da9c1716fa2");katex.render("c_a", element, {displayMode:false,throwOnError:false});</script></span> was the only variable <span tex="F_a" bookmark="moose-equation-a08c4649-7c43-48d7-a95c-e777749ed593" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a08c4649-7c43-48d7-a95c-e777749ed593"><script>var element = document.getElementById("moose-equation-a08c4649-7c43-48d7-a95c-e777749ed593");katex.render("F_a", element, {displayMode:false,throwOnError:false});</script></span> depended on. However, the code calculates derivatives with respect to all variables that <span tex="F_a" bookmark="moose-equation-e5554a65-b737-4b14-8219-cf5886b2b909" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e5554a65-b737-4b14-8219-cf5886b2b909"><script>var element = document.getElementById("moose-equation-e5554a65-b737-4b14-8219-cf5886b2b909");katex.render("F_a", element, {displayMode:false,throwOnError:false});</script></span> and <span tex="F_b" bookmark="moose-equation-09ebd08c-2c47-45c0-9101-6773731aa709" recursive="True" class="moose-katex-inline-equation" id="moose-equation-09ebd08c-2c47-45c0-9101-6773731aa709"><script>var element = document.getElementById("moose-equation-09ebd08c-2c47-45c0-9101-6773731aa709");katex.render("F_b", element, {displayMode:false,throwOnError:false});</script></span> depend on in a general way so that the Jacobian entries for other dependencies are correctly computed using the same piece of code. For example, both <span tex="F_a" bookmark="moose-equation-cbbc780a-8e6b-4a0b-9fae-f03a13e8425b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cbbc780a-8e6b-4a0b-9fae-f03a13e8425b"><script>var element = document.getElementById("moose-equation-cbbc780a-8e6b-4a0b-9fae-f03a13e8425b");katex.render("F_a", element, {displayMode:false,throwOnError:false});</script></span> and <span tex="F_b" bookmark="moose-equation-5dae915a-2e2d-4524-8884-c438a10fe695" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5dae915a-2e2d-4524-8884-c438a10fe695"><script>var element = document.getElementById("moose-equation-5dae915a-2e2d-4524-8884-c438a10fe695");katex.render("F_b", element, {displayMode:false,throwOnError:false});</script></span> could depend on temperature <span tex="T" bookmark="moose-equation-be362c1c-3ee9-44cc-aa0d-2c2643f125d4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-be362c1c-3ee9-44cc-aa0d-2c2643f125d4"><script>var element = document.getElementById("moose-equation-be362c1c-3ee9-44cc-aa0d-2c2643f125d4");katex.render("T", element, {displayMode:false,throwOnError:false});</script></span>, in which case</p><p><span class="moose-katex-block-equation"><span tex="J = \frac{dh}{d\eta}\left( \frac{\partial F_a}{\partial T} - \frac{\partial F_b}{\partial T}\right)\phi_j" bookmark="moose-equation-1e9e1db4-e8b4-45b8-9caa-837138437cf3" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-1e9e1db4-e8b4-45b8-9caa-837138437cf3"></span><script>var element = document.getElementById("moose-equation-1e9e1db4-e8b4-45b8-9caa-837138437cf3");katex.render("J = \\frac{dh}{d\\eta}\\left( \\frac{\\partial F_a}{\\partial T} - \\frac{\\partial F_b}{\\partial T}\\right)\\phi_j", element, {displayMode:true,throwOnError:false});</script></span></p><p>which is computed using the same code. The off-diagonal Jacobian contribution is also multiplied by the Allen-Cahn mobility <span tex="L" bookmark="moose-equation-e8fa31ee-e517-442f-8bd5-1d5d85e86902" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e8fa31ee-e517-442f-8bd5-1d5d85e86902"><script>var element = document.getElementById("moose-equation-e8fa31ee-e517-442f-8bd5-1d5d85e86902");katex.render("L", element, {displayMode:false,throwOnError:false});</script></span> at each point for consistency with the other terms in the Allen-Cahn equation.</p></section></section><section class="scrollspy" id="32c8340a-6f53-4ce4-9b44-8429b4a0aedd" data-section-level="2" data-section-text="KKSACBulkC"><h2><code>KKSACBulkC</code></h2><p><a href="../../../source/kernels/KKSACBulkC.html"><code>KKSACBulkC</code></a> is the part with a direct composition dependence. An instance of this kernel is needed for each compnent of the problem.</p><section id="35df3284-4a5d-47a1-ad97-a9f5d04bb0b2" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} R&=&-\frac{dh}{d\eta}\left(-\frac{dF_a}{dc_a}(c_a-c_b)\right)\\ &=&\frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \end{aligned}" bookmark="moose-equation-221af240-5135-42b4-b7ad-266bb4b0d7f9" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-221af240-5135-42b4-b7ad-266bb4b0d7f9"></span><script>var element = document.getElementById("moose-equation-221af240-5135-42b4-b7ad-266bb4b0d7f9");katex.render("\\begin{aligned} R&=&-\\frac{dh}{d\\eta}\\left(-\\frac{dF_a}{dc_a}(c_a-c_b)\\right)\\\\ &=&\\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p></section><section id="6f8d4200-797f-4ca2-a602-f95845a655de" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><section id="0f2bac2c-8571-442c-b920-ba7cefad6476" data-section-level="4" data-section-text="On - diagonal"><h4 id="on-diagonal">On-diagonal</h4><p>We are looking for the <span tex="\frac \partial{\partial u_j}" bookmark="moose-equation-baa5324f-63a2-4b88-85d2-54fcd6001596" recursive="True" class="moose-katex-inline-equation" id="moose-equation-baa5324f-63a2-4b88-85d2-54fcd6001596"><script>var element = document.getElementById("moose-equation-baa5324f-63a2-4b88-85d2-54fcd6001596");katex.render("\\frac \\partial{\\partial u_j}", element, {displayMode:false,throwOnError:false});</script></span> derivative of <span tex="R" bookmark="moose-equation-7d09c86f-a97f-43ff-a428-b663a6000e84" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7d09c86f-a97f-43ff-a428-b663a6000e84"><script>var element = document.getElementById("moose-equation-7d09c86f-a97f-43ff-a428-b663a6000e84");katex.render("R", element, {displayMode:false,throwOnError:false});</script></span>, where <span tex="u\equiv\eta" bookmark="moose-equation-32fae4d3-c711-4a97-8fbc-b4037e583051" recursive="True" class="moose-katex-inline-equation" id="moose-equation-32fae4d3-c711-4a97-8fbc-b4037e583051"><script>var element = document.getElementById("moose-equation-32fae4d3-c711-4a97-8fbc-b4037e583051");katex.render("u\\equiv\\eta", element, {displayMode:false,throwOnError:false});</script></span>. We need to apply the chain rule and will again only keep terms with the <span tex="\frac{\partial \eta}{\partial u_j}\frac{\partial}{\partial \eta} = \phi_j \frac{\partial}{\partial \eta}" bookmark="moose-equation-89c44d65-1102-40d4-af50-b915a886207f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-89c44d65-1102-40d4-af50-b915a886207f"><script>var element = document.getElementById("moose-equation-89c44d65-1102-40d4-af50-b915a886207f");katex.render("\\frac{\\partial \\eta}{\\partial u_j}\\frac{\\partial}{\\partial \\eta} = \\phi_j \\frac{\\partial}{\\partial \\eta}", element, {displayMode:false,throwOnError:false});</script></span> derivative.</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial \eta} \left( \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \right)\\ &=& \frac{d^2h}{d\eta^2}\phi_j\frac{dF_a}{dc_a}(c_a-c_b)\\ \end{aligned}" bookmark="moose-equation-e8b10bd0-0440-424b-b273-6ae7471f820e" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-e8b10bd0-0440-424b-b273-6ae7471f820e"></span><script>var element = document.getElementById("moose-equation-e8b10bd0-0440-424b-b273-6ae7471f820e");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial \\eta} \\left( \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\right)\\\\ &=& \\frac{d^2h}{d\\eta^2}\\phi_j\\frac{dF_a}{dc_a}(c_a-c_b)\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p></section><section id="098dc340-6dd8-42fb-bba9-062ae886124d" data-section-level="4" data-section-text="Off - diagonal"><h4 id="off-diagonal">Off-diagonal</h4><p>Since <span tex="c_a" bookmark="moose-equation-8a669752-5347-4bbd-be5a-419735f0a974" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8a669752-5347-4bbd-be5a-419735f0a974"><script>var element = document.getElementById("moose-equation-8a669752-5347-4bbd-be5a-419735f0a974");katex.render("c_a", element, {displayMode:false,throwOnError:false});</script></span> and <span tex="c_b" bookmark="moose-equation-3551c667-79b4-4814-b5c4-c9ea620b9e64" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3551c667-79b4-4814-b5c4-c9ea620b9e64"><script>var element = document.getElementById("moose-equation-3551c667-79b4-4814-b5c4-c9ea620b9e64");katex.render("c_b", element, {displayMode:false,throwOnError:false});</script></span> appear in the residual, their effect must be calculated separately from any other variable dependence. For <span tex="c_a" bookmark="moose-equation-4c7b914c-17a2-464f-b19c-1dfce731eb3a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4c7b914c-17a2-464f-b19c-1dfce731eb3a"><script>var element = document.getElementById("moose-equation-4c7b914c-17a2-464f-b19c-1dfce731eb3a");katex.render("c_a", element, {displayMode:false,throwOnError:false});</script></span>, we are looking for the <span tex="\frac \partial{\partial u_j}" bookmark="moose-equation-ef04addb-bd86-43a5-8661-b25d6d2f02bc" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ef04addb-bd86-43a5-8661-b25d6d2f02bc"><script>var element = document.getElementById("moose-equation-ef04addb-bd86-43a5-8661-b25d6d2f02bc");katex.render("\\frac \\partial{\\partial u_j}", element, {displayMode:false,throwOnError:false});</script></span> derivative of <span tex="R" bookmark="moose-equation-5b8be2b9-1b68-4865-b407-9639f1fe8ffb" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5b8be2b9-1b68-4865-b407-9639f1fe8ffb"><script>var element = document.getElementById("moose-equation-5b8be2b9-1b68-4865-b407-9639f1fe8ffb");katex.render("R", element, {displayMode:false,throwOnError:false});</script></span>, where <span tex="u\equiv c_a" bookmark="moose-equation-cf8b6e42-8061-4cd7-a017-862396f6be2b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cf8b6e42-8061-4cd7-a017-862396f6be2b"><script>var element = document.getElementById("moose-equation-cf8b6e42-8061-4cd7-a017-862396f6be2b");katex.render("u\\equiv c_a", element, {displayMode:false,throwOnError:false});</script></span>. We need to apply the chain rule and will again only keep terms with the <span tex="\frac{\partial c_a}{\partial u_j}\frac{\partial}{\partial c_a} = \phi_j \frac{\partial}{\partial c_a}" bookmark="moose-equation-7746a503-4752-413a-b4dd-8a5665c70347" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7746a503-4752-413a-b4dd-8a5665c70347"><script>var element = document.getElementById("moose-equation-7746a503-4752-413a-b4dd-8a5665c70347");katex.render("\\frac{\\partial c_a}{\\partial u_j}\\frac{\\partial}{\\partial c_a} = \\phi_j \\frac{\\partial}{\\partial c_a}", element, {displayMode:false,throwOnError:false});</script></span> derivative.</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial c_a} \left( \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \right)\\ &=& \frac{dh}{d\eta} \phi_j \left( \frac{d^2 F_a}{dc_a^2}(c_a-c_b) + \frac{d F_a}{d c_a}\right)\\ \end{aligned}" bookmark="moose-equation-8a586dff-5c66-4aba-aec4-a60993d3f44c" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-8a586dff-5c66-4aba-aec4-a60993d3f44c"></span><script>var element = document.getElementById("moose-equation-8a586dff-5c66-4aba-aec4-a60993d3f44c");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial c_a} \\left( \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\right)\\\\ &=& \\frac{dh}{d\\eta} \\phi_j \\left( \\frac{d^2 F_a}{dc_a^2}(c_a-c_b) + \\frac{d F_a}{d c_a}\\right)\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p><p>Similarly for <span tex="c_b" bookmark="moose-equation-2489e11a-7121-483f-9c74-1e996c5431b9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2489e11a-7121-483f-9c74-1e996c5431b9"><script>var element = document.getElementById("moose-equation-2489e11a-7121-483f-9c74-1e996c5431b9");katex.render("c_b", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial c_b} \left( \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \right)\\ &=& -\frac{dh}{d\eta} \phi_j  \frac{d F_a}{d c_a}\\ \end{aligned}" bookmark="moose-equation-870735a1-5c56-44b8-8f48-4b44706308cd" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-870735a1-5c56-44b8-8f48-4b44706308cd"></span><script>var element = document.getElementById("moose-equation-870735a1-5c56-44b8-8f48-4b44706308cd");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial c_b} \\left( \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\right)\\\\ &=& -\\frac{dh}{d\\eta} \\phi_j  \\frac{d F_a}{d c_a}\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p><p>For any variable other than <span tex="c_a" bookmark="moose-equation-a2c25046-4b84-419e-923e-fca4523656d2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a2c25046-4b84-419e-923e-fca4523656d2"><script>var element = document.getElementById("moose-equation-a2c25046-4b84-419e-923e-fca4523656d2");katex.render("c_a", element, {displayMode:false,throwOnError:false});</script></span> or <span tex="c_b" bookmark="moose-equation-ad7967f1-512a-4f90-9ff6-4862e5e94691" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ad7967f1-512a-4f90-9ff6-4862e5e94691"><script>var element = document.getElementById("moose-equation-ad7967f1-512a-4f90-9ff6-4862e5e94691");katex.render("c_b", element, {displayMode:false,throwOnError:false});</script></span>, for example temperature <span tex="T" bookmark="moose-equation-8e5a6e11-6a6a-4acb-8a5c-f7a2ee1e861f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8e5a6e11-6a6a-4acb-8a5c-f7a2ee1e861f"><script>var element = document.getElementById("moose-equation-8e5a6e11-6a6a-4acb-8a5c-f7a2ee1e861f");katex.render("T", element, {displayMode:false,throwOnError:false});</script></span>:</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial T} \left( \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \right)\\ &=& \frac{dh}{d\eta} \phi_j  \frac{\partial}{\partial T}\left(\frac{d F_a}{d c_a}\right) ( c_a - c_b)\\ \end{aligned}" bookmark="moose-equation-5895de33-c89e-4bce-b99f-837309d75ebc" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-5895de33-c89e-4bce-b99f-837309d75ebc"></span><script>var element = document.getElementById("moose-equation-5895de33-c89e-4bce-b99f-837309d75ebc");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial T} \\left( \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\right)\\\\ &=& \\frac{dh}{d\\eta} \\phi_j  \\frac{\\partial}{\\partial T}\\left(\\frac{d F_a}{d c_a}\\right) ( c_a - c_b)\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span></p><p>The off-diagonal Jacobian contributions are again multiplied by the Allen-Cahn mobility <span tex="L" bookmark="moose-equation-9f6c4118-de29-47bc-8dd0-4e5f8a3f2253" recursive="True" class="moose-katex-inline-equation" id="moose-equation-9f6c4118-de29-47bc-8dd0-4e5f8a3f2253"><script>var element = document.getElementById("moose-equation-9f6c4118-de29-47bc-8dd0-4e5f8a3f2253");katex.render("L", element, {displayMode:false,throwOnError:false});</script></span> at each point for consistency with the other terms in the Allen-Cahn equation.</p></section></section><section id="dbfbe629-5cab-4dea-837b-673e6a8e6f0e" data-section-level="1" data-section-text="Constraint Kernels"><h1 id="constraint-kernels">Constraint Kernels</h1><section class="scrollspy" id="0b1cf4ed-d628-4903-9584-fb9b69350bd0" data-section-level="2" data-section-text="KKSPhaseChemicalPotential"><h2><code>KKSPhaseChemicalPotential</code></h2><p><a href="../../../source/kernels/KKSPhaseChemicalPotential.html"><code>KKSPhaseChemicalPotential</code></a> enforces the point wise equality of the phase chemical potentials</p><p><span class="moose-katex-block-equation"><span tex="\frac{dF_a}{dc_a}=\frac{dF_b}{dc_b}." bookmark="moose-equation-7c556e95-354c-4fc0-9013-0786681e5723" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-7c556e95-354c-4fc0-9013-0786681e5723"></span><script>var element = document.getElementById("moose-equation-7c556e95-354c-4fc0-9013-0786681e5723");katex.render("\\frac{dF_a}{dc_a}=\\frac{dF_b}{dc_b}.", element, {displayMode:true,throwOnError:false});</script></span></p><p>The non-linear variable of this Kernel is <span tex="c_a" bookmark="moose-equation-cb68262c-ea22-4870-a894-dc0e2a887533" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cb68262c-ea22-4870-a894-dc0e2a887533"><script>var element = document.getElementById("moose-equation-cb68262c-ea22-4870-a894-dc0e2a887533");katex.render("c_a", element, {displayMode:false,throwOnError:false});</script></span>.</p><section id="2d8736df-eaea-420a-92a1-490e8b1d482d" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p><span class="moose-katex-block-equation"><span tex="R=\frac{dF_a}{dc_a} - \frac{dF_b}{dc_b}" bookmark="moose-equation-f2928bae-b3b1-4e3b-ab34-877dcdf1543c" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-f2928bae-b3b1-4e3b-ab34-877dcdf1543c"></span><script>var element = document.getElementById("moose-equation-f2928bae-b3b1-4e3b-ab34-877dcdf1543c");katex.render("R=\\frac{dF_a}{dc_a} - \\frac{dF_b}{dc_b}", element, {displayMode:true,throwOnError:false});</script></span></p></section><section id="dc984cbf-fd2e-435a-91d4-ce0b47975440" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><p>For the Jacobian we need to calculate</p><p><span class="moose-katex-block-equation"><span tex="J=\frac \partial{\partial u_j}\left( \frac{dF_a}{dc_a} - \frac{dF_b}{dc_b} \right)." bookmark="moose-equation-d19806be-346b-4643-bfcc-a4dd2cd90588" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-d19806be-346b-4643-bfcc-a4dd2cd90588"></span><script>var element = document.getElementById("moose-equation-d19806be-346b-4643-bfcc-a4dd2cd90588");katex.render("J=\\frac \\partial{\\partial u_j}\\left( \\frac{dF_a}{dc_a} - \\frac{dF_b}{dc_b} \\right).", element, {displayMode:true,throwOnError:false});</script></span></p><section id="42d18479-ca64-4fe3-83ed-899c2afa0609" data-section-level="4" data-section-text="On - Diagonal"><h4 id="on-diagonal">On-Diagonal</h4><p><span class="moose-katex-block-equation"><span tex="J = \phi_j \left( \frac{\partial^2 F_a}{\partial c_a^2} - \frac{\partial^2 F_b}{\partial c_a \partial c_b} \right)" bookmark="moose-equation-94f4de73-a02b-4a83-96b6-caf171485593" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-94f4de73-a02b-4a83-96b6-caf171485593"></span><script>var element = document.getElementById("moose-equation-94f4de73-a02b-4a83-96b6-caf171485593");katex.render("J = \\phi_j \\left( \\frac{\\partial^2 F_a}{\\partial c_a^2} - \\frac{\\partial^2 F_b}{\\partial c_a \\partial c_b} \\right)", element, {displayMode:true,throwOnError:false});</script></span></p></section><section id="f70ed968-0948-474b-b5cf-91fc7771f926" data-section-level="4" data-section-text="Off - Diagonal"><h4 id="off-diagonal">Off-Diagonal</h4><p>With <span tex="q" bookmark="moose-equation-ec35a6ab-5b49-4a8e-bbf4-3523aefc1a5c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ec35a6ab-5b49-4a8e-bbf4-3523aefc1a5c"><script>var element = document.getElementById("moose-equation-ec35a6ab-5b49-4a8e-bbf4-3523aefc1a5c");katex.render("q", element, {displayMode:false,throwOnError:false});</script></span> the union of the argument vectors of <span tex="F_a" bookmark="moose-equation-fc9da3c9-42a5-43f9-890b-ecedf85fde27" recursive="True" class="moose-katex-inline-equation" id="moose-equation-fc9da3c9-42a5-43f9-890b-ecedf85fde27"><script>var element = document.getElementById("moose-equation-fc9da3c9-42a5-43f9-890b-ecedf85fde27");katex.render("F_a", element, {displayMode:false,throwOnError:false});</script></span> and <span tex="F_b" bookmark="moose-equation-2ea4441f-e329-4e2f-8a6b-456511e65a25" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2ea4441f-e329-4e2f-8a6b-456511e65a25"><script>var element = document.getElementById("moose-equation-2ea4441f-e329-4e2f-8a6b-456511e65a25");katex.render("F_b", element, {displayMode:false,throwOnError:false});</script></span> (represented in the code by <code>_coupled_moose_vars[]</code>) we get</p><p><span class="moose-katex-block-equation"><span tex="\sum_i \left( \frac{\partial^2 F_a}{\partial c_a \partial q_i}\frac{\partial q_i}{\partial u_j} - \frac{\partial^2 F_b}{\partial c_b \partial q_i}\frac{\partial q_i}{\partial u_j} \right)." bookmark="moose-equation-f9f766fc-ed85-4873-9061-96001ee37cda" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-f9f766fc-ed85-4873-9061-96001ee37cda"></span><script>var element = document.getElementById("moose-equation-f9f766fc-ed85-4873-9061-96001ee37cda");katex.render("\\sum_i \\left( \\frac{\\partial^2 F_a}{\\partial c_a \\partial q_i}\\frac{\\partial q_i}{\\partial u_j} - \\frac{\\partial^2 F_b}{\\partial c_b \\partial q_i}\\frac{\\partial q_i}{\\partial u_j} \\right).", element, {displayMode:true,throwOnError:false});</script></span></p><p>Again the <span tex="\frac{\partial q_i}{\partial u_j}" bookmark="moose-equation-ee92f596-31f0-4965-9c3d-0b93d6c9169f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ee92f596-31f0-4965-9c3d-0b93d6c9169f"><script>var element = document.getElementById("moose-equation-ee92f596-31f0-4965-9c3d-0b93d6c9169f");katex.render("\\frac{\\partial q_i}{\\partial u_j}", element, {displayMode:false,throwOnError:false});</script></span> is non-zero only if <span tex="u\equiv q_i" bookmark="moose-equation-928dd383-deaf-420f-b17c-6c546c3ee002" recursive="True" class="moose-katex-inline-equation" id="moose-equation-928dd383-deaf-420f-b17c-6c546c3ee002"><script>var element = document.getElementById("moose-equation-928dd383-deaf-420f-b17c-6c546c3ee002");katex.render("u\\equiv q_i", element, {displayMode:false,throwOnError:false});</script></span>, which is the case if <span tex="q_i" bookmark="moose-equation-e3473122-8413-42cf-86a0-f41606fef7a1" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e3473122-8413-42cf-86a0-f41606fef7a1"><script>var element = document.getElementById("moose-equation-e3473122-8413-42cf-86a0-f41606fef7a1");katex.render("q_i", element, {displayMode:false,throwOnError:false});</script></span> is the argument selected through <code>jvar</code>.</p><p><span class="moose-katex-block-equation"><span tex="J = \frac{\partial^2 F_a}{\partial c_a \partial q_\text{jvar}}\phi_j - \frac{\partial^2 F_b}{\partial c_b \partial q_\text{jvar}}\phi_j." bookmark="moose-equation-9211ec33-5ef0-4a0c-9faa-de57ea2e01d2" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-9211ec33-5ef0-4a0c-9faa-de57ea2e01d2"></span><script>var element = document.getElementById("moose-equation-9211ec33-5ef0-4a0c-9faa-de57ea2e01d2");katex.render("J = \\frac{\\partial^2 F_a}{\\partial c_a \\partial q_\\text{jvar}}\\phi_j - \\frac{\\partial^2 F_b}{\\partial c_b \\partial q_\\text{jvar}}\\phi_j.", element, {displayMode:true,throwOnError:false});</script></span></p><p>Note that in the code <code>jvar</code> is not an index into <code>_coupled_moose_vars[]</code> but has to be resolved through the <code>_jvar_map</code>.</p></section></section><section class="scrollspy" id="4b1f83ad-052d-4bdb-a122-c17d64212e2a" data-section-level="2" data-section-text="KKSPhaseConcentration"><h2><code>KKSPhaseConcentration</code></h2><p><a href="../../../source/kernels/KKSPhaseConcentration.html"><code>KKSPhaseConcentration</code></a> enforces the split of the concentration into the phase concentrations, weighted by the switching function. The non-linear variable of this Kernel is <span tex="c_b" bookmark="moose-equation-1c0cc801-39c5-4aa7-9908-72d0003e6215" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1c0cc801-39c5-4aa7-9908-72d0003e6215"><script>var element = document.getElementById("moose-equation-1c0cc801-39c5-4aa7-9908-72d0003e6215");katex.render("c_b", element, {displayMode:false,throwOnError:false});</script></span>.</p><p><span class="moose-katex-block-equation"><span tex="c = [1-h(\eta)]c_a+h(\eta)c_b" bookmark="moose-equation-b4b912de-8ff1-4dab-a156-0fb43a55c1d2" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-b4b912de-8ff1-4dab-a156-0fb43a55c1d2"></span><script>var element = document.getElementById("moose-equation-b4b912de-8ff1-4dab-a156-0fb43a55c1d2");katex.render("c = [1-h(\\eta)]c_a+h(\\eta)c_b", element, {displayMode:true,throwOnError:false});</script></span></p><section id="5992f8ef-102a-4337-803f-5b8be73afd8b" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p><span class="moose-katex-block-equation"><span tex="R=[1-h(\eta)]c_a + h(\eta)c_b - c" bookmark="moose-equation-0a1588cb-cb14-481f-9323-8c0c7602cab6" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-0a1588cb-cb14-481f-9323-8c0c7602cab6"></span><script>var element = document.getElementById("moose-equation-0a1588cb-cb14-481f-9323-8c0c7602cab6");katex.render("R=[1-h(\\eta)]c_a + h(\\eta)c_b - c", element, {displayMode:true,throwOnError:false});</script></span></p></section><section id="818866b3-5320-41ba-b43f-9312eb15d0b0" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><section id="0f704d2f-67d1-4ccf-8317-c4e314aeffc0" data-section-level="4" data-section-text="On - Diagonal"><h4 id="on-diagonal">On-Diagonal</h4><p>Since the non-linear variable is <span tex="c_b" bookmark="moose-equation-78e67980-7b5a-4921-878e-c5fc53e9c54c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-78e67980-7b5a-4921-878e-c5fc53e9c54c"><script>var element = document.getElementById("moose-equation-78e67980-7b5a-4921-878e-c5fc53e9c54c");katex.render("c_b", element, {displayMode:false,throwOnError:false});</script></span>,</p><p><span class="moose-katex-block-equation"><span tex="J= \phi_j \frac{\partial R}{\partial c_b} = \phi_j h(\eta)" bookmark="moose-equation-61be8fdc-a5ff-44f0-bbd0-2518022e3068" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-61be8fdc-a5ff-44f0-bbd0-2518022e3068"></span><script>var element = document.getElementById("moose-equation-61be8fdc-a5ff-44f0-bbd0-2518022e3068");katex.render("J= \\phi_j \\frac{\\partial R}{\\partial c_b} = \\phi_j h(\\eta)", element, {displayMode:true,throwOnError:false});</script></span></p></section><section id="0eaf8a92-6a50-464c-92c3-6827a9cbc7d2" data-section-level="4" data-section-text="Off - Diagonal"><h4 id="off-diagonal">Off-Diagonal</h4><p>For <span tex="c_a" bookmark="moose-equation-ca5f96a3-74d0-4691-844a-3c66ee3c8d35" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ca5f96a3-74d0-4691-844a-3c66ee3c8d35"><script>var element = document.getElementById("moose-equation-ca5f96a3-74d0-4691-844a-3c66ee3c8d35");katex.render("c_a", element, {displayMode:false,throwOnError:false});</script></span></p><p><span class="moose-katex-block-equation"><span tex="J= \phi_j \frac{\partial R}{\partial c_a} = \phi_j [1-h(\eta)]" bookmark="moose-equation-2299d99e-dd8d-4c0c-9f83-efd6190a9868" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-2299d99e-dd8d-4c0c-9f83-efd6190a9868"></span><script>var element = document.getElementById("moose-equation-2299d99e-dd8d-4c0c-9f83-efd6190a9868");katex.render("J= \\phi_j \\frac{\\partial R}{\\partial c_a} = \\phi_j [1-h(\\eta)]", element, {displayMode:true,throwOnError:false});</script></span></p><p>For <span tex="c" bookmark="moose-equation-7bafc13b-5d13-489d-bbe3-d39b9a96f6e4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7bafc13b-5d13-489d-bbe3-d39b9a96f6e4"><script>var element = document.getElementById("moose-equation-7bafc13b-5d13-489d-bbe3-d39b9a96f6e4");katex.render("c", element, {displayMode:false,throwOnError:false});</script></span></p><p><span class="moose-katex-block-equation"><span tex="J= \phi_j \frac{\partial R}{\partial c} = -\phi_j" bookmark="moose-equation-8416a4c5-07c8-474f-ab80-525bdc3835d2" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-8416a4c5-07c8-474f-ab80-525bdc3835d2"></span><script>var element = document.getElementById("moose-equation-8416a4c5-07c8-474f-ab80-525bdc3835d2");katex.render("J= \\phi_j \\frac{\\partial R}{\\partial c} = -\\phi_j", element, {displayMode:true,throwOnError:false});</script></span></p><p>For <span tex="\eta" bookmark="moose-equation-0a689722-bda0-420f-a14f-df1e6fd38319" recursive="True" class="moose-katex-inline-equation" id="moose-equation-0a689722-bda0-420f-a14f-df1e6fd38319"><script>var element = document.getElementById("moose-equation-0a689722-bda0-420f-a14f-df1e6fd38319");katex.render("\\eta", element, {displayMode:false,throwOnError:false});</script></span></p><p><span class="moose-katex-block-equation"><span tex="J= \phi_j \frac{\partial R}{\partial \eta} = \phi_j \frac{dh}{d\eta}(c_b-c_a)" bookmark="moose-equation-be297e44-ebef-4ce5-bc9f-9ff33195948a" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-be297e44-ebef-4ce5-bc9f-9ff33195948a"></span><script>var element = document.getElementById("moose-equation-be297e44-ebef-4ce5-bc9f-9ff33195948a");katex.render("J= \\phi_j \\frac{\\partial R}{\\partial \\eta} = \\phi_j \\frac{dh}{d\\eta}(c_b-c_a)", element, {displayMode:true,throwOnError:false});</script></span> </p><div class="moose-bibliography"><ol><li id="kim_phase-field_1999">Seong&nbsp;Gyoon Kim, Won&nbsp;Tae Kim, and Toshio Suzuki.
Phase-field model for binary alloys.
<em>Physical Review E</em>, 60(6):7186–7197, December 1999.
URL: <a href="http://link.aps.org/doi/10.1103/PhysRevE.60.7186">http://link.aps.org/doi/10.1103/PhysRevE.60.7186</a>, <a href="https://doi.org/10.1103/PhysRevE.60.7186">doi:10.1103/PhysRevE.60.7186</a>.<a href="#46873b66-09eb-4423-8d2d-7d41d0180e32" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="46873b66-09eb-4423-8d2d-7d41d0180e32"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{kim_phase-field_1999,
    author = "Kim, Seong Gyoon and Kim, Won Tae and Suzuki, Toshio",
    title = "Phase-field model for binary alloys",
    volume = "60",
    url = "http://link.aps.org/doi/10.1103/PhysRevE.60.7186",
    doi = "10.1103/PhysRevE.60.7186",
    abstract = "We present a phase-field model ({PFM}) for solidification in binary alloys, which is found from the phase-field model for a pure material by direct comparison of the variables for a pure material solidification and alloy solidification. The model appears to be equivalent with the Wheeler-Boettinger-{McFadden} ({WBM}) model [A.A. Wheeler, W. J. Boettinger, and G. B. {McFadden}, Phys. Rev. A 45, 7424 (1992)], but has a different definition of the free energy density for interfacial region. An extra potential originated from the free energy density definition in the {WBM} model disappears in this model. At a dilute solution limit, the model is reduced to the Tiaden et al. model [Physica D 115, 73 (1998)] for a binary alloy. A relationship between the phase-field mobility and the interface kinetics coefficient is derived at a thin-interface limit condition under an assumption of negligible diffusivity in the solid phase. For a dilute alloy, a steady-state solution of the concentration profile across the diffuse interface is obtained as a function of the interface velocity and the resultant partition coefficient is compared with the previous solute trapping model. For one dimensional steady-state solidification, where the classical sharp-interface model is exactly soluble, we perform numerical simulations of the phase-field model: At low interface velocity, the simulated results from the thin-interface {PFM} are in excellent agreement with the exact solutions. As the partition coefficient becomes close to unit at high interface velocities, whereas, the sharp-interface {PFM} yields the correct answer.",
    number = "6",
    urldate = "2014-03-31",
    journal = "Physical Review E",
    month = "December",
    year = "1999",
    pages = "7186--7197",
    annote = "This is the {KKS} model paper",
    file = "Kim et al. - 1999 - Phase-field model for binary alloys.html:/Users/schwd/Library/Application Support/Firefox/Profiles/i2j5gt6k.default/zotero/storage/IQMMGVCR/Kim et al. - 1999 - Phase-field model for binary alloys.html:text/html;Kim et al. - 1999 - Phase-field model for binary alloys.pdf:/Users/schwd/Library/Application Support/Firefox/Profiles/i2j5gt6k.default/zotero/storage/R6VMMT2S/Kim et al. - 1999 - Phase-field model for binary alloys.pdf:application/pdf"
}
</code></pre></div></div></li></ol></div></section></section></section></section></section></section></section></section></section></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#48d0691b-e16f-45ef-87db-967414be863f" class="tooltipped" data-position="left" data-tooltip="KKSSplitCHCRes">KKSSplitCHCRes</a></li><li><a href="#5c63ecc9-38ca-4dd4-ac2f-79231851154c" class="tooltipped" data-position="left" data-tooltip="Residual">Residual</a></li><li><a href="#afacc8cb-1fdd-4fe7-b3c6-9a886b3293a3" class="tooltipped" data-position="left" data-tooltip="KKSCHBulk">KKSCHBulk</a></li><li><a href="#d09eac8f-66d0-4dd2-a689-d85eb89970c8" class="tooltipped" data-position="left" data-tooltip="KKSACBulkF">KKSACBulkF</a></li><li><a href="#32c8340a-6f53-4ce4-9b44-8429b4a0aedd" class="tooltipped" data-position="left" data-tooltip="KKSACBulkC">KKSACBulkC</a></li><li><a href="#0b1cf4ed-d628-4903-9584-fb9b69350bd0" class="tooltipped" data-position="left" data-tooltip="KKSPhaseChemicalPotential">KKSPhaseChemicalPotential</a></li><li><a href="#4b1f83ad-052d-4bdb-a122-c17d64212e2a" class="tooltipped" data-position="left" data-tooltip="KKSPhaseConcentration">KKSPhaseConcentration</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../../js/init.js"></script><script type="text/javascript" src="../../../js/navigation.js"></script><script type="text/javascript" src="../../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../../js/search_index.js"></script>