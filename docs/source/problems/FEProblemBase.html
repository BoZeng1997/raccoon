<!DOCTYPE html><head><meta charset="UTF-8"><link rel="icon" type="image/x-icon" href="../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../contrib/plotly/plotly.min.js"></script><title>FEProblemBase|RACCOON</title></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon/index.html" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../install/index.html">Install</a></li><li><a href="../../examples/index.html">Examples</a></li><li><a href="../../theory/index.html">Theory</a></li><li><a href="../../documentation/index.html">Documentation</a></li></ul><a href="#" class="sidenav-trigger" data-target="754e6539-90bb-4dc5-8c21-d73237fcc8f4"><i class="material-icons">menu</i></a><ul class="sidenav" id="754e6539-90bb-4dc5-8c21-d73237fcc8f4"><li><a href="../../install/index.html">Install</a></li><li><a href="../../examples/index.html">Examples</a></li><li><a href="../../theory/index.html">Theory</a></li><li><a href="../../documentation/index.html">Documentation</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon/index.html" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">source</a><span class="breadcrumb">problems</span><a href="#" class="breadcrumb">FEProblemBase</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="00bb8e9c-1afe-4e10-af24-f7962f0fce47" data-section-level="1" data-section-text="FEProblemBase"><h1 id="feproblembase">FEProblemBase</h1><p>The FEProblemBase class is an intermediate base class containing all of the common logic for running the various MOOSE simulations. MOOSE has two built-in types of problems <a href="FEProblem.html">FEProblem</a> for solving &quot;normal&quot; physics problems and <a href="EigenProblem.html">EigenProblem</a> for solving Eigenvalue problems. Additionally, MOOSE contains an <a href="ExternalProblem.html">ExternalProblem</a> problem useful for creating &quot;MOOSE-wrapped Apps&quot;.</p><section class="scrollspy" id="5944d3f9-d6b7-4cad-82f6-72e567e04faf" data-section-level="2" data-section-text="Convenience Zeros"><h2 id="convenience-zeros">Convenience Zeros</h2><p>One of the advantages of the MOOSE framework is the ease at building up Multiphysics simulations. Coupling is a first-class feature and filling out residuals, or materials properties with coupling is very natural. When coupling is optional, it is often handy to have access to valid data structures that may be used in-place of the actual coupled variables. This makes it possible to avoid branch statements inside of your residual statements and other computationally intensive areas of code. One of the ways MOOSE makes this possible is by making several different types of &quot;zero&quot; variables available. The following statements illustrate how optional coupling may be implemented with these zeros.</p><pre class="moose-pre"><code class="language-cpp">
// In the constructor initialization list of a Kernel

  _velocity_vector(isParamValid(&quot;velocity_vector&quot;) ? coupledGradient(&quot;velocity_vector&quot;) : _grad_zero)


// The residual statement

  return _test[_i][_qp] * (_velocity_vector[_qp] * _grad_u[_qp]);
</code></pre></section><section class="scrollspy" id="b8cd3e49-23e2-4d59-a9c8-b6835ec6cf58" data-section-level="2" data-section-text="Selective Reinit"><h2 id="selective-reinit">Selective Reinit</h2><p>The system automatically determines which variables should be made available for use on the current element (&quot;reinit&quot;-ed). Each variable is tracked on calls through the coupling interface. Variables that are not needed are simply not prepared. This can save significant amounts of time on systems that have several active variables.</p></section><section class="scrollspy" id="4459351e-cc2f-415d-b668-0dd5ba640154" data-section-level="2" data-section-text="Finite Element Concepts"><h2 id="finite-element-concepts">Finite Element Concepts</h2><section id="8133d900-d92f-44d7-9605-4887fb56787d" data-section-level="3" data-section-text="Shape Functions"><h3 id="shape_functions">Shape Functions</h3><ul class="browser-default"><li><p>While the weak form is essentially what you need for adding physics to MOOSE, in traditional finite element software more work is necessary. </p></li><li><p>We need to discretize our weak form and select a set of simple &quot;basis functions&quot; amenable for manipulation by a computer.</p></li></ul><div class="card moose-float" style="width:50%;"><div class="card-content"><img src="../../media/problems/basis-function-example.jpg" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-text">Example of linear Lagrange shape function associated with single        node on triangular mesh</span></p></div></div><div class="card moose-float" style="width:25%;"><div class="card-content"><img src="../../media/problems/Oden-linear-lagrange.jpg" class="materialboxed moose-image"></img><p class="moose-caption"><span class="moose-caption-text">1D linear Lagrange shape functions</span></p></div></div><ul class="browser-default"><li><p>Our discretized expansion of <span bookmark="moose-equation-8488f707-67b0-4839-af6e-a7329fbd2eb1" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8488f707-67b0-4839-af6e-a7329fbd2eb1"><script>var element = document.getElementById("moose-equation-8488f707-67b0-4839-af6e-a7329fbd2eb1");katex.render("", element, {displayMode:false,throwOnError:false});</script></span>u<span bookmark="moose-equation-885d8507-a7d3-49e0-a7ba-078bf15bcd1c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-885d8507-a7d3-49e0-a7ba-078bf15bcd1c"><script>var element = document.getElementById("moose-equation-885d8507-a7d3-49e0-a7ba-078bf15bcd1c");katex.render("", element, {displayMode:false,throwOnError:false});</script></span> takes on the following form: <span tex="u \approx u_h = \sum_{j=1}^N u_j \phi_j" bookmark="moose-equation-cf4b9afd-5dd3-4a73-9747-4ef41630ca0d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cf4b9afd-5dd3-4a73-9747-4ef41630ca0d"><script>var element = document.getElementById("moose-equation-cf4b9afd-5dd3-4a73-9747-4ef41630ca0d");katex.render("u \\approx u_h = \\sum_{j=1}^N u_j \\phi_j", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p>The <span tex="\phi_j" bookmark="moose-equation-350df619-ae15-400c-9e1d-3f169031ec9a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-350df619-ae15-400c-9e1d-3f169031ec9a"><script>var element = document.getElementById("moose-equation-350df619-ae15-400c-9e1d-3f169031ec9a");katex.render("\\phi_j", element, {displayMode:false,throwOnError:false});</script></span> here are called &quot;basis functions&quot; </p></li><li><p>These <span tex="\phi_j" bookmark="moose-equation-dac81a8c-5bef-4c87-bcc8-5be9e6795d97" recursive="True" class="moose-katex-inline-equation" id="moose-equation-dac81a8c-5bef-4c87-bcc8-5be9e6795d97"><script>var element = document.getElementById("moose-equation-dac81a8c-5bef-4c87-bcc8-5be9e6795d97");katex.render("\\phi_j", element, {displayMode:false,throwOnError:false});</script></span> form the basis for the &quot;trial function&quot;, <span tex="u_h" bookmark="moose-equation-89221450-72a8-490f-b5af-6fde103e7b0e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-89221450-72a8-490f-b5af-6fde103e7b0e"><script>var element = document.getElementById("moose-equation-89221450-72a8-490f-b5af-6fde103e7b0e");katex.render("u_h", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p>Analogous to the <span tex="x^n" bookmark="moose-equation-4e1b48a6-9dc4-43de-be78-00b556094ccd" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4e1b48a6-9dc4-43de-be78-00b556094ccd"><script>var element = document.getElementById("moose-equation-4e1b48a6-9dc4-43de-be78-00b556094ccd");katex.render("x^n", element, {displayMode:false,throwOnError:false});</script></span> we used earlier </p></li><li><p>The gradient of <span tex="u" bookmark="moose-equation-4847c66b-bf86-4547-8b42-9e7c16d0168e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4847c66b-bf86-4547-8b42-9e7c16d0168e"><script>var element = document.getElementById("moose-equation-4847c66b-bf86-4547-8b42-9e7c16d0168e");katex.render("u", element, {displayMode:false,throwOnError:false});</script></span> can be expanded similarly:  <span tex="\nabla u \approx \nabla u_h = \sum_{j=1}^N u_j \nabla \phi_j" bookmark="moose-equation-0699cd7e-f4f2-4da2-ad2e-c7350c819baa" recursive="True" class="moose-katex-inline-equation" id="moose-equation-0699cd7e-f4f2-4da2-ad2e-c7350c819baa"><script>var element = document.getElementById("moose-equation-0699cd7e-f4f2-4da2-ad2e-c7350c819baa");katex.render("\\nabla u \\approx \\nabla u_h = \\sum_{j=1}^N u_j \\nabla \\phi_j", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p>In the Galerkin finite element method, the same basis functions are used for both the trial and test functions:   <span tex="\psi = \{\phi_i\}_{i=1}^N" bookmark="moose-equation-ecdaf450-aaef-4ac8-9392-70c59eec9304" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ecdaf450-aaef-4ac8-9392-70c59eec9304"><script>var element = document.getElementById("moose-equation-ecdaf450-aaef-4ac8-9392-70c59eec9304");katex.render("\\psi = \\{\\phi_i\\}_{i=1}^N", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p>Substituting these expansions back into our weak form, we get:   <span tex="\left(\nabla\psi_i, k\nabla u_h \right) - \langle\psi_i, k\nabla u_h\cdot \hat{n} \rangle +      \left(\psi_i, \vec{\beta} \cdot \nabla u_h\right) - \left(\psi_i, f\right) = 0, \quad i=1,\ldots,N" bookmark="moose-equation-b954cb04-681e-4ee2-b07c-c76a1fc8c633" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b954cb04-681e-4ee2-b07c-c76a1fc8c633"><script>var element = document.getElementById("moose-equation-b954cb04-681e-4ee2-b07c-c76a1fc8c633");katex.render("\\left(\\nabla\\psi_i, k\\nabla u_h \\right) - \\langle\\psi_i, k\\nabla u_h\\cdot \\hat{n} \\rangle +      \\left(\\psi_i, \\vec{\\beta} \\cdot \\nabla u_h\\right) - \\left(\\psi_i, f\\right) = 0, \\quad i=1,\\ldots,N", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p>The left-hand side of the equation above is what we generally refer to as the <span tex="i^{th}" bookmark="moose-equation-e43510e7-b9d5-4200-8a1e-f2e9ebf23199" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e43510e7-b9d5-4200-8a1e-f2e9ebf23199"><script>var element = document.getElementById("moose-equation-e43510e7-b9d5-4200-8a1e-f2e9ebf23199");katex.render("i^{th}", element, {displayMode:false,throwOnError:false});</script></span> component of our &quot;Residual Vector&quot; and write as <span tex="R_i(u_h)" bookmark="moose-equation-ddf3428a-cd03-42eb-905a-3c58070e94b2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ddf3428a-cd03-42eb-905a-3c58070e94b2"><script>var element = document.getElementById("moose-equation-ddf3428a-cd03-42eb-905a-3c58070e94b2");katex.render("R_i(u_h)", element, {displayMode:false,throwOnError:false});</script></span>. </p></li><li><p>Shape Functions are the functions that get multiplied by coefficients and summed to form the solution. </p></li><li><p>Individual shape functions are restrictions of the global basis functions to individual elements. </p></li><li><p>They are analogous to the <span tex="x^n" bookmark="moose-equation-5f1d8109-cf82-46e2-b52a-c1e0c4fd40a6" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5f1d8109-cf82-46e2-b52a-c1e0c4fd40a6"><script>var element = document.getElementById("moose-equation-5f1d8109-cf82-46e2-b52a-c1e0c4fd40a6");katex.render("x^n", element, {displayMode:false,throwOnError:false});</script></span> functions from polynomial fitting (in fact, you can use those as shape functions). </p></li><li><p>Typical shape function families: Lagrange, Hermite, Hierarchic, Monomial, Clough-Toucher   - MOOSE has support for all of these. </p></li><li><p>Lagrange shape functions are the most common.   -  They are interpolary at the nodes, i.e., the coefficients correspond to the values of the functions at the nodes.</p></li></ul><section id="a7a7bfc9-76b5-4044-b00c-661c35b6cd9a" data-section-level="4" data-section-text="Example 1 D Shape Functions"><h4 id="example-1-d-shape-functions">Example 1D Shape Functions</h4><img src="../../media/problems/linear-lagrange-graph.jpg" class="materialboxed moose-image" style="width:50%;"></img><p>Linear Lagrange</p><img src="../../media/problems/quadratic-lagrange-graph.jpg" class="materialboxed moose-image" style="width:50%;"></img><p>Quadratic Lagrange</p><img src="../../media/problems/cubic-lagrange-graph.jpg" class="materialboxed moose-image" style="width:50%;"></img><p>Cubic Lagrange</p><img src="../../media/problems/cubic-hermite-graph.jpg" class="materialboxed moose-image" style="width:50%;"></img><p>Cubic Hermite</p></section><section id="cdb2966a-a53a-4601-9c25-8550c7d823ef" data-section-level="4" data-section-text="2 D Lagrange Shape Functions"><h4 id="2-d-lagrange-shape-functions">2D Lagrange Shape Functions</h4><p>Example bi-quadratic basis functions defined on the Quad9 element:</p><ul class="browser-default"><li><p><span tex="\psi_0" bookmark="moose-equation-0ef6288a-6266-4486-9d0f-f547e3d48a34" recursive="True" class="moose-katex-inline-equation" id="moose-equation-0ef6288a-6266-4486-9d0f-f547e3d48a34"><script>var element = document.getElementById("moose-equation-0ef6288a-6266-4486-9d0f-f547e3d48a34");katex.render("\\psi_0", element, {displayMode:false,throwOnError:false});</script></span> is associated to a &quot;corner&quot; node, it is zero on the opposite edges. </p></li><li><p><span tex="\psi_4" bookmark="moose-equation-a5c0fa42-dbea-4e9d-b4f1-863b45810fd5" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a5c0fa42-dbea-4e9d-b4f1-863b45810fd5"><script>var element = document.getElementById("moose-equation-a5c0fa42-dbea-4e9d-b4f1-863b45810fd5");katex.render("\\psi_4", element, {displayMode:false,throwOnError:false});</script></span> is associated to a &quot;mid-edge&quot; node, it is zero on all other edges. </p></li><li><p><span tex="\psi_8" bookmark="moose-equation-caf75075-54e0-41e4-97b0-4cbf2228b777" recursive="True" class="moose-katex-inline-equation" id="moose-equation-caf75075-54e0-41e4-97b0-4cbf2228b777"><script>var element = document.getElementById("moose-equation-caf75075-54e0-41e4-97b0-4cbf2228b777");katex.render("\\psi_8", element, {displayMode:false,throwOnError:false});</script></span> is associated to the &quot;center&quot; node, it is symmetric and <span tex="\geq 0" bookmark="moose-equation-795ebaa9-409a-42d5-852b-c11303d7f3e5" recursive="True" class="moose-katex-inline-equation" id="moose-equation-795ebaa9-409a-42d5-852b-c11303d7f3e5"><script>var element = document.getElementById("moose-equation-795ebaa9-409a-42d5-852b-c11303d7f3e5");katex.render("\\geq 0", element, {displayMode:false,throwOnError:false});</script></span> on the element.</p></li></ul><img src="../../media/problems/quad9-corner.jpg" class="materialboxed moose-image" style="width:50%;"></img><p><span tex="\psi_0" bookmark="moose-equation-506a6d33-71f7-4158-aead-42f068f49f99" recursive="True" class="moose-katex-inline-equation" id="moose-equation-506a6d33-71f7-4158-aead-42f068f49f99"><script>var element = document.getElementById("moose-equation-506a6d33-71f7-4158-aead-42f068f49f99");katex.render("\\psi_0", element, {displayMode:false,throwOnError:false});</script></span></p><img src="../../media/problems/quad9-edge.png" class="materialboxed moose-image" style="width:50%;"></img><p><span tex="\psi_4" bookmark="moose-equation-98253eda-8f7c-4062-9f3a-b317fb6f164c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-98253eda-8f7c-4062-9f3a-b317fb6f164c"><script>var element = document.getElementById("moose-equation-98253eda-8f7c-4062-9f3a-b317fb6f164c");katex.render("\\psi_4", element, {displayMode:false,throwOnError:false});</script></span></p><img src="../../media/problems/quad9-center.jpg" class="materialboxed moose-image" style="width:50%;"></img><p><span tex="\psi_8" bookmark="moose-equation-ffce720b-df46-49bd-81cb-42f6edd27d9f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ffce720b-df46-49bd-81cb-42f6edd27d9f"><script>var element = document.getElementById("moose-equation-ffce720b-df46-49bd-81cb-42f6edd27d9f");katex.render("\\psi_8", element, {displayMode:false,throwOnError:false});</script></span></p></section></section><section id="032107c6-6ae3-456f-935d-d19f24174f96" data-section-level="3" data-section-text="Numerical Integration"><h3 id="numerical_integration">Numerical Integration</h3><ul class="browser-default"><li><p>The only remaining non-discretized parts of the weak form are the integrals. </p></li><li><p>We split the domain integral into a sum of integrals over elements: <span tex="\int_{\Omega} f(\vec{x}) \;\text{d}\vec{x} = \sum_e \int_{\Omega_e} f(\vec{x}) \;\text{d}\vec{x}" bookmark="moose-equation-3001c4bc-d7df-416e-8490-efa1c053bcb8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3001c4bc-d7df-416e-8490-efa1c053bcb8"><script>var element = document.getElementById("moose-equation-3001c4bc-d7df-416e-8490-efa1c053bcb8");katex.render("\\int_{\\Omega} f(\\vec{x}) \\;\\text{d}\\vec{x} = \\sum_e \\int_{\\Omega_e} f(\\vec{x}) \\;\\text{d}\\vec{x}", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p>Through a change of variables, the element integrals are mapped to integrals over the &quot;reference&quot; elements <span tex="\hat{\Omega}_e" bookmark="moose-equation-fb8fe0c4-0dd8-4117-86ed-a4a82689f61f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-fb8fe0c4-0dd8-4117-86ed-a4a82689f61f"><script>var element = document.getElementById("moose-equation-fb8fe0c4-0dd8-4117-86ed-a4a82689f61f");katex.render("\\hat{\\Omega}_e", element, {displayMode:false,throwOnError:false});</script></span>. <span tex="\sum_e \int_{\Omega_e} f(\vec{x}) \;\text{d}\vec{x} =       \sum_e \int_{\hat{\Omega}_e} f(\vec{\xi}) \left|\mathcal{J}_e\right| \;\text{d}\vec{\xi}" bookmark="moose-equation-b17b9411-81cc-4d7f-a589-a8d2813158b6" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b17b9411-81cc-4d7f-a589-a8d2813158b6"><script>var element = document.getElementById("moose-equation-b17b9411-81cc-4d7f-a589-a8d2813158b6");katex.render("\\sum_e \\int_{\\Omega_e} f(\\vec{x}) \\;\\text{d}\\vec{x} =       \\sum_e \\int_{\\hat{\\Omega}_e} f(\\vec{\\xi}) \\left|\\mathcal{J}_e\\right| \\;\\text{d}\\vec{\\xi}", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p><span tex="\mathcal{J}_e" bookmark="moose-equation-b0dfad70-d3ad-46e0-b963-eaf3b01fc57b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b0dfad70-d3ad-46e0-b963-eaf3b01fc57b"><script>var element = document.getElementById("moose-equation-b0dfad70-d3ad-46e0-b963-eaf3b01fc57b");katex.render("\\mathcal{J}_e", element, {displayMode:false,throwOnError:false});</script></span> is the Jacobian of the map from the physical element to the reference element. </p></li><li><p>To approximate the reference element integrals numerically, we use quadrature (typically &quot;Gaussian Quadrature&quot;): <span tex="\sum_e \int_{\hat{\Omega}_e} f(\vec{\xi}) \left|\mathcal{J}_e\right| \;\text{d}\vec{\xi} \approx       \sum_e \sum_{q} w_{q} f( \vec{x}_{q}) \left|\mathcal{J}_e(\vec{x}_{q})\right|" bookmark="moose-equation-37efee41-a3c5-4373-a10b-d3bc6e7c2fa7" recursive="True" class="moose-katex-inline-equation" id="moose-equation-37efee41-a3c5-4373-a10b-d3bc6e7c2fa7"><script>var element = document.getElementById("moose-equation-37efee41-a3c5-4373-a10b-d3bc6e7c2fa7");katex.render("\\sum_e \\int_{\\hat{\\Omega}_e} f(\\vec{\\xi}) \\left|\\mathcal{J}_e\\right| \\;\\text{d}\\vec{\\xi} \\approx       \\sum_e \\sum_{q} w_{q} f( \\vec{x}_{q}) \\left|\\mathcal{J}_e(\\vec{x}_{q})\\right|", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p><span tex="\vec{x}_{q}" bookmark="moose-equation-6aecb6d7-0f28-4b09-a251-020494b16172" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6aecb6d7-0f28-4b09-a251-020494b16172"><script>var element = document.getElementById("moose-equation-6aecb6d7-0f28-4b09-a251-020494b16172");katex.render("\\vec{x}_{q}", element, {displayMode:false,throwOnError:false});</script></span> is the spatial location of the <span tex="q" bookmark="moose-equation-f296ef6a-0eaa-4270-a235-d303e5369ad7" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f296ef6a-0eaa-4270-a235-d303e5369ad7"><script>var element = document.getElementById("moose-equation-f296ef6a-0eaa-4270-a235-d303e5369ad7");katex.render("q", element, {displayMode:false,throwOnError:false});</script></span>th quadrature point and <span tex="w_{q}" bookmark="moose-equation-7a42d455-2968-48be-87a4-508697883352" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7a42d455-2968-48be-87a4-508697883352"><script>var element = document.getElementById("moose-equation-7a42d455-2968-48be-87a4-508697883352");katex.render("w_{q}", element, {displayMode:false,throwOnError:false});</script></span> is its associated weight. </p></li><li><p>MOOSE handles multiplication by the Jacobian and the weight automatically, thus your <code>Kernel</code> is only responsible for computing the <span tex="f(\vec{x}_{q})" bookmark="moose-equation-4bbafb49-e768-45c2-8603-8d9531442cb2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4bbafb49-e768-45c2-8603-8d9531442cb2"><script>var element = document.getElementById("moose-equation-4bbafb49-e768-45c2-8603-8d9531442cb2");katex.render("f(\\vec{x}_{q})", element, {displayMode:false,throwOnError:false});</script></span> part of the integrand. </p></li><li><p>Under certain common situations, the quadrature approximation is exact!   - For example, in 1 dimension, Gaussian Quadrature can exactly integrate polynomials of order <span tex="2n-1" bookmark="moose-equation-b8f9ea65-5c80-4b0f-ab3c-ebf775829133" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b8f9ea65-5c80-4b0f-ab3c-ebf775829133"><script>var element = document.getElementById("moose-equation-b8f9ea65-5c80-4b0f-ab3c-ebf775829133");katex.render("2n-1", element, {displayMode:false,throwOnError:false});</script></span> with <span tex="n" bookmark="moose-equation-db382293-8658-4fbf-a2c7-a8034f64cf8d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-db382293-8658-4fbf-a2c7-a8034f64cf8d"><script>var element = document.getElementById("moose-equation-db382293-8658-4fbf-a2c7-a8034f64cf8d");katex.render("n", element, {displayMode:false,throwOnError:false});</script></span> quadrature points. </p></li><li><p>Note that sampling <span tex="u_h" bookmark="moose-equation-8bda0481-d1a2-4d71-9f1e-68f9000ab39a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8bda0481-d1a2-4d71-9f1e-68f9000ab39a"><script>var element = document.getElementById("moose-equation-8bda0481-d1a2-4d71-9f1e-68f9000ab39a");katex.render("u_h", element, {displayMode:false,throwOnError:false});</script></span> at the quadrature points yields:  <span tex="\begin{aligned}   u(\vec{x}_{q}) &\approx u_h(\vec{x}_{q}) = \sum u_j \phi_j(\vec{x}_{q}) \\   \nabla u (\vec{x}_{q}) &\approx \nabla u_h(\vec{x}_{q}) = \sum u_j \nabla \phi_j(\vec{x}_{q})\end{aligned}" bookmark="moose-equation-f9cef3d5-a946-4070-9fbb-8f018b0b45bc" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f9cef3d5-a946-4070-9fbb-8f018b0b45bc"><script>var element = document.getElementById("moose-equation-f9cef3d5-a946-4070-9fbb-8f018b0b45bc");katex.render("\\begin{aligned}   u(\\vec{x}_{q}) &\\approx u_h(\\vec{x}_{q}) = \\sum u_j \\phi_j(\\vec{x}_{q}) \\\\   \\nabla u (\\vec{x}_{q}) &\\approx \\nabla u_h(\\vec{x}_{q}) = \\sum u_j \\nabla \\phi_j(\\vec{x}_{q})\\end{aligned}", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p>And our weak form becomes: <span tex="\begin{aligned} R_i(u_h) &= \sum_e \sum_{q} w_{q} \left|\mathcal{J}_e\right|\left[ \nabla\psi_i\cdot k \nabla u_h + \psi_i \left(\vec\beta\cdot \nabla u_h \right) - \psi_i f \right](\vec{x}_{q}) \\ &- \sum_f \sum_{q_{face}} w_{q_{face}} \left|\mathcal{J}_f\right| \left[\psi_i k \nabla u_h \cdot \vec{n} \right](\vec x_{q_{face}}) \end{aligned}" bookmark="moose-equation-a3b49054-86fe-4c25-912f-d2ea81b27d69" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a3b49054-86fe-4c25-912f-d2ea81b27d69"><script>var element = document.getElementById("moose-equation-a3b49054-86fe-4c25-912f-d2ea81b27d69");katex.render("\\begin{aligned} R_i(u_h) &= \\sum_e \\sum_{q} w_{q} \\left|\\mathcal{J}_e\\right|\\left[ \\nabla\\psi_i\\cdot k \\nabla u_h + \\psi_i \\left(\\vec\\beta\\cdot \\nabla u_h \\right) - \\psi_i f \\right](\\vec{x}_{q}) \\\\ &- \\sum_f \\sum_{q_{face}} w_{q_{face}} \\left|\\mathcal{J}_f\\right| \\left[\\psi_i k \\nabla u_h \\cdot \\vec{n} \\right](\\vec x_{q_{face}}) \\end{aligned}", element, {displayMode:false,throwOnError:false});</script></span> </p></li><li><p>The second sum is over boundary faces, <span tex="f" bookmark="moose-equation-f7c7e4eb-bcc6-4ae5-97da-a836ffe8ba26" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f7c7e4eb-bcc6-4ae5-97da-a836ffe8ba26"><script>var element = document.getElementById("moose-equation-f7c7e4eb-bcc6-4ae5-97da-a836ffe8ba26");katex.render("f", element, {displayMode:false,throwOnError:false});</script></span>. </p></li><li><p>MOOSE <code>Kernels</code> must provide each of the terms in square brackets (evaluated at <span tex="\vec{x}_{q}" bookmark="moose-equation-99b9a844-1ab0-49d3-95fb-00437e4372c2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-99b9a844-1ab0-49d3-95fb-00437e4372c2"><script>var element = document.getElementById("moose-equation-99b9a844-1ab0-49d3-95fb-00437e4372c2");katex.render("\\vec{x}_{q}", element, {displayMode:false,throwOnError:false});</script></span> or <span tex="\vec x_{q_{face}}" bookmark="moose-equation-b741d68d-20d4-48c4-ad0b-f35ed0321f82" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b741d68d-20d4-48c4-ad0b-f35ed0321f82"><script>var element = document.getElementById("moose-equation-b741d68d-20d4-48c4-ad0b-f35ed0321f82");katex.render("\\vec x_{q_{face}}", element, {displayMode:false,throwOnError:false});</script></span> as necessary).</p></li></ul><p>A normal (default) Problem object that contains a single NonlinearSystem and a single AuxiliarySystem object.</p></section></section><section class="scrollspy" id="19301df5-400c-4676-982d-ac225e13ccc7" data-section-level="2" data-section-text="Input Parameters"><h2 id="input-parameters">Input Parameters</h2><section id="173c60eb-9ddc-4a09-a4c9-74f4c8587db4" data-section-level="3" data-section-text="Optional Parameters" data-details-open="open"><details class="moose-section-content" open="open"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">block</span><span class="moose-parameter-header-description">Block IDs for the coordinate systems</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<SubdomainName></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Block IDs for the coordinate systems</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">coord_type</span><span class="moose-parameter-header-default">XYZ</span><span class="moose-parameter-header-description">Type of the coordinate system per block param</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>XYZ</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MultiMooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>XYZ RZ RSPHERICAL</p><p class="moose-parameter-description"><span>Description:</span>Type of the coordinate system per block param</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">error_on_jacobian_nonzero_reallocation</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">This causes PETSc to error if it had to reallocate memory in the Jacobian matrix due to not having enough nonzeros</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>This causes PETSc to error if it had to reallocate memory in the Jacobian matrix due to not having enough nonzeros</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">extra_tag_matrices</span><span class="moose-parameter-header-description">Extra matrices to add to the system that can be filled by objects which compute residuals and Jacobians (Kernels, BCs, etc.) by setting tags on them.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<TagName></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Extra matrices to add to the system that can be filled by objects which compute residuals and Jacobians (Kernels, BCs, etc.) by setting tags on them.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">extra_tag_vectors</span><span class="moose-parameter-header-description">Extra vectors to add to the system that can be filled by objects which compute residuals and Jacobians (Kernels, BCs, etc.) by setting tags on them.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<TagName></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Extra vectors to add to the system that can be filled by objects which compute residuals and Jacobians (Kernels, BCs, etc.) by setting tags on them.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">force_restart</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">EXPERIMENTAL: If true, a sub_app may use a restart file instead of using of using the master backup file</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>EXPERIMENTAL: If true, a sub_app may use a restart file instead of using of using the master backup file</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">ignore_zeros_in_jacobian</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Do not explicitly store zero values in the Jacobian matrix if true</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Do not explicitly store zero values in the Jacobian matrix if true</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">kernel_coverage_check</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set to false to disable kernel->subdomain coverage check</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Set to false to disable kernel->subdomain coverage check</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">material_coverage_check</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set to false to disable material->subdomain coverage check</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Set to false to disable material->subdomain coverage check</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">near_null_space_dimension</span><span class="moose-parameter-header-default">0</span><span class="moose-parameter-header-description">The dimension of the near nullspace</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>unsigned int</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The dimension of the near nullspace</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">null_space_dimension</span><span class="moose-parameter-header-default">0</span><span class="moose-parameter-header-description">The dimension of the nullspace</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>unsigned int</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The dimension of the nullspace</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">parallel_barrier_messaging</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Displays messaging from parallel barrier notifications when executing or transferring to/from Multiapps (default: false)</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Displays messaging from parallel barrier notifications when executing or transferring to/from Multiapps (default: false)</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">restart_file_base</span><span class="moose-parameter-header-description">File base name used for restart (e.g. <path>/<filebase> or <path>/LATEST to grab the latest file available)</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>FileNameNoExtension</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>File base name used for restart (e.g. <path>/<filebase> or <path>/LATEST to grab the latest file available)</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">rz_coord_axis</span><span class="moose-parameter-header-default">Y</span><span class="moose-parameter-header-description">The rotation axis (X | Y) for axisymetric coordinates</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>Y</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>MooseEnum</p><p class="moose-parameter-description-options"><span>Options:</span>X Y</p><p class="moose-parameter-description"><span>Description:</span>The rotation axis (X | Y) for axisymetric coordinates</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">skip_additional_restart_data</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">True to skip additional data in equation system for restart. It is useful for starting a transient calculation with a steady-state solution</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>True to skip additional data in equation system for restart. It is useful for starting a transient calculation with a steady-state solution</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">skip_nl_system_check</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">True to skip the NonlinearSystem check for work to do (e.g. Make sure that there are variables to solve for).</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>True to skip the NonlinearSystem check for work to do (e.g. Make sure that there are variables to solve for).</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">solve</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Whether or not to actually solve the Nonlinear system.  This is handy in the case that all you want to do is execute AuxKernels, Transfers, etc. without actually solving anything</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Whether or not to actually solve the Nonlinear system.  This is handy in the case that all you want to do is execute AuxKernels, Transfers, etc. without actually solving anything</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">transpose_null_space_dimension</span><span class="moose-parameter-header-default">0</span><span class="moose-parameter-header-description">The dimension of the transpose nullspace</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>0</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>unsigned int</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>The dimension of the transpose nullspace</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">use_nonlinear</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Determines whether to use a Nonlinear vs a Eigenvalue system (Automatically determined based on executioner)</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Determines whether to use a Nonlinear vs a Eigenvalue system (Automatically determined based on executioner)</p></div></li></ul><summary><h3 data-details-open="open"><span class="moose-section-icon"></span>Optional Parameters</h3></summary></details></section><section id="90dbeb35-f110-4473-9c1f-9e7375ca2028" data-section-level="3" data-section-text="Advanced Parameters" data-details-open="close"><details class="moose-section-content"><ul class="collapsible" data-collapsible="expandable"><li><div class="collapsible-header"><span class="moose-parameter-name">control_tags</span><span class="moose-parameter-header-description">Adds user-defined labels for accessing object parameters via control logic.</span></div><div class="collapsible-body"><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>std::vector<std::string></p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Adds user-defined labels for accessing object parameters via control logic.</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">default_ghosting</span><span class="moose-parameter-header-default">False</span><span class="moose-parameter-header-description">Whether or not to use libMesh's default amount of algebraic and geometric ghosting</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>False</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Whether or not to use libMesh's default amount of algebraic and geometric ghosting</p></div></li><li><div class="collapsible-header"><span class="moose-parameter-name">enable</span><span class="moose-parameter-header-default">True</span><span class="moose-parameter-header-description">Set the enabled status of the MooseObject.</span></div><div class="collapsible-body"><p class="moose-parameter-description-default"><span>Default:</span>True</p><p class="moose-parameter-description-cpptype"><span>C++ Type:</span>bool</p><p class="moose-parameter-description-options"><span>Options:</span></p><p class="moose-parameter-description"><span>Description:</span>Set the enabled status of the MooseObject.</p></div></li></ul><summary><h3 data-details-open="close"><span class="moose-section-icon"></span>Advanced Parameters</h3></summary></details></section></section><section class="scrollspy" id="124654fb-e926-495c-8259-e2a425ef481d" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol></ol></div></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#5944d3f9-d6b7-4cad-82f6-72e567e04faf" class="tooltipped" data-position="left" data-tooltip="Convenience Zeros">Convenience Zeros</a></li><li><a href="#b8cd3e49-23e2-4d59-a9c8-b6835ec6cf58" class="tooltipped" data-position="left" data-tooltip="Selective Reinit">Selective Reinit</a></li><li><a href="#4459351e-cc2f-415d-b668-0dd5ba640154" class="tooltipped" data-position="left" data-tooltip="Finite Element Concepts">Finite Element Concepts</a></li><li><a href="#19301df5-400c-4676-982d-ac225e13ccc7" class="tooltipped" data-position="left" data-tooltip="Input Parameters">Input Parameters</a></li><li><a href="#124654fb-e926-495c-8259-e2a425ef481d" class="tooltipped" data-position="left" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script>