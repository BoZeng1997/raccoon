<!DOCTYPE html><head><meta charset="UTF-8"><title>WBM.md|RACCOON</title><link rel="icon" type="image/x-icon" href="../../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../../contrib/plotly/plotly.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon/index.html" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../../media/framework/github-logo.png" class="github-mark"></img><img src="../../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../index.html">Modules</a></li><li><a href="../../../syntax/index.html">Syntax</a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#" class="sidenav-trigger" data-target="e1a1ccff-9459-4d87-9a29-0db01f82a0f2"><i class="material-icons">menu</i></a><ul class="sidenav" id="e1a1ccff-9459-4d87-9a29-0db01f82a0f2"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../index.html">Modules</a></li><li><a href="../../../syntax/index.html">Syntax</a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon/index.html" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href="../.." class="breadcrumb">modules</a><a href=".." class="breadcrumb">phase_field</a><span class="breadcrumb">MultiPhase</span><a href="#" class="breadcrumb">WBM</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="9fab26c1-a731-46d9-b6c5-fdd5bc3d5d51" data-section-level="1" data-section-text="Multiphase models"><h1 id="multiphase-models">Multiphase models</h1><p>Material objects that internally derive from <code>DerivativeFunctionMaterialBase</code> (<a href="http://mooseframework.org/docs/doxygen/modules/classDerivativeFunctionMaterialBase.html">Doxygen</a>), like the materials for the <a href="../FunctionMaterialKernels.html">Parsed Function Kernels</a> are used to provide the free energy expressions for each phase.</p><p>The flexible <strong>multiphase model</strong> uses _n_ order parameters to control <em>n</em> phases while employing a Lagrange multiplier based constraint to enforce the sum of all phase contributions to be one at every point in the simulation cell.</p><p>For multiphase models with <em>n</em> phases <a href="../../../source/materials/DerivativeMultiPhaseMaterial.html"><code>DerivativeMultiPhaseMaterial</code></a> can be used to form the global free energy as</p><p><span class="moose-katex-block-equation"><span tex="F = \left[ \sum_i^n h_i(\eta_i)F_i \right] + g(\vec\eta)" bookmark="moose-equation-8eab2db7-3c77-4542-9937-ea355261d369" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-8eab2db7-3c77-4542-9937-ea355261d369"></span><script>var element = document.getElementById("moose-equation-8eab2db7-3c77-4542-9937-ea355261d369");katex.render("F = \\left[ \\sum_i^n h_i(\\eta_i)F_i \\right] + g(\\vec\\eta)", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>We need to enforce the constraint <span tex="k(\vec\eta)=0" bookmark="moose-equation-702741cb-1022-4a25-8fc8-86dcacbb0fa7" recursive="True" class="moose-katex-inline-equation" id="moose-equation-702741cb-1022-4a25-8fc8-86dcacbb0fa7"><script>var element = document.getElementById("moose-equation-702741cb-1022-4a25-8fc8-86dcacbb0fa7");katex.render("k(\\vec\\eta)=0", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> for</p><p><span class="moose-katex-block-equation"><span tex="k(\vec \eta)=\left[\sum_i h(\eta_i)\right] - 1 \underbrace{- \frac\epsilon2\lambda}_{\text{Jacobian fill}}," bookmark="moose-equation-805d66ee-ce4e-42f2-b26b-3ac81d1da63b" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-805d66ee-ce4e-42f2-b26b-3ac81d1da63b"></span><script>var element = document.getElementById("moose-equation-805d66ee-ce4e-42f2-b26b-3ac81d1da63b");katex.render("k(\\vec \\eta)=\\left[\\sum_i h(\\eta_i)\\right] - 1 \\underbrace{- \\frac\\epsilon2\\lambda}_{\\text{Jacobian fill}},", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>which ensures that the total weight of all phase free energy contributions at each point in the simulation volume is exactly unity (up to an <span tex="\epsilon" bookmark="moose-equation-2bc98f02-5df4-4d08-ae77-4d402d3a04ff" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2bc98f02-5df4-4d08-ae77-4d402d3a04ff"><script>var element = document.getElementById("moose-equation-2bc98f02-5df4-4d08-ae77-4d402d3a04ff");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>). This is achieved using either a hard or soft constraint enforcement method.</p><p>Check out the example input at <code>moose/modules/phase_field/examples/multiphase/DerivativeMultiPhaseMaterial.i</code> to see it in action.</p><section class="scrollspy" id="e0580b74-143f-4cd5-b8b8-64dda45bbef1" data-section-level="2" data-section-text="Lagrange multiplier constraint"><h2 id="lagrange-multiplier-constraint">Lagrange multiplier constraint</h2><p>As first (hard) method for constraint enforcement the Lagrange multiplier technique is available, where the Lagrange multiplier <span tex="\lambda" bookmark="moose-equation-1e40d321-d261-4678-b142-ea95d1d084a5" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1e40d321-d261-4678-b142-ea95d1d084a5"><script>var element = document.getElementById("moose-equation-1e40d321-d261-4678-b142-ea95d1d084a5");katex.render("\\lambda", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is a non-linear variable</p><p>With <span tex="a_i(\vec\eta,\vec c,v)" bookmark="moose-equation-d77da7af-d937-4715-bff2-188f8ff59501" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d77da7af-d937-4715-bff2-188f8ff59501"><script>var element = document.getElementById("moose-equation-d77da7af-d937-4715-bff2-188f8ff59501");katex.render("a_i(\\vec\\eta,\\vec c,v)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> being the weak form (Allen-Cahn) residual for the <span tex="i" bookmark="moose-equation-07a7b698-604a-4ed7-adf2-4b73133edf28" recursive="True" class="moose-katex-inline-equation" id="moose-equation-07a7b698-604a-4ed7-adf2-4b73133edf28"><script>var element = document.getElementById("moose-equation-07a7b698-604a-4ed7-adf2-4b73133edf28");katex.render("i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>th non-conserved order parameter, we need to find <span tex="(\vec\eta,\lambda)" bookmark="moose-equation-06d29a4a-43da-4616-8dd0-7044bbca1ff9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-06d29a4a-43da-4616-8dd0-7044bbca1ff9"><script>var element = document.getElementById("moose-equation-06d29a4a-43da-4616-8dd0-7044bbca1ff9");katex.render("(\\vec\\eta,\\lambda)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> satisfying the boundary conditions and such that</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} a_i(\vec\eta,\vec c,v) + \underbrace{\int_\Omega\lambda\frac{\partial k}{\partial\eta_i} v\,dx}_{L_1(\eta_i)} &=& 0 \\ \underbrace{\int_\Omega q\frac{\partial(\lambda k)}{\partial\lambda}\,dx}_{L_2(\lambda)} &=& 0 \end{aligned}" bookmark="moose-equation-81a578ab-aa28-43ac-bb7a-e93800a001c6" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-81a578ab-aa28-43ac-bb7a-e93800a001c6"></span><script>var element = document.getElementById("moose-equation-81a578ab-aa28-43ac-bb7a-e93800a001c6");katex.render("\\begin{aligned} a_i(\\vec\\eta,\\vec c,v) + \\underbrace{\\int_\\Omega\\lambda\\frac{\\partial k}{\\partial\\eta_i} v\\,dx}_{L_1(\\eta_i)} &=& 0 \\\\ \\underbrace{\\int_\\Omega q\\frac{\\partial(\\lambda k)}{\\partial\\lambda}\\,dx}_{L_2(\\lambda)} &=& 0 \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>holds for every test function <span tex="v" bookmark="moose-equation-e3762dfe-f315-40f7-876b-40cac2830d32" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e3762dfe-f315-40f7-876b-40cac2830d32"><script>var element = document.getElementById("moose-equation-e3762dfe-f315-40f7-876b-40cac2830d32");katex.render("v", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="q" bookmark="moose-equation-5b3e4615-c203-42d2-bea6-ea55ec31c7ce" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5b3e4615-c203-42d2-bea6-ea55ec31c7ce"><script>var element = document.getElementById("moose-equation-5b3e4615-c203-42d2-bea6-ea55ec31c7ce");katex.render("q", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p><p>The <span tex="L_1" bookmark="moose-equation-6815ece2-1596-4a4d-84a2-b4a934a9744d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6815ece2-1596-4a4d-84a2-b4a934a9744d"><script>var element = document.getElementById("moose-equation-6815ece2-1596-4a4d-84a2-b4a934a9744d");katex.render("L_1", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> Lagrange residuals are provided by  <a href="../../../source/kernels/SwitchingFunctionConstraintEta.html"><code>SwitchingFunctionConstraintEta</code></a>  (<a href="http://mooseframework.org/docs/doxygen/modules/classSwitchingFunctionConstraintEta.html">Doxygen</a>)  kernels - one for each phase order parameter.</p><p>The <span tex="L_2" bookmark="moose-equation-69642f43-5441-481f-850c-b4f9f6058515" recursive="True" class="moose-katex-inline-equation" id="moose-equation-69642f43-5441-481f-850c-b4f9f6058515"><script>var element = document.getElementById("moose-equation-69642f43-5441-481f-850c-b4f9f6058515");katex.render("L_2", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> Lagrange residual is provided by a  <a href="../../../source/kernels/SwitchingFunctionConstraintLagrange.html"><code>SwitchingFunctionConstraintLagrange</code></a> (<a href="http://mooseframework.org/docs/doxygen/modules/classSwitchingFunctionConstraintLagrange.html">Doxygen</a>) kernel.</p><p>The <em>Jacobian fill</em> term introduces a small <span tex="\lambda" bookmark="moose-equation-e2f7dbfa-f3d2-4ae7-86a2-9daf134f8a2e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e2f7dbfa-f3d2-4ae7-86a2-9daf134f8a2e"><script>var element = document.getElementById("moose-equation-e2f7dbfa-f3d2-4ae7-86a2-9daf134f8a2e");katex.render("\\lambda", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> dependence in the constraint through a small <span tex="\epsilon" bookmark="moose-equation-bd70d62a-995d-4323-8d6c-e32770074219" recursive="True" class="moose-katex-inline-equation" id="moose-equation-bd70d62a-995d-4323-8d6c-e32770074219"><script>var element = document.getElementById("moose-equation-bd70d62a-995d-4323-8d6c-e32770074219");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> factor (defaults to <span tex="10^{-9}" bookmark="moose-equation-5211c2a1-702c-429a-a7ae-960773611f12" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5211c2a1-702c-429a-a7ae-960773611f12"><script>var element = document.getElementById("moose-equation-5211c2a1-702c-429a-a7ae-960773611f12");katex.render("10^{-9}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>), which results in an on-diagonal Jacobian value of <span tex="\epsilon" bookmark="moose-equation-1f880818-d4b2-49b8-bd90-745f31779985" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1f880818-d4b2-49b8-bd90-745f31779985"><script>var element = document.getElementById("moose-equation-1f880818-d4b2-49b8-bd90-745f31779985");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> in the <span tex="L_2" bookmark="moose-equation-b8ff893f-8b7c-4c42-b7a0-0e4c6cb6bb26" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b8ff893f-8b7c-4c42-b7a0-0e4c6cb6bb26"><script>var element = document.getElementById("moose-equation-b8ff893f-8b7c-4c42-b7a0-0e4c6cb6bb26");katex.render("L_2", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> kernel (it drops out in the <span tex="L_1" bookmark="moose-equation-d45bffa8-885c-4808-9bbf-894d0db712e0" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d45bffa8-885c-4808-9bbf-894d0db712e0"><script>var element = document.getElementById("moose-equation-d45bffa8-885c-4808-9bbf-894d0db712e0");katex.render("L_1", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> kernel). This is necessary to force a Jacobian matrix with <em>full rank</em>, avoids &quot;Zero pivot&quot; PETSc-Errors, and greatly improves convergence. The cost is a <em>violation</em> of the constraint by about <span tex="\epsilon" bookmark="moose-equation-87094457-c0d5-4664-b8e9-343381b7937e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-87094457-c0d5-4664-b8e9-343381b7937e"><script>var element = document.getElementById("moose-equation-87094457-c0d5-4664-b8e9-343381b7937e");katex.render("\\epsilon", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, however this constraint violation can be made as small as the convergence limits.</p></section><section class="scrollspy" id="06edf315-501c-4046-abbb-408069e871f2" data-section-level="2" data-section-text="Penalty constraint"><h2 id="penalty-constraint">Penalty constraint</h2><p>As an alternative (softer) constraint enforcement we provide the <a href="../../../source/kernels/SwitchingFunctionPenalty.html"><code>SwitchingFunctionPenalty</code></a> (<a href="http://mooseframework.org/docs/doxygen/modules/classSwitchingFunctionPenalty.html">Doxygen</a>) kernel, which effectively adds a free energy penalty of <span tex="\gamma k(\vec \eta)^2" bookmark="moose-equation-f51292d4-c551-49af-99fd-6ab174b05ecf" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f51292d4-c551-49af-99fd-6ab174b05ecf"><script>var element = document.getElementById("moose-equation-f51292d4-c551-49af-99fd-6ab174b05ecf");katex.render("\\gamma k(\\vec \\eta)^2", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (with <span tex="\epsilon=0" bookmark="moose-equation-6a7d9b88-2f32-4b8c-a2b9-0797e303ba31" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6a7d9b88-2f32-4b8c-a2b9-0797e303ba31"><script>var element = document.getElementById("moose-equation-6a7d9b88-2f32-4b8c-a2b9-0797e303ba31");katex.render("\\epsilon=0", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>), where <span tex="\gamma" bookmark="moose-equation-11e8b0c6-7259-4cf0-9a4e-020f3a7a6bee" recursive="True" class="moose-katex-inline-equation" id="moose-equation-11e8b0c6-7259-4cf0-9a4e-020f3a7a6bee"><script>var element = document.getElementById("moose-equation-11e8b0c6-7259-4cf0-9a4e-020f3a7a6bee");katex.render("\\gamma", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is the penalty prefactor (<code>penalty</code>). The constraint is enforced approximately to a tolerance of <span tex="\frac1\gamma" bookmark="moose-equation-b1566eae-2dc7-4fc9-b7bd-4deaa416c4b4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b1566eae-2dc7-4fc9-b7bd-4deaa416c4b4"><script>var element = document.getElementById("moose-equation-b1566eae-2dc7-4fc9-b7bd-4deaa416c4b4");katex.render("\\frac1\\gamma", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (depending on the shape and units of the free energy).</p><p>The gradient interface energy term for multiphase models with <span tex="n>2" bookmark="moose-equation-8eba4799-4226-493c-b167-c01516688f83" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8eba4799-4226-493c-b167-c01516688f83"><script>var element = document.getElementById("moose-equation-8eba4799-4226-493c-b167-c01516688f83");katex.render("n>2", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is derived <a href="../../../source/kernels/ACMultiInterface.html">here</a> and provided by the <a href="../../../source/kernels/ACMultiInterface.html"><code>ACMultiInterface</code></a> kernel.</p></section><section class="scrollspy" id="6d9009e6-31df-4db6-b086-2f3797a97a18" data-section-level="2" data-section-text="Example"><h2 id="example">Example</h2><p>An example material block looks like this (materials for phase field mobilities omitted for clarity).</p><pre class="moose-pre"><code class="language-puppet">
[Materials]
# Free energy for phase A

[./free_energy_A]
  type = DerivativeParsedMaterial
  block = 0
  f_name = Fa
  args = &#x27;c&#x27;
  function = &#x27;(c-0.1)^2&#x27;
  third_derivatives = false
  enable_jit = true
[../]

# Free energy for phase B

[./free_energy_B]
  type = DerivativeParsedMaterial
  f_name = Fb
  args = &#x27;c&#x27;
  function = &#x27;(c-0.9)^2&#x27;
  third_derivatives = false
  enable_jit = true
[../]

[./switching]
  type = SwitchingFunctionMaterial
  eta = eta
  h_order = SIMPLE
[../]

[./barrier]
  type = BarrierFunctionMaterial
  eta = eta
  g_order = SIMPLE
[../]

# Total free energy F = h(phi)*Fb + (1-h(phi))*Fa

[./free_energy]
  type = DerivativeTwoPhaseMaterial
  f_name = F    # Name of the global free energy function (use this in the Parsed Function Kernels)
  fa_name = Fa  # f_name of the phase A free energy function
  fb_name = Fb  # f_name of the phase B free energy function
  args = &#x27;c&#x27;
  eta = eta     # order parameter that switches between A and B phase
  third_derivatives = false
  outputs = exodus
[../]
[]
</code></pre><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><span class="moose-alert-title-brand">note</span></div><div class="card-content"><div class="moose-alert-content"><p><p>The phase free energies are single wells. The global free energy landscape will however have a double well character in this example.</p></p></div></div></div></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#e0580b74-143f-4cd5-b8b8-64dda45bbef1" class="tooltipped" data-position="left" data-tooltip="Lagrange multiplier constraint">Lagrange multiplier constraint</a></li><li><a href="#06edf315-501c-4046-abbb-408069e871f2" class="tooltipped" data-position="left" data-tooltip="Penalty constraint">Penalty constraint</a></li><li><a href="#6d9009e6-31df-4db6-b086-2f3797a97a18" class="tooltipped" data-position="left" data-tooltip="Example">Example</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../../js/init.js"></script><script type="text/javascript" src="../../../js/navigation.js"></script><script type="text/javascript" src="../../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../../js/search_index.js"></script><script type="text/javascript" src="../../../js/sqa_moose.js"></script>