<!DOCTYPE html><head><meta charset="UTF-8"><title>KKSDerivations.md|RACCOON</title><link rel="icon" type="image/x-icon" href="../../../media/raccoon_icon.png" sizes="16x16 32x32 64x64 128x128"></link><link href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../../contrib/katex/katex.min.js"></script><script type="text/javascript" src="../../../contrib/plotly/plotly.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="https://hugary1995.github.io/raccoon/index.html" class="left moose-logo hide-on-med-and-down">RACCOON</a><a href="https://github.com/hugary1995/raccoon" class="right"><img src="../../../media/framework/github-logo.png" class="github-mark"></img><img src="../../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../index.html">Modules</a></li><li><a href="../../../syntax/index.html">Syntax</a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#" class="sidenav-trigger" data-target="8d72bdb0-cbfc-4d26-8289-98853a4f762f"><i class="material-icons">menu</i></a><ul class="sidenav" id="8d72bdb0-cbfc-4d26-8289-98853a4f762f"><li><a href="../../../install/index.html">Install</a></li><li><a href="../../../theory/index.html">Theory</a></li><li><a href="../../index.html">Modules</a></li><li><a href="../../../syntax/index.html">Syntax</a></li><li><a href="../../../contribute/index.html">Contribute</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="https://hugary1995.github.io/raccoon/index.html" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href="../.." class="breadcrumb">modules</a><a href=".." class="breadcrumb">phase_field</a><span class="breadcrumb">MultiPhase</span><a href="#" class="breadcrumb">KKSDerivations</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="b983a74d-0eaf-4727-adb3-ddcb4868a20d" data-section-level="1" data-section-text="KKS Model Definitions"><h1 id="kks-model-definitions">KKS Model Definitions</h1><p><span class="moose-katex-block-equation"><span tex="F = [1-h(\eta)]F_a + h(\eta)F_b+wg(\eta)" bookmark="moose-equation-ce9136c7-386d-45c5-87c0-92d7b21dba3e" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-ce9136c7-386d-45c5-87c0-92d7b21dba3e"></span><script>var element = document.getElementById("moose-equation-ce9136c7-386d-45c5-87c0-92d7b21dba3e");katex.render("F = [1-h(\\eta)]F_a + h(\\eta)F_b+wg(\\eta)", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="c =  [1-h(\eta)]c_a + h(\eta)c_b" bookmark="moose-equation-f9c02203-ca76-42b8-b9bb-64731229ce39" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-f9c02203-ca76-42b8-b9bb-64731229ce39"></span><script>var element = document.getElementById("moose-equation-f9c02203-ca76-42b8-b9bb-64731229ce39");katex.render("c =  [1-h(\\eta)]c_a + h(\\eta)c_b", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="\frac{dF_a}{dc_a} = \frac{dF_b}{dc_b}" bookmark="moose-equation-93d36890-2c25-42e4-a25d-9b3250570b32" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-93d36890-2c25-42e4-a25d-9b3250570b32"></span><script>var element = document.getElementById("moose-equation-93d36890-2c25-42e4-a25d-9b3250570b32");katex.render("\\frac{dF_a}{dc_a} = \\frac{dF_b}{dc_b}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="67a45636-016a-42ab-9e02-dc144f08dde0" data-section-level="1" data-section-text="Materials"><h1 id="materials">Materials</h1><p>The KKS system (<a href="#kim_phase-field_1999">Kim et al. (1999)</a>) uses multiple MOOSE materials to provide values for free energy  functions, the switching function <span tex="h(\eta)" bookmark="moose-equation-f1f2a0ff-1560-44ec-aae6-4372725aeb7e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f1f2a0ff-1560-44ec-aae6-4372725aeb7e"><script>var element = document.getElementById("moose-equation-f1f2a0ff-1560-44ec-aae6-4372725aeb7e");katex.render("h(\\eta)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, and the double well function <span tex="g(\eta)" bookmark="moose-equation-ce074463-1877-4800-a24f-729c3f94e92d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ce074463-1877-4800-a24f-729c3f94e92d"><script>var element = document.getElementById("moose-equation-ce074463-1877-4800-a24f-729c3f94e92d");katex.render("g(\\eta)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. Providing these as materials allows the functions to be bundled in a single place, while being used by multiple kernels. Furthermore the automatic differentiation feature used in the parsed function materials prreplovides the necessary derivatives at no cost to the developer. The derivatives are stored in material properties and follow a naming scheme that is defined in <code>KKSBaseMaterial.C</code>.</p></section><section id="759acf59-ae13-46df-bfaa-4351c4beaac6" data-section-level="1" data-section-text="Cahn - Hilliard Kernels"><h1 id="cahn-hilliard-kernels">Cahn-Hilliard Kernels</h1><section class="scrollspy" id="45d735b7-d8cb-402e-87f6-2816fe58e8bd" data-section-level="2" data-section-text="KKSSplitCHCRes"><h2 id="kkssplitchcres">KKSSplitCHCRes</h2><p><a href="../../../source/kernels/KKSSplitCHCRes.html"><code>KKSSplitCHCRes</code></a> is the split version. In this kernel, we calculate the chemical potential <span tex="\mu" bookmark="moose-equation-314bd00f-cc7e-4ea9-975e-7fc731a60912" recursive="True" class="moose-katex-inline-equation" id="moose-equation-314bd00f-cc7e-4ea9-975e-7fc731a60912"><script>var element = document.getElementById("moose-equation-314bd00f-cc7e-4ea9-975e-7fc731a60912");katex.render("\\mu", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> from <span tex="\frac{\partial F}{\partial c}" bookmark="moose-equation-5a9ee903-e951-4ddd-8311-48be14b1597c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5a9ee903-e951-4ddd-8311-48be14b1597c"><script>var element = document.getElementById("moose-equation-5a9ee903-e951-4ddd-8311-48be14b1597c");katex.render("\\frac{\\partial F}{\\partial c}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. The non-linear variable for this Kernel is the concentration <span tex="c" bookmark="moose-equation-63490b9f-7961-4b6c-92e8-aed67ab5c505" recursive="True" class="moose-katex-inline-equation" id="moose-equation-63490b9f-7961-4b6c-92e8-aed67ab5c505"><script>var element = document.getElementById("moose-equation-63490b9f-7961-4b6c-92e8-aed67ab5c505");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. To calculate <span tex="\frac{\partial c}{\partial t}" bookmark="moose-equation-a07e7b28-f2a2-4325-af8c-fc7cab77a93b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a07e7b28-f2a2-4325-af8c-fc7cab77a93b"><script>var element = document.getElementById("moose-equation-a07e7b28-f2a2-4325-af8c-fc7cab77a93b");katex.render("\\frac{\\partial c}{\\partial t}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="\nabla \cdot M(c) \nabla \mu" bookmark="moose-equation-cd42ea00-dc05-4be0-b2eb-19c516a8d9d2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cd42ea00-dc05-4be0-b2eb-19c516a8d9d2"><script>var element = document.getElementById("moose-equation-cd42ea00-dc05-4be0-b2eb-19c516a8d9d2");katex.render("\\nabla \\cdot M(c) \\nabla \\mu", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, we use the <a href="../../../source/kernels/CoupledTimeDerivative.html"><code>CoupledTimeDerivative</code></a> and <a href="../../../source/kernels/SplitCHWRes.html"><code>SplitCHWRes</code></a> kernels, respectively, as described <a href="../Phase_Field_Equations.html">here</a>.</p></section><section class="scrollspy" id="625327d7-5a54-46d2-8859-3e2c74fb0268" data-section-level="2" data-section-text="Residual"><h2 id="residual">Residual</h2><p>In the residual routine we need to calculate the term <span tex="R= \frac{\partial F}{\partial c} - \mu" bookmark="moose-equation-857bda96-7d4b-441f-a7d4-1c91f1953a81" recursive="True" class="moose-katex-inline-equation" id="moose-equation-857bda96-7d4b-441f-a7d4-1c91f1953a81"><script>var element = document.getElementById("moose-equation-857bda96-7d4b-441f-a7d4-1c91f1953a81");katex.render("R= \\frac{\\partial F}{\\partial c} - \\mu", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We exploit the KKS identity <span tex="\frac{\partial F}{\partial c}=\frac{dF_a}{dc_a}=\frac{dF_b}{dc_b}" bookmark="moose-equation-d9711290-4dfc-4c55-8665-d4474ef36209" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d9711290-4dfc-4c55-8665-d4474ef36209"><script>var element = document.getElementById("moose-equation-d9711290-4dfc-4c55-8665-d4474ef36209");katex.render("\\frac{\\partial F}{\\partial c}=\\frac{dF_a}{dc_a}=\\frac{dF_b}{dc_b}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and arbitrarily use the a-phase instead.</p><p><span class="moose-katex-block-equation"><span tex="R = \frac{\partial F_a}{\partial c_a} - \mu" bookmark="moose-equation-4f9e7d26-0e72-4820-9f80-d241da1cd168" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-4f9e7d26-0e72-4820-9f80-d241da1cd168"></span><script>var element = document.getElementById("moose-equation-4f9e7d26-0e72-4820-9f80-d241da1cd168");katex.render("R = \\frac{\\partial F_a}{\\partial c_a} - \\mu", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><section id="23730f95-eeb8-4a94-8391-be54b086ee03" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><section id="2ce77883-63b6-4745-82c6-9d80f7ee9289" data-section-level="4" data-section-text="On - Diagonal"><h4 id="on-diagonal">On-Diagonal</h4><p>Since there is no explicit dependence on the non-linear variable <span tex="c" bookmark="moose-equation-10596e61-33a2-4bc1-b65e-9d82da1adaf1" recursive="True" class="moose-katex-inline-equation" id="moose-equation-10596e61-33a2-4bc1-b65e-9d82da1adaf1"><script>var element = document.getElementById("moose-equation-10596e61-33a2-4bc1-b65e-9d82da1adaf1");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> in the residual equation, the diagonal components are zero.</p></section><section id="848af789-fd25-4366-a425-41510c74091d" data-section-level="4" data-section-text="Off - diagonal"><h4 id="off-diagonal">Off-diagonal</h4><p>We are looking for the <span tex="\frac \partial{\partial u_j}" bookmark="moose-equation-fe94e7c6-818b-4338-b745-4696e843c35d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-fe94e7c6-818b-4338-b745-4696e843c35d"><script>var element = document.getElementById("moose-equation-fe94e7c6-818b-4338-b745-4696e843c35d");katex.render("\\frac \\partial{\\partial u_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative of <span tex="R" bookmark="moose-equation-92125228-db94-4c03-878e-acd90c9b8005" recursive="True" class="moose-katex-inline-equation" id="moose-equation-92125228-db94-4c03-878e-acd90c9b8005"><script>var element = document.getElementById("moose-equation-92125228-db94-4c03-878e-acd90c9b8005");katex.render("R", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, where <span tex="u\equiv c_a" bookmark="moose-equation-b3882017-6625-42b8-9f77-4b68f9b8b897" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b3882017-6625-42b8-9f77-4b68f9b8b897"><script>var element = document.getElementById("moose-equation-b3882017-6625-42b8-9f77-4b68f9b8b897");katex.render("u\\equiv c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We need to apply the chain rule and will again only keep terms with the <span tex="\frac{\partial c_a}{\partial u_j}\frac{\partial}{\partial c_a}=\phi_j \frac{\partial}{\partial c_a}" bookmark="moose-equation-a8e516f9-ea11-433a-9514-984e0f966c26" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a8e516f9-ea11-433a-9514-984e0f966c26"><script>var element = document.getElementById("moose-equation-a8e516f9-ea11-433a-9514-984e0f966c26");katex.render("\\frac{\\partial c_a}{\\partial u_j}\\frac{\\partial}{\\partial c_a}=\\phi_j \\frac{\\partial}{\\partial c_a}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative.</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \frac{\partial R}{\partial u_j} = \phi_j \frac{\partial}{\partial c_a} \left( \frac{\partial F}{\partial c_a} - \mu \right)\\ &=& \phi_j  \frac{\partial^2F}{\partial c_a^2} \\ \end{aligned}" bookmark="moose-equation-1505fcaf-03c8-45a6-8cd3-bea63b66d00a" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-1505fcaf-03c8-45a6-8cd3-bea63b66d00a"></span><script>var element = document.getElementById("moose-equation-1505fcaf-03c8-45a6-8cd3-bea63b66d00a");katex.render("\\begin{aligned} J &=& \\frac{\\partial R}{\\partial u_j} = \\phi_j \\frac{\\partial}{\\partial c_a} \\left( \\frac{\\partial F}{\\partial c_a} - \\mu \\right)\\\\ &=& \\phi_j  \\frac{\\partial^2F}{\\partial c_a^2} \\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>For <span tex="\mu" bookmark="moose-equation-0beabc23-7b9d-4e47-89ea-eed00371ef9f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-0beabc23-7b9d-4e47-89ea-eed00371ef9f"><script>var element = document.getElementById("moose-equation-0beabc23-7b9d-4e47-89ea-eed00371ef9f");katex.render("\\mu", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial \mu} \left( \frac{\partial F}{\partial c_a} - \mu \right)\\ &=& -\phi_j \\ \end{aligned}" bookmark="moose-equation-4410a1a2-be16-4e12-b630-3ab3a0b222e0" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-4410a1a2-be16-4e12-b630-3ab3a0b222e0"></span><script>var element = document.getElementById("moose-equation-4410a1a2-be16-4e12-b630-3ab3a0b222e0");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial \\mu} \\left( \\frac{\\partial F}{\\partial c_a} - \\mu \\right)\\\\ &=& -\\phi_j \\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section></section><section class="scrollspy" id="b2cfe949-2f17-45bb-8775-5e3f953e7742" data-section-level="2" data-section-text="KKSCHBulk"><h2 id="kkschbulk">KKSCHBulk</h2><p><a href="../../../source/kernels/KKSCHBulk.html"><code>KKSCHBulk</code></a> is the non-split version, which is <em></em>not fully implemented**. The non-linear variable for this Kernel is the concentration <span tex="c" bookmark="moose-equation-8032d72c-948c-40ff-9b5b-38bd11bb3944" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8032d72c-948c-40ff-9b5b-38bd11bb3944"><script>var element = document.getElementById("moose-equation-8032d72c-948c-40ff-9b5b-38bd11bb3944");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p><section id="5099da37-652f-448e-9e59-6099340d3771" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p>In the residual routine we need to calculate the term <span tex="R=\nabla \frac{dF}{dc}" bookmark="moose-equation-82abcefb-dd1a-4d45-89b4-d6ba9b86c382" recursive="True" class="moose-katex-inline-equation" id="moose-equation-82abcefb-dd1a-4d45-89b4-d6ba9b86c382"><script>var element = document.getElementById("moose-equation-82abcefb-dd1a-4d45-89b4-d6ba9b86c382");katex.render("R=\\nabla \\frac{dF}{dc}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We exploit the KKS identity <span tex="\frac{dF}{dc}=\frac{dF_a}{dc_a}=\frac{dF_b}{dc_b}" bookmark="moose-equation-1205d0b0-2278-4f85-b3aa-65d73f1ff5b2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1205d0b0-2278-4f85-b3aa-65d73f1ff5b2"><script>var element = document.getElementById("moose-equation-1205d0b0-2278-4f85-b3aa-65d73f1ff5b2");katex.render("\\frac{dF}{dc}=\\frac{dF_a}{dc_a}=\\frac{dF_b}{dc_b}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and arbitrarily use the a-phase instead. The gradient can be calculated through the chain rule (note that <span tex="F_a(c_a, p_1,p_2,\dots,p_n)" bookmark="moose-equation-81074e39-3819-4d58-bfd2-13c8d3775ea7" recursive="True" class="moose-katex-inline-equation" id="moose-equation-81074e39-3819-4d58-bfd2-13c8d3775ea7"><script>var element = document.getElementById("moose-equation-81074e39-3819-4d58-bfd2-13c8d3775ea7");katex.render("F_a(c_a, p_1,p_2,\\dots,p_n)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is potentially a function of many variables).</p><p><span class="moose-katex-block-equation"><span tex="R = \nabla \frac{dF_a}{dc_a} = \frac{d^2F_a}{dc_a^2}\nabla c_a + \sum_i \frac{d^2F_a}{dc_adp_i}\nabla p_i" bookmark="moose-equation-5aec8545-73b9-4ccc-8207-03a8256a0f76" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-5aec8545-73b9-4ccc-8207-03a8256a0f76"></span><script>var element = document.getElementById("moose-equation-5aec8545-73b9-4ccc-8207-03a8256a0f76");katex.render("R = \\nabla \\frac{dF_a}{dc_a} = \\frac{d^2F_a}{dc_a^2}\\nabla c_a + \\sum_i \\frac{d^2F_a}{dc_adp_i}\\nabla p_i", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>With <span tex="a = \{c_a, p_1,p_2,\dots,p_n\}" bookmark="moose-equation-e9800c14-2de9-40bc-9469-eb47a48b17f7" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e9800c14-2de9-40bc-9469-eb47a48b17f7"><script>var element = document.getElementById("moose-equation-e9800c14-2de9-40bc-9469-eb47a48b17f7");katex.render("a = \\{c_a, p_1,p_2,\\dots,p_n\\}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> being the vector of all arguments to <span tex="F_a" bookmark="moose-equation-f2146702-554c-4970-b755-a091d87e8791" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f2146702-554c-4970-b755-a091d87e8791"><script>var element = document.getElementById("moose-equation-f2146702-554c-4970-b755-a091d87e8791");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> this simplifies to</p><p><span class="moose-katex-block-equation"><span tex="R=\sum_i \frac{d^2F_a}{dc_ada_i}\nabla a_i  = \sum_i R_i \nabla a_i" bookmark="moose-equation-6925ee2c-f2bb-4453-8c7c-b4efba47a31b" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-6925ee2c-f2bb-4453-8c7c-b4efba47a31b"></span><script>var element = document.getElementById("moose-equation-6925ee2c-f2bb-4453-8c7c-b4efba47a31b");katex.render("R=\\sum_i \\frac{d^2F_a}{dc_ada_i}\\nabla a_i  = \\sum_i R_i \\nabla a_i", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>using <span tex="R_i" bookmark="moose-equation-5d9b7eff-b88a-4d47-87ed-cc6cefdcbb87" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5d9b7eff-b88a-4d47-87ed-cc6cefdcbb87"><script>var element = document.getElementById("moose-equation-5d9b7eff-b88a-4d47-87ed-cc6cefdcbb87");katex.render("R_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> as a shorthand for the term <span tex="\frac{d^2F_a}{dc_ada_i}" bookmark="moose-equation-becb6d6f-6999-441e-8af1-c0bd59933616" recursive="True" class="moose-katex-inline-equation" id="moose-equation-becb6d6f-6999-441e-8af1-c0bd59933616"><script>var element = document.getElementById("moose-equation-becb6d6f-6999-441e-8af1-c0bd59933616");katex.render("\\frac{d^2F_a}{dc_ada_i}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (and represented in the code as the array <code>_second_derivatives[i]</code>). We do have access to the gradients of <span tex="a_i" bookmark="moose-equation-ff2ef928-decd-4c5c-912c-e2bdd5ef674d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ff2ef928-decd-4c5c-912c-e2bdd5ef674d"><script>var element = document.getElementById("moose-equation-ff2ef928-decd-4c5c-912c-e2bdd5ef674d");katex.render("a_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> through MOOSE (stored in <code>_grad\_args[i]</code>).</p></section><section id="0f543cf2-4683-4739-bd2d-fd524ff27e6f" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><p>The calculation of the Jacobian involves the derivative of the Residual term <span tex="R" bookmark="moose-equation-ed39aabf-0128-43af-9370-cbffd7a36d47" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ed39aabf-0128-43af-9370-cbffd7a36d47"><script>var element = document.getElementById("moose-equation-ed39aabf-0128-43af-9370-cbffd7a36d47");katex.render("R", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> w.r.t. the individual coefficients <span tex="u_j" bookmark="moose-equation-238927fd-1daf-4f85-9d07-10eb9fb9ad53" recursive="True" class="moose-katex-inline-equation" id="moose-equation-238927fd-1daf-4f85-9d07-10eb9fb9ad53"><script>var element = document.getElementById("moose-equation-238927fd-1daf-4f85-9d07-10eb9fb9ad53");katex.render("u_j", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> of all parameters of <span tex="F_a" bookmark="moose-equation-cd385198-12a3-4603-a044-e65ee828129e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-cd385198-12a3-4603-a044-e65ee828129e"><script>var element = document.getElementById("moose-equation-cd385198-12a3-4603-a044-e65ee828129e");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. Here <span tex="u" bookmark="moose-equation-5f60a385-df18-444d-adfe-931840853ff4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-5f60a385-df18-444d-adfe-931840853ff4"><script>var element = document.getElementById("moose-equation-5f60a385-df18-444d-adfe-931840853ff4");katex.render("u", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> can stand for any variable <span tex="a_i" bookmark="moose-equation-3a798730-64f2-436f-8935-60c8dc0d2c5e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3a798730-64f2-436f-8935-60c8dc0d2c5e"><script>var element = document.getElementById("moose-equation-3a798730-64f2-436f-8935-60c8dc0d2c5e");katex.render("a_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p><p><span class="moose-katex-block-equation"><span tex="\frac{dR}{du_j} = \sum_i \left[ \frac d{du_j} R_i\nabla a_i \right] = \sum_i \left[  R_i\frac{d\nabla a_i}{du_j} + \nabla a_i \sum_k \frac {dR_i}{da_k}\frac{da_k}{du_j} \right]" bookmark="moose-equation-aa5e905e-62f1-43f2-a1ba-683463e421dd" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-aa5e905e-62f1-43f2-a1ba-683463e421dd"></span><script>var element = document.getElementById("moose-equation-aa5e905e-62f1-43f2-a1ba-683463e421dd");katex.render("\\frac{dR}{du_j} = \\sum_i \\left[ \\frac d{du_j} R_i\\nabla a_i \\right] = \\sum_i \\left[  R_i\\frac{d\\nabla a_i}{du_j} + \\nabla a_i \\sum_k \\frac {dR_i}{da_k}\\frac{da_k}{du_j} \\right]", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>In the code <span tex="u" bookmark="moose-equation-d967583a-cadf-4855-bfb9-6d663d44398a" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d967583a-cadf-4855-bfb9-6d663d44398a"><script>var element = document.getElementById("moose-equation-d967583a-cadf-4855-bfb9-6d663d44398a");katex.render("u", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is given by <code>jvar</code> for the off diagonal case, and <span tex="c" bookmark="moose-equation-b01d4d62-caa9-4cd0-a58b-480cb16dd47c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b01d4d62-caa9-4cd0-a58b-480cb16dd47c"><script>var element = document.getElementById("moose-equation-b01d4d62-caa9-4cd0-a58b-480cb16dd47c");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (not <span tex="c_a" bookmark="moose-equation-9d8c4f72-eced-45d5-b60e-25886f03eac9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-9d8c4f72-eced-45d5-b60e-25886f03eac9"><script>var element = document.getElementById("moose-equation-9d8c4f72-eced-45d5-b60e-25886f03eac9");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> or <span tex="c_b" bookmark="moose-equation-fb7c885f-419f-4b2a-82fa-b7623c127382" recursive="True" class="moose-katex-inline-equation" id="moose-equation-fb7c885f-419f-4b2a-82fa-b7623c127382"><script>var element = document.getElementById("moose-equation-fb7c885f-419f-4b2a-82fa-b7623c127382");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>!) in the on diagonal case.</p><section id="8aeb4b7f-331c-46ce-bf4a-813990b04430" data-section-level="4" data-section-text="Off - diagonal"><h4 id="off-diagonal">Off-diagonal</h4><p>Let&#x27;s focus on off diagonal first. Here <span tex="\frac{da_k}{du_j}" bookmark="moose-equation-4327650c-8069-40c1-9eaa-134ea7eeb377" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4327650c-8069-40c1-9eaa-134ea7eeb377"><script>var element = document.getElementById("moose-equation-4327650c-8069-40c1-9eaa-134ea7eeb377");katex.render("\\frac{da_k}{du_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is zero, if <code>jvar</code> is not equal <span tex="k" bookmark="moose-equation-3ffc0eda-27a7-41fb-b1b0-90d17927b910" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3ffc0eda-27a7-41fb-b1b0-90d17927b910"><script>var element = document.getElementById("moose-equation-3ffc0eda-27a7-41fb-b1b0-90d17927b910");katex.render("k", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. Allowing us to remove the sum over <span tex="k" bookmark="moose-equation-0bf39cb8-dee5-49bc-be6e-e5a84063a1b9" recursive="True" class="moose-katex-inline-equation" id="moose-equation-0bf39cb8-dee5-49bc-be6e-e5a84063a1b9"><script>var element = document.getElementById("moose-equation-0bf39cb8-dee5-49bc-be6e-e5a84063a1b9");katex.render("k", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and replace it with the single non-zero summand</p><p><span class="moose-katex-block-equation"><span tex="\frac{dR}{du_j} = \sum_i \left[  R_i\frac{d\nabla a_i}{du_j} + \nabla a_i \frac {dR_i}{da_\text{jvar}}\frac{da_\text{jvar}}{du_j} \right]" bookmark="moose-equation-b578873e-96c5-4bc3-aa41-650336d86e34" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-b578873e-96c5-4bc3-aa41-650336d86e34"></span><script>var element = document.getElementById("moose-equation-b578873e-96c5-4bc3-aa41-650336d86e34");katex.render("\\frac{dR}{du_j} = \\sum_i \\left[  R_i\\frac{d\\nabla a_i}{du_j} + \\nabla a_i \\frac {dR_i}{da_\\text{jvar}}\\frac{da_\\text{jvar}}{du_j} \\right]", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>In the first term in the square brackets the derivative <span tex="\frac{d\nabla a_i}{du_j}" bookmark="moose-equation-7a800b64-fac2-4529-bfdd-06848de4011c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7a800b64-fac2-4529-bfdd-06848de4011c"><script>var element = document.getElementById("moose-equation-7a800b64-fac2-4529-bfdd-06848de4011c");katex.render("\\frac{d\\nabla a_i}{du_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is only non-zero if <span tex="i" bookmark="moose-equation-daa7f038-741e-49c2-ba43-cf4059c6708f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-daa7f038-741e-49c2-ba43-cf4059c6708f"><script>var element = document.getElementById("moose-equation-daa7f038-741e-49c2-ba43-cf4059c6708f");katex.render("i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is <code>jvar</code>. We can therefore pull this term out of the sum.</p><p><span class="moose-katex-block-equation"><span tex="\frac{dR}{du_j} = R_\text{jvar}\frac{d\nabla a_\text{jvar}}{du_j} + \sum_i  \nabla a_i \frac {dR_i}{da_\text{jvar}}\frac{da_\text{jvar}}{du_j}" bookmark="moose-equation-7fcb392f-e252-4e8e-8904-5bce9273a7a9" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-7fcb392f-e252-4e8e-8904-5bce9273a7a9"></span><script>var element = document.getElementById("moose-equation-7fcb392f-e252-4e8e-8904-5bce9273a7a9");katex.render("\\frac{dR}{du_j} = R_\\text{jvar}\\frac{d\\nabla a_\\text{jvar}}{du_j} + \\sum_i  \\nabla a_i \\frac {dR_i}{da_\\text{jvar}}\\frac{da_\\text{jvar}}{du_j}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>With the rules for <span tex="\frac d{du_j}" bookmark="moose-equation-abc18070-877d-4095-a245-8c5b8a7223e8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-abc18070-877d-4095-a245-8c5b8a7223e8"><script>var element = document.getElementById("moose-equation-abc18070-877d-4095-a245-8c5b8a7223e8");katex.render("\\frac d{du_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivatives we get</p><p><span class="moose-katex-block-equation"><span tex="R_\text{jvar} \nabla \phi_j + \sum_i \nabla a_i \frac {dR_i}{da_\text{jvar}} \phi_j" bookmark="moose-equation-a1f05f24-1ca5-47ef-b3f9-ec63ebf1aae1" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-a1f05f24-1ca5-47ef-b3f9-ec63ebf1aae1"></span><script>var element = document.getElementById("moose-equation-a1f05f24-1ca5-47ef-b3f9-ec63ebf1aae1");katex.render("R_\\text{jvar} \\nabla \\phi_j + \\sum_i \\nabla a_i \\frac {dR_i}{da_\\text{jvar}} \\phi_j", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>where <span tex="j" bookmark="moose-equation-88c35126-658b-4bf2-a0bd-e1302a283c05" recursive="True" class="moose-katex-inline-equation" id="moose-equation-88c35126-658b-4bf2-a0bd-e1302a283c05"><script>var element = document.getElementById("moose-equation-88c35126-658b-4bf2-a0bd-e1302a283c05");katex.render("j", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is <code>_j</code> in the code.</p></section><section id="5641fc49-ca7d-4800-917a-0ae68b7908b6" data-section-level="4" data-section-text="On - diagonal"><h4 id="on-diagonal">On-diagonal</h4><p>For the on diagonal terms we look at the derivative w.r.t. the components of the non-linear variable <span tex="c" bookmark="moose-equation-b4612c47-218d-4d7e-b1be-7781ea8ef667" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b4612c47-218d-4d7e-b1be-7781ea8ef667"><script>var element = document.getElementById("moose-equation-b4612c47-218d-4d7e-b1be-7781ea8ef667");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> of this kernel. Note, that <span tex="F_a" bookmark="moose-equation-25ed9525-753b-4ccb-acf9-4e72206e6c70" recursive="True" class="moose-katex-inline-equation" id="moose-equation-25ed9525-753b-4ccb-acf9-4e72206e6c70"><script>var element = document.getElementById("moose-equation-25ed9525-753b-4ccb-acf9-4e72206e6c70");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is only indirectly a function of <span tex="c" bookmark="moose-equation-7b294a5e-2afc-4d75-a4e6-a690add40536" recursive="True" class="moose-katex-inline-equation" id="moose-equation-7b294a5e-2afc-4d75-a4e6-a690add40536"><script>var element = document.getElementById("moose-equation-7b294a5e-2afc-4d75-a4e6-a690add40536");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We assume the dependence is given through <span tex="c(c_a)" bookmark="moose-equation-eb3298b9-aa51-4944-9a61-92fc640790e3" recursive="True" class="moose-katex-inline-equation" id="moose-equation-eb3298b9-aa51-4944-9a61-92fc640790e3"><script>var element = document.getElementById("moose-equation-eb3298b9-aa51-4944-9a61-92fc640790e3");katex.render("c(c_a)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. The chain rule will thus yield terms of this form</p><p><span class="moose-katex-block-equation"><span tex="\frac{dc_a}{dc} = \frac{\frac{d^2F_b}{dc_b^2}}{[1-h(\eta)]\frac{d^2F_b}{dc_b^2}+h(\eta)\frac{d^2F_a}{dc_a^2}}," bookmark="moose-equation-37f4ce71-f657-4b87-bc58-814d4359d5c6" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-37f4ce71-f657-4b87-bc58-814d4359d5c6"></span><script>var element = document.getElementById("moose-equation-37f4ce71-f657-4b87-bc58-814d4359d5c6");katex.render("\\frac{dc_a}{dc} = \\frac{\\frac{d^2F_b}{dc_b^2}}{[1-h(\\eta)]\\frac{d^2F_b}{dc_b^2}+h(\\eta)\\frac{d^2F_a}{dc_a^2}},", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>which is given as equation (23) in KKS. Following the off-diagonal  derivation we get</p><p>v \frac{d<sup>2F_a}{dc_a</sup>2}\frac{dc_a}{dc} \nabla \phi_j + \sum_i \nabla a_i \frac {dR_i}{dc_a} \frac{dc_a}{dc} \phi_j \end{equation}</p></section><section id="d642b0d5-fb80-4d5c-ab16-aa7e4c650b9c" data-section-level="4" data-section-text="On - diagonal second approach"><h4 id="on-diagonal-second-approach">On-diagonal second approach</h4><p>Let&#x27;s get back to the original residual with <span tex="\frac{dF}{dc}" bookmark="moose-equation-ef539cbf-03b2-4c33-8b1f-c85a0c84e51d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ef539cbf-03b2-4c33-8b1f-c85a0c84e51d"><script>var element = document.getElementById("moose-equation-ef539cbf-03b2-4c33-8b1f-c85a0c84e51d");katex.render("\\frac{dF}{dc}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. Then</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{d}{dc} \nabla \frac{dF}{dc}\\ &=& \phi_j  \nabla \frac{d^2F}{dc^2} \quad,\quad \text{with (29) from KKS}\\ &=& \phi_j  \nabla \frac{\frac{d^2F_b}{dc_b^2}\frac{d^2F_a}{dc_a^2}}{  [1-h(\eta)]\frac{d^2F_b}{dc_b^2}+h(\eta)\frac{d^2F_a}{dc_a^2} }\\ \end{aligned}" bookmark="moose-equation-ffec338e-f042-47a5-97c0-c8172e5835e3" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-ffec338e-f042-47a5-97c0-c8172e5835e3"></span><script>var element = document.getElementById("moose-equation-ffec338e-f042-47a5-97c0-c8172e5835e3");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{d}{dc} \\nabla \\frac{dF}{dc}\\\\ &=& \\phi_j  \\nabla \\frac{d^2F}{dc^2} \\quad,\\quad \\text{with (29) from KKS}\\\\ &=& \\phi_j  \\nabla \\frac{\\frac{d^2F_b}{dc_b^2}\\frac{d^2F_a}{dc_a^2}}{  [1-h(\\eta)]\\frac{d^2F_b}{dc_b^2}+h(\\eta)\\frac{d^2F_a}{dc_a^2} }\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section></section><section id="d986e83c-8779-44a9-9c0f-16a5f0344c98" data-section-level="1" data-section-text="Allen - Cahn Kernels"><h1 id="allen-cahn-kernels">Allen-Cahn  Kernels</h1><p>For the bulk Allen-Cahn residual we need to calculate the term</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} R=\frac{dF}{d\eta}&=&\frac{d}{d\eta}\left([1-h(\eta)]F_a + h(\eta)F_b+wg(\eta) \right)\\ &=& \frac{dF_a}{d\eta}+\frac{d}{d\eta}\left(h(\eta)F_b-h(\eta)F_a + wg(\eta)\right)\\ &=& \frac{dF_a}{d\eta}+F_b\frac{dh}{d\eta}-F_a\frac{dh}{d\eta}+h(\eta)\frac{dF_b}{d\eta}-h(\eta)\frac{dF_a}{d\eta} +w\frac{dg}{d\eta}\\ &=& \frac{dF_a}{d\eta}+\frac{dh}{d\eta}(F_b-F_a)+h(\eta)\left(\frac{dF_b}{d\eta}-\frac{dF_a}{d\eta}\right) +w\frac{dg}{d\eta}\\ &=& \frac{dh}{d\eta}(F_b-F_a) + \underbrace{[1-h(\eta)]\frac{dF_a}{d\eta} + h(\eta)\frac{dF_b}{d\eta}}_{\text{chain rule term}} +w\frac{dg}{d\eta}\\ &=& \frac{dh}{d\eta}(F_b-F_a) + [1-h(\eta)]\frac{dF_a}{dc_a}\frac{dc_a}{d\eta} + h(\eta)\frac{dF_b}{dc_b}\frac{dc_b}{d\eta} +w\frac{dg}{d\eta}\\ &=& \frac{dh}{d\eta}(F_b-F_a) + \frac{dF_a}{dc_a}\left([1-h(\eta)]\frac{dc_a}{d\eta} + h(\eta)\frac{dc_b}{d\eta}\right) +w\frac{dg}{d\eta} \end{aligned}" bookmark="moose-equation-29a1f25f-bb54-472d-8751-bbc1d83f4e50" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-29a1f25f-bb54-472d-8751-bbc1d83f4e50"></span><script>var element = document.getElementById("moose-equation-29a1f25f-bb54-472d-8751-bbc1d83f4e50");katex.render("\\begin{aligned} R=\\frac{dF}{d\\eta}&=&\\frac{d}{d\\eta}\\left([1-h(\\eta)]F_a + h(\\eta)F_b+wg(\\eta) \\right)\\\\ &=& \\frac{dF_a}{d\\eta}+\\frac{d}{d\\eta}\\left(h(\\eta)F_b-h(\\eta)F_a + wg(\\eta)\\right)\\\\ &=& \\frac{dF_a}{d\\eta}+F_b\\frac{dh}{d\\eta}-F_a\\frac{dh}{d\\eta}+h(\\eta)\\frac{dF_b}{d\\eta}-h(\\eta)\\frac{dF_a}{d\\eta} +w\\frac{dg}{d\\eta}\\\\ &=& \\frac{dF_a}{d\\eta}+\\frac{dh}{d\\eta}(F_b-F_a)+h(\\eta)\\left(\\frac{dF_b}{d\\eta}-\\frac{dF_a}{d\\eta}\\right) +w\\frac{dg}{d\\eta}\\\\ &=& \\frac{dh}{d\\eta}(F_b-F_a) + \\underbrace{[1-h(\\eta)]\\frac{dF_a}{d\\eta} + h(\\eta)\\frac{dF_b}{d\\eta}}_{\\text{chain rule term}} +w\\frac{dg}{d\\eta}\\\\ &=& \\frac{dh}{d\\eta}(F_b-F_a) + [1-h(\\eta)]\\frac{dF_a}{dc_a}\\frac{dc_a}{d\\eta} + h(\\eta)\\frac{dF_b}{dc_b}\\frac{dc_b}{d\\eta} +w\\frac{dg}{d\\eta}\\\\ &=& \\frac{dh}{d\\eta}(F_b-F_a) + \\frac{dF_a}{dc_a}\\left([1-h(\\eta)]\\frac{dc_a}{d\\eta} + h(\\eta)\\frac{dc_b}{d\\eta}\\right) +w\\frac{dg}{d\\eta} \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>The _chain rule term_ results from the fact that <span tex="c_a" bookmark="moose-equation-b1d440fa-a5a7-45ce-a8c6-c4df797ead4c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b1d440fa-a5a7-45ce-a8c6-c4df797ead4c"><script>var element = document.getElementById("moose-equation-b1d440fa-a5a7-45ce-a8c6-c4df797ead4c");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="c_b" bookmark="moose-equation-3bd0e196-10ae-4304-b2d7-7ec583b14aa7" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3bd0e196-10ae-4304-b2d7-7ec583b14aa7"><script>var element = document.getElementById("moose-equation-3bd0e196-10ae-4304-b2d7-7ec583b14aa7");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> are dependent on <span tex="\eta" bookmark="moose-equation-18811e85-a219-4280-a7cd-ec57e33cc545" recursive="True" class="moose-katex-inline-equation" id="moose-equation-18811e85-a219-4280-a7cd-ec57e33cc545"><script>var element = document.getElementById("moose-equation-18811e85-a219-4280-a7cd-ec57e33cc545");katex.render("\\eta", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (see eqs. (25) and (26) in KKS). Setting <span tex="\lambda = [1-h(\eta)]\frac{d^2F_b}{dc_b^2}+h(\eta)\frac{d^2F_a}{dc_a^2}" bookmark="moose-equation-ec3ab218-e9c0-4386-8864-6de56fc528a7" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ec3ab218-e9c0-4386-8864-6de56fc528a7"><script>var element = document.getElementById("moose-equation-ec3ab218-e9c0-4386-8864-6de56fc528a7");katex.render("\\lambda = [1-h(\\eta)]\\frac{d^2F_b}{dc_b^2}+h(\\eta)\\frac{d^2F_a}{dc_a^2}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> we get</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} \frac{dc_a}{d\eta} &=& \frac1\lambda \frac{dh}{d\eta}(c_a-c_b)\frac{d^2F_b}{dc_b^2}\\ \frac{dc_b}{d\eta} &=& \frac1\lambda \frac{dh}{d\eta}(c_a-c_b)\frac{d^2F_a}{dc_a^2}. \end{aligned}" bookmark="moose-equation-54a99609-9589-48db-b142-068f3120608f" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-54a99609-9589-48db-b142-068f3120608f"></span><script>var element = document.getElementById("moose-equation-54a99609-9589-48db-b142-068f3120608f");katex.render("\\begin{aligned} \\frac{dc_a}{d\\eta} &=& \\frac1\\lambda \\frac{dh}{d\\eta}(c_a-c_b)\\frac{d^2F_b}{dc_b^2}\\\\ \\frac{dc_b}{d\\eta} &=& \\frac1\\lambda \\frac{dh}{d\\eta}(c_a-c_b)\\frac{d^2F_a}{dc_a^2}. \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>Substituting this in we get</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} R &=& \frac{dh}{d\eta}(F_b-F_a) + \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b)\frac1\lambda\underbrace{\left([1-h(\eta)] \frac{d^2F_b}{dc_b^2} + h(\eta)\frac{d^2F_a}{dc_a^2}\right)}_{=\lambda} +w\frac{dg}{d\eta}. \end{aligned}" bookmark="moose-equation-b2f30703-013a-48c4-bc4a-08bb40ee98f9" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-b2f30703-013a-48c4-bc4a-08bb40ee98f9"></span><script>var element = document.getElementById("moose-equation-b2f30703-013a-48c4-bc4a-08bb40ee98f9");katex.render("\\begin{aligned} R &=& \\frac{dh}{d\\eta}(F_b-F_a) + \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b)\\frac1\\lambda\\underbrace{\\left([1-h(\\eta)] \\frac{d^2F_b}{dc_b^2} + h(\\eta)\\frac{d^2F_a}{dc_a^2}\\right)}_{=\\lambda} +w\\frac{dg}{d\\eta}. \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>This simplifies to</p><p><span class="moose-katex-block-equation"><span tex="R=-\frac{dh}{d\eta} \left(F_a-F_b-\frac{dF_a}{dc_a}(c_a-c_b)\right) + w\frac{dg}{d\eta}." bookmark="moose-equation-ab59207d-2a50-4400-8681-6468e2507b5b" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-ab59207d-2a50-4400-8681-6468e2507b5b"></span><script>var element = document.getElementById("moose-equation-ab59207d-2a50-4400-8681-6468e2507b5b");katex.render("R=-\\frac{dh}{d\\eta} \\left(F_a-F_b-\\frac{dF_a}{dc_a}(c_a-c_b)\\right) + w\\frac{dg}{d\\eta}.", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>We split this residual into two kernels to allow for multiple phase concentrations in a multi component system:</p><section class="scrollspy" id="de664c0f-e1d9-4c56-8b0a-ef2e8675d0d1" data-section-level="2" data-section-text="KKSACBulkF"><h2><code>KKSACBulkF</code></h2><p><a href="../../../source/kernels/KKSACBulkF.html"><code>KKSACBulkF</code></a> is the part without a direct composition dependence.</p><section id="a18013a7-a646-4b16-bdff-1dab53bef6ec" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p><span class="moose-katex-block-equation"><span tex="R=-\frac{dh}{d\eta}(F_a-F_b)+w\frac{dg}{d\eta}." bookmark="moose-equation-5446f0f1-eaa5-4ac8-918c-974436df8170" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-5446f0f1-eaa5-4ac8-918c-974436df8170"></span><script>var element = document.getElementById("moose-equation-5446f0f1-eaa5-4ac8-918c-974436df8170");katex.render("R=-\\frac{dh}{d\\eta}(F_a-F_b)+w\\frac{dg}{d\\eta}.", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="0af573cd-faae-4759-acd9-5e5d7050947a" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><section id="abbfbaa6-3dcc-42c4-8f67-8507068ae84e" data-section-level="4" data-section-text="On - diagonal"><h4 id="on-diagonal">On-diagonal</h4><p>We are looking for the <span tex="\frac \partial{\partial u_j}" bookmark="moose-equation-1fcf8fc9-1ea4-4cc9-a372-da4ccc281f8e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1fcf8fc9-1ea4-4cc9-a372-da4ccc281f8e"><script>var element = document.getElementById("moose-equation-1fcf8fc9-1ea4-4cc9-a372-da4ccc281f8e");katex.render("\\frac \\partial{\\partial u_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative of <span tex="R" bookmark="moose-equation-f0994646-d125-4185-8c3c-4bde460572b6" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f0994646-d125-4185-8c3c-4bde460572b6"><script>var element = document.getElementById("moose-equation-f0994646-d125-4185-8c3c-4bde460572b6");katex.render("R", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, where <span tex="u\equiv\eta" bookmark="moose-equation-19cc3efa-70f3-4019-aff3-dbe282c15057" recursive="True" class="moose-katex-inline-equation" id="moose-equation-19cc3efa-70f3-4019-aff3-dbe282c15057"><script>var element = document.getElementById("moose-equation-19cc3efa-70f3-4019-aff3-dbe282c15057");katex.render("u\\equiv\\eta", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We need to apply the chain rule and will again only keep terms with the <span tex="\frac{\partial \eta}{\partial u_j}\frac{\partial}{\partial \eta}=\phi_j \frac{\partial}{\partial\eta}" bookmark="moose-equation-c0694273-074c-4912-beb4-a99a9df266f1" recursive="True" class="moose-katex-inline-equation" id="moose-equation-c0694273-074c-4912-beb4-a99a9df266f1"><script>var element = document.getElementById("moose-equation-c0694273-074c-4912-beb4-a99a9df266f1");katex.render("\\frac{\\partial \\eta}{\\partial u_j}\\frac{\\partial}{\\partial \\eta}=\\phi_j \\frac{\\partial}{\\partial\\eta}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative.</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& -\phi_j \frac{\partial}{\partial \eta}\left( \frac{dh}{d\eta}(F_a-F_b) \right) + w \phi_j \frac{\partial}{\partial \eta}\frac{dg}{d\eta} \\ &=&-\frac{d^2h}{d\eta^2}\phi_j(F_a-F_b) + w\frac{d^2g}{d\eta^2}\phi_j \\ \end{aligned}" bookmark="moose-equation-df7d94df-1e48-432a-a82e-3323652f1513" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-df7d94df-1e48-432a-a82e-3323652f1513"></span><script>var element = document.getElementById("moose-equation-df7d94df-1e48-432a-a82e-3323652f1513");katex.render("\\begin{aligned} J &=& -\\phi_j \\frac{\\partial}{\\partial \\eta}\\left( \\frac{dh}{d\\eta}(F_a-F_b) \\right) + w \\phi_j \\frac{\\partial}{\\partial \\eta}\\frac{dg}{d\\eta} \\\\ &=&-\\frac{d^2h}{d\\eta^2}\\phi_j(F_a-F_b) + w\\frac{d^2g}{d\\eta^2}\\phi_j \\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>(The implicit dependence of <span tex="F_a(c_a)" bookmark="moose-equation-66ba5c02-ed81-4ad0-88b3-a80776acde6f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-66ba5c02-ed81-4ad0-88b3-a80776acde6f"><script>var element = document.getElementById("moose-equation-66ba5c02-ed81-4ad0-88b3-a80776acde6f");katex.render("F_a(c_a)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="F_b(c_a)" bookmark="moose-equation-162a382e-f2cb-49c5-9dd5-4e1e2b632b0d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-162a382e-f2cb-49c5-9dd5-4e1e2b632b0d"><script>var element = document.getElementById("moose-equation-162a382e-f2cb-49c5-9dd5-4e1e2b632b0d");katex.render("F_b(c_a)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> on <span tex="\eta" bookmark="moose-equation-0fa9cacc-bd2d-4ef8-ba5e-0bd2430f0606" recursive="True" class="moose-katex-inline-equation" id="moose-equation-0fa9cacc-bd2d-4ef8-ba5e-0bd2430f0606"><script>var element = document.getElementById("moose-equation-0fa9cacc-bd2d-4ef8-ba5e-0bd2430f0606");katex.render("\\eta", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> through <span tex="c_a(c,\eta)" bookmark="moose-equation-87a97b84-3580-4a6d-aa79-8b3a10d1b634" recursive="True" class="moose-katex-inline-equation" id="moose-equation-87a97b84-3580-4a6d-aa79-8b3a10d1b634"><script>var element = document.getElementById("moose-equation-87a97b84-3580-4a6d-aa79-8b3a10d1b634");katex.render("c_a(c,\\eta)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="c_b(c,\eta)" bookmark="moose-equation-bf528a5e-089a-4fe4-aff8-604279502959" recursive="True" class="moose-katex-inline-equation" id="moose-equation-bf528a5e-089a-4fe4-aff8-604279502959"><script>var element = document.getElementById("moose-equation-bf528a5e-089a-4fe4-aff8-604279502959");katex.render("c_b(c,\\eta)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> does not contribute to the Jacobian, so <span tex="\frac{\partial F_a}{\partial \eta} = \frac{\partial F_a}{\partial \eta} = 0)" bookmark="moose-equation-9bc33831-b3c0-4edf-9a01-9f5340a06e9f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-9bc33831-b3c0-4edf-9a01-9f5340a06e9f"><script>var element = document.getElementById("moose-equation-9bc33831-b3c0-4edf-9a01-9f5340a06e9f");katex.render("\\frac{\\partial F_a}{\\partial \\eta} = \\frac{\\partial F_a}{\\partial \\eta} = 0)", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p></section><section id="9b553cfe-2569-4f49-88b4-6249a87684ad" data-section-level="4" data-section-text="Off - Diagonal"><h4 id="off-diagonal">Off-Diagonal</h4><p>The off-diagonal components are calculated for any other variables that <span tex="F_a" bookmark="moose-equation-d9897631-c1f7-4123-8a30-bed8037e5a20" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d9897631-c1f7-4123-8a30-bed8037e5a20"><script>var element = document.getElementById("moose-equation-d9897631-c1f7-4123-8a30-bed8037e5a20");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="F_b" bookmark="moose-equation-295cb1fe-14fc-4a60-859c-09105b7665f5" recursive="True" class="moose-katex-inline-equation" id="moose-equation-295cb1fe-14fc-4a60-859c-09105b7665f5"><script>var element = document.getElementById("moose-equation-295cb1fe-14fc-4a60-859c-09105b7665f5");katex.render("F_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> depend on. For example, for <span tex="c_a" bookmark="moose-equation-bcbed815-e451-4007-ad4e-b990f0ac871f" recursive="True" class="moose-katex-inline-equation" id="moose-equation-bcbed815-e451-4007-ad4e-b990f0ac871f"><script>var element = document.getElementById("moose-equation-bcbed815-e451-4007-ad4e-b990f0ac871f");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>:</p><p><span class="moose-katex-block-equation"><span tex="J = \frac{dh}{d\eta}\left( \frac{\partial F_a}{\partial c_a} - \frac{\partial F_b}{\partial c_a}\right)\phi_j" bookmark="moose-equation-d37d1a23-4590-4f04-be06-0df03970bd86" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-d37d1a23-4590-4f04-be06-0df03970bd86"></span><script>var element = document.getElementById("moose-equation-d37d1a23-4590-4f04-be06-0df03970bd86");katex.render("J = \\frac{dh}{d\\eta}\\left( \\frac{\\partial F_a}{\\partial c_a} - \\frac{\\partial F_b}{\\partial c_a}\\right)\\phi_j", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span tex="\frac{\partial F_b}{\partial c_a} = 0" bookmark="moose-equation-872921fc-d084-46cd-86b1-64e180765a3c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-872921fc-d084-46cd-86b1-64e180765a3c"><script>var element = document.getElementById("moose-equation-872921fc-d084-46cd-86b1-64e180765a3c");katex.render("\\frac{\\partial F_b}{\\partial c_a} = 0", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> in the KKS formulation, so this term would not need to be included if <span tex="c_a" bookmark="moose-equation-1fa59391-d736-48e4-a400-ccf847965620" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1fa59391-d736-48e4-a400-ccf847965620"><script>var element = document.getElementById("moose-equation-1fa59391-d736-48e4-a400-ccf847965620");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> was the only variable <span tex="F_a" bookmark="moose-equation-eb94e520-b1a5-4889-8d4d-3ed18c42d2dd" recursive="True" class="moose-katex-inline-equation" id="moose-equation-eb94e520-b1a5-4889-8d4d-3ed18c42d2dd"><script>var element = document.getElementById("moose-equation-eb94e520-b1a5-4889-8d4d-3ed18c42d2dd");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> depended on. However, the code calculates derivatives with respect to all variables that <span tex="F_a" bookmark="moose-equation-e34169df-a758-426b-adf5-a3443fbf405c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e34169df-a758-426b-adf5-a3443fbf405c"><script>var element = document.getElementById("moose-equation-e34169df-a758-426b-adf5-a3443fbf405c");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="F_b" bookmark="moose-equation-4bd24ac4-503e-472f-8231-6e4b0a8f7b86" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4bd24ac4-503e-472f-8231-6e4b0a8f7b86"><script>var element = document.getElementById("moose-equation-4bd24ac4-503e-472f-8231-6e4b0a8f7b86");katex.render("F_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> depend on in a general way so that the Jacobian entries for other dependencies are correctly computed using the same piece of code. For example, both <span tex="F_a" bookmark="moose-equation-f4198d19-80ee-44d7-8d4a-44081c3edae1" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f4198d19-80ee-44d7-8d4a-44081c3edae1"><script>var element = document.getElementById("moose-equation-f4198d19-80ee-44d7-8d4a-44081c3edae1");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="F_b" bookmark="moose-equation-6b66a6f5-b600-4b46-8e21-b01e2ceff097" recursive="True" class="moose-katex-inline-equation" id="moose-equation-6b66a6f5-b600-4b46-8e21-b01e2ceff097"><script>var element = document.getElementById("moose-equation-6b66a6f5-b600-4b46-8e21-b01e2ceff097");katex.render("F_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> could depend on temperature <span tex="T" bookmark="moose-equation-db341823-749c-42a0-8377-6eaea1979c98" recursive="True" class="moose-katex-inline-equation" id="moose-equation-db341823-749c-42a0-8377-6eaea1979c98"><script>var element = document.getElementById("moose-equation-db341823-749c-42a0-8377-6eaea1979c98");katex.render("T", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, in which case</p><p><span class="moose-katex-block-equation"><span tex="J = \frac{dh}{d\eta}\left( \frac{\partial F_a}{\partial T} - \frac{\partial F_b}{\partial T}\right)\phi_j" bookmark="moose-equation-ba6945d9-4cea-4031-95dd-29d0b39069e0" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-ba6945d9-4cea-4031-95dd-29d0b39069e0"></span><script>var element = document.getElementById("moose-equation-ba6945d9-4cea-4031-95dd-29d0b39069e0");katex.render("J = \\frac{dh}{d\\eta}\\left( \\frac{\\partial F_a}{\\partial T} - \\frac{\\partial F_b}{\\partial T}\\right)\\phi_j", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>which is computed using the same code. The off-diagonal Jacobian contribution is also multiplied by the Allen-Cahn mobility <span tex="L" bookmark="moose-equation-3c33dba6-ce02-4847-b2f0-de2cc7e25414" recursive="True" class="moose-katex-inline-equation" id="moose-equation-3c33dba6-ce02-4847-b2f0-de2cc7e25414"><script>var element = document.getElementById("moose-equation-3c33dba6-ce02-4847-b2f0-de2cc7e25414");katex.render("L", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> at each point for consistency with the other terms in the Allen-Cahn equation.</p></section></section><section class="scrollspy" id="4c69023c-ebb4-4c5b-8705-7e7482a2cb37" data-section-level="2" data-section-text="KKSACBulkC"><h2><code>KKSACBulkC</code></h2><p><a href="../../../source/kernels/KKSACBulkC.html"><code>KKSACBulkC</code></a> is the part with a direct composition dependence. An instance of this kernel is needed for each compnent of the problem.</p><section id="346220fa-92ed-4361-ba4d-4059109d8b87" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} R&=&-\frac{dh}{d\eta}\left(-\frac{dF_a}{dc_a}(c_a-c_b)\right)\\ &=&\frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \end{aligned}" bookmark="moose-equation-943613f8-09e7-41f8-b914-adb11986d61e" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-943613f8-09e7-41f8-b914-adb11986d61e"></span><script>var element = document.getElementById("moose-equation-943613f8-09e7-41f8-b914-adb11986d61e");katex.render("\\begin{aligned} R&=&-\\frac{dh}{d\\eta}\\left(-\\frac{dF_a}{dc_a}(c_a-c_b)\\right)\\\\ &=&\\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="cdadad09-5901-4c6b-8d1e-db771c25849d" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><section id="432e166d-6c87-4750-a8a8-35962612ad23" data-section-level="4" data-section-text="On - diagonal"><h4 id="on-diagonal">On-diagonal</h4><p>We are looking for the <span tex="\frac \partial{\partial u_j}" bookmark="moose-equation-b0859dd0-0c83-41a3-99eb-27c68a1aed88" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b0859dd0-0c83-41a3-99eb-27c68a1aed88"><script>var element = document.getElementById("moose-equation-b0859dd0-0c83-41a3-99eb-27c68a1aed88");katex.render("\\frac \\partial{\\partial u_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative of <span tex="R" bookmark="moose-equation-03fc9d38-44cf-49ee-b3db-04b3ce0e347b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-03fc9d38-44cf-49ee-b3db-04b3ce0e347b"><script>var element = document.getElementById("moose-equation-03fc9d38-44cf-49ee-b3db-04b3ce0e347b");katex.render("R", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, where <span tex="u\equiv\eta" bookmark="moose-equation-802b96d4-0a77-4705-98eb-818a599ca930" recursive="True" class="moose-katex-inline-equation" id="moose-equation-802b96d4-0a77-4705-98eb-818a599ca930"><script>var element = document.getElementById("moose-equation-802b96d4-0a77-4705-98eb-818a599ca930");katex.render("u\\equiv\\eta", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We need to apply the chain rule and will again only keep terms with the <span tex="\frac{\partial \eta}{\partial u_j}\frac{\partial}{\partial \eta} = \phi_j \frac{\partial}{\partial \eta}" bookmark="moose-equation-1d6e101e-f468-494f-97be-7df49f59c531" recursive="True" class="moose-katex-inline-equation" id="moose-equation-1d6e101e-f468-494f-97be-7df49f59c531"><script>var element = document.getElementById("moose-equation-1d6e101e-f468-494f-97be-7df49f59c531");katex.render("\\frac{\\partial \\eta}{\\partial u_j}\\frac{\\partial}{\\partial \\eta} = \\phi_j \\frac{\\partial}{\\partial \\eta}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative.</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial \eta} \left( \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \right)\\ &=& \frac{d^2h}{d\eta^2}\phi_j\frac{dF_a}{dc_a}(c_a-c_b)\\ \end{aligned}" bookmark="moose-equation-4f0c8e16-be1d-4230-bb97-76529ce2f32c" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-4f0c8e16-be1d-4230-bb97-76529ce2f32c"></span><script>var element = document.getElementById("moose-equation-4f0c8e16-be1d-4230-bb97-76529ce2f32c");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial \\eta} \\left( \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\right)\\\\ &=& \\frac{d^2h}{d\\eta^2}\\phi_j\\frac{dF_a}{dc_a}(c_a-c_b)\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="d131d692-f569-4d87-9360-8e91d0eba7a6" data-section-level="4" data-section-text="Off - diagonal"><h4 id="off-diagonal">Off-diagonal</h4><p>Since <span tex="c_a" bookmark="moose-equation-e9f4e9ca-d44f-4d29-a25a-f55c4e9f107d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e9f4e9ca-d44f-4d29-a25a-f55c4e9f107d"><script>var element = document.getElementById("moose-equation-e9f4e9ca-d44f-4d29-a25a-f55c4e9f107d");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="c_b" bookmark="moose-equation-18cc0e7a-475f-47ad-86cd-15a2cda5dfc3" recursive="True" class="moose-katex-inline-equation" id="moose-equation-18cc0e7a-475f-47ad-86cd-15a2cda5dfc3"><script>var element = document.getElementById("moose-equation-18cc0e7a-475f-47ad-86cd-15a2cda5dfc3");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> appear in the residual, their effect must be calculated separately from any other variable dependence. For <span tex="c_a" bookmark="moose-equation-64466795-91e9-41d8-a789-42aaf3d03a7c" recursive="True" class="moose-katex-inline-equation" id="moose-equation-64466795-91e9-41d8-a789-42aaf3d03a7c"><script>var element = document.getElementById("moose-equation-64466795-91e9-41d8-a789-42aaf3d03a7c");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, we are looking for the <span tex="\frac \partial{\partial u_j}" bookmark="moose-equation-e806d2fa-642e-4595-bd17-7b177ca63ff0" recursive="True" class="moose-katex-inline-equation" id="moose-equation-e806d2fa-642e-4595-bd17-7b177ca63ff0"><script>var element = document.getElementById("moose-equation-e806d2fa-642e-4595-bd17-7b177ca63ff0");katex.render("\\frac \\partial{\\partial u_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative of <span tex="R" bookmark="moose-equation-b7d1130e-2b12-4bd9-8062-f569d1fb7e59" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b7d1130e-2b12-4bd9-8062-f569d1fb7e59"><script>var element = document.getElementById("moose-equation-b7d1130e-2b12-4bd9-8062-f569d1fb7e59");katex.render("R", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, where <span tex="u\equiv c_a" bookmark="moose-equation-a11043e7-db0b-4d6c-b2bd-72d9711d94c5" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a11043e7-db0b-4d6c-b2bd-72d9711d94c5"><script>var element = document.getElementById("moose-equation-a11043e7-db0b-4d6c-b2bd-72d9711d94c5");katex.render("u\\equiv c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>. We need to apply the chain rule and will again only keep terms with the <span tex="\frac{\partial c_a}{\partial u_j}\frac{\partial}{\partial c_a} = \phi_j \frac{\partial}{\partial c_a}" bookmark="moose-equation-eaaa0899-a6b1-4098-bf6b-9c07805efd0b" recursive="True" class="moose-katex-inline-equation" id="moose-equation-eaaa0899-a6b1-4098-bf6b-9c07805efd0b"><script>var element = document.getElementById("moose-equation-eaaa0899-a6b1-4098-bf6b-9c07805efd0b");katex.render("\\frac{\\partial c_a}{\\partial u_j}\\frac{\\partial}{\\partial c_a} = \\phi_j \\frac{\\partial}{\\partial c_a}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> derivative.</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial c_a} \left( \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \right)\\ &=& \frac{dh}{d\eta} \phi_j \left( \frac{d^2 F_a}{dc_a^2}(c_a-c_b) + \frac{d F_a}{d c_a}\right)\\ \end{aligned}" bookmark="moose-equation-2170f9f9-7a6f-4665-bb29-1bc4f4a8178d" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-2170f9f9-7a6f-4665-bb29-1bc4f4a8178d"></span><script>var element = document.getElementById("moose-equation-2170f9f9-7a6f-4665-bb29-1bc4f4a8178d");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial c_a} \\left( \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\right)\\\\ &=& \\frac{dh}{d\\eta} \\phi_j \\left( \\frac{d^2 F_a}{dc_a^2}(c_a-c_b) + \\frac{d F_a}{d c_a}\\right)\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>Similarly for <span tex="c_b" bookmark="moose-equation-f3f213f6-bb08-4349-8510-5be4ec7ac164" recursive="True" class="moose-katex-inline-equation" id="moose-equation-f3f213f6-bb08-4349-8510-5be4ec7ac164"><script>var element = document.getElementById("moose-equation-f3f213f6-bb08-4349-8510-5be4ec7ac164");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, <span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial c_b} \left( \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \right)\\ &=& -\frac{dh}{d\eta} \phi_j  \frac{d F_a}{d c_a}\\ \end{aligned}" bookmark="moose-equation-7b4ccf0d-998a-410d-93b4-523b966b294a" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-7b4ccf0d-998a-410d-93b4-523b966b294a"></span><script>var element = document.getElementById("moose-equation-7b4ccf0d-998a-410d-93b4-523b966b294a");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial c_b} \\left( \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\right)\\\\ &=& -\\frac{dh}{d\\eta} \\phi_j  \\frac{d F_a}{d c_a}\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>For any variable other than <span tex="c_a" bookmark="moose-equation-d5ac9649-411b-4825-b7a3-b3cf84475fe4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d5ac9649-411b-4825-b7a3-b3cf84475fe4"><script>var element = document.getElementById("moose-equation-d5ac9649-411b-4825-b7a3-b3cf84475fe4");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> or <span tex="c_b" bookmark="moose-equation-47b98837-be96-4ce3-a71c-a90a82985854" recursive="True" class="moose-katex-inline-equation" id="moose-equation-47b98837-be96-4ce3-a71c-a90a82985854"><script>var element = document.getElementById("moose-equation-47b98837-be96-4ce3-a71c-a90a82985854");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, for example temperature <span tex="T" bookmark="moose-equation-28345f42-103d-4fec-8474-526fa6c31dff" recursive="True" class="moose-katex-inline-equation" id="moose-equation-28345f42-103d-4fec-8474-526fa6c31dff"><script>var element = document.getElementById("moose-equation-28345f42-103d-4fec-8474-526fa6c31dff");katex.render("T", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>:</p><p><span class="moose-katex-block-equation"><span tex="\begin{aligned} J &=& \phi_j \frac{\partial}{\partial T} \left( \frac{dh}{d\eta}\frac{dF_a}{dc_a}(c_a-c_b) \right)\\ &=& \frac{dh}{d\eta} \phi_j  \frac{\partial}{\partial T}\left(\frac{d F_a}{d c_a}\right) ( c_a - c_b)\\ \end{aligned}" bookmark="moose-equation-e589fdf9-565b-41b9-930c-e9018fac98b1" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-e589fdf9-565b-41b9-930c-e9018fac98b1"></span><script>var element = document.getElementById("moose-equation-e589fdf9-565b-41b9-930c-e9018fac98b1");katex.render("\\begin{aligned} J &=& \\phi_j \\frac{\\partial}{\\partial T} \\left( \\frac{dh}{d\\eta}\\frac{dF_a}{dc_a}(c_a-c_b) \\right)\\\\ &=& \\frac{dh}{d\\eta} \\phi_j  \\frac{\\partial}{\\partial T}\\left(\\frac{d F_a}{d c_a}\\right) ( c_a - c_b)\\\\ \\end{aligned}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>The off-diagonal Jacobian contributions are again multiplied by the Allen-Cahn mobility <span tex="L" bookmark="moose-equation-8f11a565-fcf9-4728-afca-32fcef51ccad" recursive="True" class="moose-katex-inline-equation" id="moose-equation-8f11a565-fcf9-4728-afca-32fcef51ccad"><script>var element = document.getElementById("moose-equation-8f11a565-fcf9-4728-afca-32fcef51ccad");katex.render("L", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> at each point for consistency with the other terms in the Allen-Cahn equation.</p></section></section><section id="2618995e-6a90-41f5-97d9-2608a52dfd90" data-section-level="1" data-section-text="Constraint Kernels"><h1 id="constraint-kernels">Constraint Kernels</h1><section class="scrollspy" id="2a4bcef9-abc7-4de2-bc76-5cbf73b4a3f4" data-section-level="2" data-section-text="KKSPhaseChemicalPotential"><h2><code>KKSPhaseChemicalPotential</code></h2><p><a href="../../../source/kernels/KKSPhaseChemicalPotential.html"><code>KKSPhaseChemicalPotential</code></a> enforces the point wise equality of the phase chemical potentials</p><p><span class="moose-katex-block-equation"><span tex="\frac{dF_a}{dc_a}=\frac{dF_b}{dc_b}." bookmark="moose-equation-ce1b603d-b2fe-4704-a808-0d8ec0d82fc1" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-ce1b603d-b2fe-4704-a808-0d8ec0d82fc1"></span><script>var element = document.getElementById("moose-equation-ce1b603d-b2fe-4704-a808-0d8ec0d82fc1");katex.render("\\frac{dF_a}{dc_a}=\\frac{dF_b}{dc_b}.", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>The non-linear variable of this Kernel is <span tex="c_a" bookmark="moose-equation-47c4c2bd-6866-4e28-8fba-f6b5a3508613" recursive="True" class="moose-katex-inline-equation" id="moose-equation-47c4c2bd-6866-4e28-8fba-f6b5a3508613"><script>var element = document.getElementById("moose-equation-47c4c2bd-6866-4e28-8fba-f6b5a3508613");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p><section id="d0debb67-613b-4daa-87ff-abee8b238206" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p><span class="moose-katex-block-equation"><span tex="R=\frac{dF_a}{dc_a} - \frac{dF_b}{dc_b}" bookmark="moose-equation-0496e9c0-3f7b-44e2-a138-8f37e71215c9" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-0496e9c0-3f7b-44e2-a138-8f37e71215c9"></span><script>var element = document.getElementById("moose-equation-0496e9c0-3f7b-44e2-a138-8f37e71215c9");katex.render("R=\\frac{dF_a}{dc_a} - \\frac{dF_b}{dc_b}", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="0421d9f8-899c-4bf9-bc56-6d91a96a3ea8" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><p>For the Jacobian we need to calculate</p><p><span class="moose-katex-block-equation"><span tex="J=\frac \partial{\partial u_j}\left( \frac{dF_a}{dc_a} - \frac{dF_b}{dc_b} \right)." bookmark="moose-equation-f7352b42-c5f9-4e6f-b0d4-bef902a550eb" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-f7352b42-c5f9-4e6f-b0d4-bef902a550eb"></span><script>var element = document.getElementById("moose-equation-f7352b42-c5f9-4e6f-b0d4-bef902a550eb");katex.render("J=\\frac \\partial{\\partial u_j}\\left( \\frac{dF_a}{dc_a} - \\frac{dF_b}{dc_b} \\right).", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><section id="c2388b1a-dbca-433b-903f-7af8a4f28f5c" data-section-level="4" data-section-text="On - Diagonal"><h4 id="on-diagonal">On-Diagonal</h4><p><span class="moose-katex-block-equation"><span tex="J = \phi_j \left( \frac{\partial^2 F_a}{\partial c_a^2} - \frac{\partial^2 F_b}{\partial c_a \partial c_b} \right)" bookmark="moose-equation-bc30bee2-7e84-4d41-9986-4af446a65f94" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-bc30bee2-7e84-4d41-9986-4af446a65f94"></span><script>var element = document.getElementById("moose-equation-bc30bee2-7e84-4d41-9986-4af446a65f94");katex.render("J = \\phi_j \\left( \\frac{\\partial^2 F_a}{\\partial c_a^2} - \\frac{\\partial^2 F_b}{\\partial c_a \\partial c_b} \\right)", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="78447bc6-90f6-46b9-ab64-cfce94981bf7" data-section-level="4" data-section-text="Off - Diagonal"><h4 id="off-diagonal">Off-Diagonal</h4><p>With <span tex="q" bookmark="moose-equation-0b6a3280-be5b-4835-b904-6b0fa1f7857d" recursive="True" class="moose-katex-inline-equation" id="moose-equation-0b6a3280-be5b-4835-b904-6b0fa1f7857d"><script>var element = document.getElementById("moose-equation-0b6a3280-be5b-4835-b904-6b0fa1f7857d");katex.render("q", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> the union of the argument vectors of <span tex="F_a" bookmark="moose-equation-d42b9762-730e-40c5-a19f-e50df3eb896e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-d42b9762-730e-40c5-a19f-e50df3eb896e"><script>var element = document.getElementById("moose-equation-d42b9762-730e-40c5-a19f-e50df3eb896e");katex.render("F_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> and <span tex="F_b" bookmark="moose-equation-ab6fc354-6184-469e-abc1-4168da697d75" recursive="True" class="moose-katex-inline-equation" id="moose-equation-ab6fc354-6184-469e-abc1-4168da697d75"><script>var element = document.getElementById("moose-equation-ab6fc354-6184-469e-abc1-4168da697d75");katex.render("F_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> (represented in the code by <code>_coupled_moose_vars[]</code>) we get</p><p><span class="moose-katex-block-equation"><span tex="\sum_i \left( \frac{\partial^2 F_a}{\partial c_a \partial q_i}\frac{\partial q_i}{\partial u_j} - \frac{\partial^2 F_b}{\partial c_b \partial q_i}\frac{\partial q_i}{\partial u_j} \right)." bookmark="moose-equation-9b9d877d-3079-4a4b-9721-e03f7a96e54a" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-9b9d877d-3079-4a4b-9721-e03f7a96e54a"></span><script>var element = document.getElementById("moose-equation-9b9d877d-3079-4a4b-9721-e03f7a96e54a");katex.render("\\sum_i \\left( \\frac{\\partial^2 F_a}{\\partial c_a \\partial q_i}\\frac{\\partial q_i}{\\partial u_j} - \\frac{\\partial^2 F_b}{\\partial c_b \\partial q_i}\\frac{\\partial q_i}{\\partial u_j} \\right).", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>Again the <span tex="\frac{\partial q_i}{\partial u_j}" bookmark="moose-equation-45632cd6-d5df-4b13-8651-d609e481a4b8" recursive="True" class="moose-katex-inline-equation" id="moose-equation-45632cd6-d5df-4b13-8651-d609e481a4b8"><script>var element = document.getElementById("moose-equation-45632cd6-d5df-4b13-8651-d609e481a4b8");katex.render("\\frac{\\partial q_i}{\\partial u_j}", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is non-zero only if <span tex="u\equiv q_i" bookmark="moose-equation-4965103a-94dd-469f-ad95-084f98b21409" recursive="True" class="moose-katex-inline-equation" id="moose-equation-4965103a-94dd-469f-ad95-084f98b21409"><script>var element = document.getElementById("moose-equation-4965103a-94dd-469f-ad95-084f98b21409");katex.render("u\\equiv q_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>, which is the case if <span tex="q_i" bookmark="moose-equation-a45d85c9-a4f7-45c8-b4d2-f7b9f3999df1" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a45d85c9-a4f7-45c8-b4d2-f7b9f3999df1"><script>var element = document.getElementById("moose-equation-a45d85c9-a4f7-45c8-b4d2-f7b9f3999df1");katex.render("q_i", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> is the argument selected through <code>jvar</code>.</p><p><span class="moose-katex-block-equation"><span tex="J = \frac{\partial^2 F_a}{\partial c_a \partial q_\text{jvar}}\phi_j - \frac{\partial^2 F_b}{\partial c_b \partial q_\text{jvar}}\phi_j." bookmark="moose-equation-530c04ce-fd08-431d-b783-9209111abe56" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-530c04ce-fd08-431d-b783-9209111abe56"></span><script>var element = document.getElementById("moose-equation-530c04ce-fd08-431d-b783-9209111abe56");katex.render("J = \\frac{\\partial^2 F_a}{\\partial c_a \\partial q_\\text{jvar}}\\phi_j - \\frac{\\partial^2 F_b}{\\partial c_b \\partial q_\\text{jvar}}\\phi_j.", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>Note that in the code <code>jvar</code> is not an index into <code>_coupled_moose_vars[]</code> but has to be resolved through the <code>_jvar_map</code>.</p></section></section><section class="scrollspy" id="6e8a8ffd-04dc-4410-82b5-910a06cd46eb" data-section-level="2" data-section-text="KKSPhaseConcentration"><h2><code>KKSPhaseConcentration</code></h2><p><a href="../../../source/kernels/KKSPhaseConcentration.html"><code>KKSPhaseConcentration</code></a> enforces the split of the concentration into the phase concentrations, weighted by the switching function. The non-linear variable of this Kernel is <span tex="c_b" bookmark="moose-equation-16b4d2a7-f4f5-4429-a78c-3a72df0de11e" recursive="True" class="moose-katex-inline-equation" id="moose-equation-16b4d2a7-f4f5-4429-a78c-3a72df0de11e"><script>var element = document.getElementById("moose-equation-16b4d2a7-f4f5-4429-a78c-3a72df0de11e");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>.</p><p><span class="moose-katex-block-equation"><span tex="c = [1-h(\eta)]c_a+h(\eta)c_b" bookmark="moose-equation-955b64c5-2209-43bb-9382-cc470e58c1b9" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-955b64c5-2209-43bb-9382-cc470e58c1b9"></span><script>var element = document.getElementById("moose-equation-955b64c5-2209-43bb-9382-cc470e58c1b9");katex.render("c = [1-h(\\eta)]c_a+h(\\eta)c_b", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><section id="935e7230-8a42-40b8-9930-52648b03efab" data-section-level="3" data-section-text="Residual"><h3 id="residual">Residual</h3><p><span class="moose-katex-block-equation"><span tex="R=[1-h(\eta)]c_a + h(\eta)c_b - c" bookmark="moose-equation-f8264250-e2f7-4e88-bc50-ca6f86208f7f" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-f8264250-e2f7-4e88-bc50-ca6f86208f7f"></span><script>var element = document.getElementById("moose-equation-f8264250-e2f7-4e88-bc50-ca6f86208f7f");katex.render("R=[1-h(\\eta)]c_a + h(\\eta)c_b - c", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="92ddd967-2ef8-4129-a0e2-421807d2c794" data-section-level="3" data-section-text="Jacobian"><h3 id="jacobian">Jacobian</h3><section id="3eaf752f-3874-43c9-840b-a90349420fca" data-section-level="4" data-section-text="On - Diagonal"><h4 id="on-diagonal">On-Diagonal</h4><p>Since the non-linear variable is <span tex="c_b" bookmark="moose-equation-b9d552e8-cfd3-41f0-a557-349b8705ad91" recursive="True" class="moose-katex-inline-equation" id="moose-equation-b9d552e8-cfd3-41f0-a557-349b8705ad91"><script>var element = document.getElementById("moose-equation-b9d552e8-cfd3-41f0-a557-349b8705ad91");katex.render("c_b", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span>,</p><p><span class="moose-katex-block-equation"><span tex="J= \phi_j \frac{\partial R}{\partial c_b} = \phi_j h(\eta)" bookmark="moose-equation-4da36201-d474-4bf0-aee2-ffb2f5243efc" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-4da36201-d474-4bf0-aee2-ffb2f5243efc"></span><script>var element = document.getElementById("moose-equation-4da36201-d474-4bf0-aee2-ffb2f5243efc");katex.render("J= \\phi_j \\frac{\\partial R}{\\partial c_b} = \\phi_j h(\\eta)", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p></section><section id="092433a9-e0e3-4725-8124-657522244ac7" data-section-level="4" data-section-text="Off - Diagonal"><h4 id="off-diagonal">Off-Diagonal</h4><p>For <span tex="c_a" bookmark="moose-equation-a8b79966-28eb-4d52-9a70-ec5e1be149b4" recursive="True" class="moose-katex-inline-equation" id="moose-equation-a8b79966-28eb-4d52-9a70-ec5e1be149b4"><script>var element = document.getElementById("moose-equation-a8b79966-28eb-4d52-9a70-ec5e1be149b4");katex.render("c_a", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="J= \phi_j \frac{\partial R}{\partial c_a} = \phi_j [1-h(\eta)]" bookmark="moose-equation-129aa00c-8327-4a3c-a3a9-d5b7c4db4988" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-129aa00c-8327-4a3c-a3a9-d5b7c4db4988"></span><script>var element = document.getElementById("moose-equation-129aa00c-8327-4a3c-a3a9-d5b7c4db4988");katex.render("J= \\phi_j \\frac{\\partial R}{\\partial c_a} = \\phi_j [1-h(\\eta)]", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>For <span tex="c" bookmark="moose-equation-9d2c2462-d817-4647-ab8f-dfab322e75b2" recursive="True" class="moose-katex-inline-equation" id="moose-equation-9d2c2462-d817-4647-ab8f-dfab322e75b2"><script>var element = document.getElementById("moose-equation-9d2c2462-d817-4647-ab8f-dfab322e75b2");katex.render("c", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="J= \phi_j \frac{\partial R}{\partial c} = -\phi_j" bookmark="moose-equation-638d733b-318c-4ae7-bc75-e56dea69f12f" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-638d733b-318c-4ae7-bc75-e56dea69f12f"></span><script>var element = document.getElementById("moose-equation-638d733b-318c-4ae7-bc75-e56dea69f12f");katex.render("J= \\phi_j \\frac{\\partial R}{\\partial c} = -\\phi_j", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p>For <span tex="\eta" bookmark="moose-equation-2e1e863f-4d09-4386-9067-2d55ed9f5ee0" recursive="True" class="moose-katex-inline-equation" id="moose-equation-2e1e863f-4d09-4386-9067-2d55ed9f5ee0"><script>var element = document.getElementById("moose-equation-2e1e863f-4d09-4386-9067-2d55ed9f5ee0");katex.render("\\eta", element, {displayMode:false,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span></p><p><span class="moose-katex-block-equation"><span tex="J= \phi_j \frac{\partial R}{\partial \eta} = \phi_j \frac{dh}{d\eta}(c_b-c_a)" bookmark="moose-equation-368554fb-a0c5-4a7b-90db-d26fe091abb0" recursive="True" class="moose-katex-equation table-cell" id="moose-equation-368554fb-a0c5-4a7b-90db-d26fe091abb0"></span><script>var element = document.getElementById("moose-equation-368554fb-a0c5-4a7b-90db-d26fe091abb0");katex.render("J= \\phi_j \\frac{\\partial R}{\\partial \\eta} = \\phi_j \\frac{dh}{d\\eta}(c_b-c_a)", element, {displayMode:true,throwOnError:false,macros:{"\\bs":"\\boldsymbol{#1}","\\normal":"\\bs{n}","\\divergence":"\\nabla \\cdot","\\norm":"\\left\\lVert#1\\right\\rVert","\\diff":"\\text{ d}#1","\\total":"\\text{total}","\\internal":"\\text{internal}","\\external":"\\text{external}","\\elastic":"\\text{elastic}","\\fracture":"\\text{fracture}","\\critical":"\\text{critical}","\\activeenergy":"{\\left< A \\right>}","\\inactiveenergy":"{\\left< I \\right>}","\\Gc":"{\\mathcal{G}_c}","\\strain":"\\bs{\\varepsilon}","\\stress":"\\bs{\\sigma}","\\xstress":"\\widetilde{\\stress}","\\macaulay":"\\left<#1\\right>","\\body":"\\Omega","\\bodyboundary":"{\\partial\\body}","\\grad":"\\bs{\\nabla}"}});</script></span> </p></section></section><section class="scrollspy" id="427ca2a5-4139-4a34-90e7-bc7b7e73ee12" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="kim_phase-field_1999">Seong&nbsp;Gyoon Kim, Won&nbsp;Tae Kim, and Toshio Suzuki.
Phase-field model for binary alloys.
<em>Physical Review E</em>, 60(6):7186&ndash;7197, December 1999.
URL: <a href="http://link.aps.org/doi/10.1103/PhysRevE.60.7186">http://link.aps.org/doi/10.1103/PhysRevE.60.7186</a>, <a href="https://doi.org/10.1103/PhysRevE.60.7186">doi:10.1103/PhysRevE.60.7186</a>.<a href="#9c165f89-37c9-4245-9715-9a1f97dd3aa8" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="9c165f89-37c9-4245-9715-9a1f97dd3aa8"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{kim_phase-field_1999,
    author = "Kim, Seong Gyoon and Kim, Won Tae and Suzuki, Toshio",
    title = "Phase-field model for binary alloys",
    volume = "60",
    url = "http://link.aps.org/doi/10.1103/PhysRevE.60.7186",
    doi = "10.1103/PhysRevE.60.7186",
    number = "6",
    urldate = "2014-03-31",
    journal = "Physical Review E",
    month = "December",
    year = "1999",
    pages = "7186-7197"
}
</code></pre></div></div></li></ol></div></section></section></section></section></section></section></section></section></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#45d735b7-d8cb-402e-87f6-2816fe58e8bd" class="tooltipped" data-position="left" data-tooltip="KKSSplitCHCRes">KKSSplitCHCRes</a></li><li><a href="#625327d7-5a54-46d2-8859-3e2c74fb0268" class="tooltipped" data-position="left" data-tooltip="Residual">Residual</a></li><li><a href="#b2cfe949-2f17-45bb-8775-5e3f953e7742" class="tooltipped" data-position="left" data-tooltip="KKSCHBulk">KKSCHBulk</a></li><li><a href="#de664c0f-e1d9-4c56-8b0a-ef2e8675d0d1" class="tooltipped" data-position="left" data-tooltip="KKSACBulkF">KKSACBulkF</a></li><li><a href="#4c69023c-ebb4-4c5b-8705-7e7482a2cb37" class="tooltipped" data-position="left" data-tooltip="KKSACBulkC">KKSACBulkC</a></li><li><a href="#2a4bcef9-abc7-4de2-bc76-5cbf73b4a3f4" class="tooltipped" data-position="left" data-tooltip="KKSPhaseChemicalPotential">KKSPhaseChemicalPotential</a></li><li><a href="#6e8a8ffd-04dc-4410-82b5-910a06cd46eb" class="tooltipped" data-position="left" data-tooltip="KKSPhaseConcentration">KKSPhaseConcentration</a></li><li><a href="#427ca2a5-4139-4a34-90e7-bc7b7e73ee12" class="tooltipped" data-position="left" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../../js/init.js"></script><script type="text/javascript" src="../../../js/navigation.js"></script><script type="text/javascript" src="../../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../../js/search_index.js"></script><script type="text/javascript" src="../../../js/sqa_moose.js"></script>